var ht=Object.defineProperty;var ft=(n,s,t)=>s in n?ht(n,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[s]=t;var l=(n,s,t)=>(ft(n,typeof s!="symbol"?s+"":s,t),t);const mt=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))e(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&e(i)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerpolicy&&(r.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?r.credentials="include":o.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function e(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}};mt();function P(){}function lt(n){return n()}function ot(){return Object.create(null)}function M(n){n.forEach(lt)}function gt(n){return typeof n=="function"}function wt(n,s){return n!=n?s==s:n!==s||n&&typeof n=="object"||typeof n=="function"}function bt(n){return Object.keys(n).length===0}function u(n,s){n.appendChild(s)}function st(n,s,t){n.insertBefore(s,t||null)}function A(n){n.parentNode.removeChild(n)}function h(n){return document.createElement(n)}function yt(n){return document.createTextNode(n)}function w(){return yt(" ")}function I(n,s,t,e){return n.addEventListener(s,t,e),()=>n.removeEventListener(s,t,e)}function p(n,s,t){t==null?n.removeAttribute(s):n.getAttribute(s)!==t&&n.setAttribute(s,t)}function _t(n){return Array.from(n.childNodes)}let D;function $(n){D=n}function xt(){if(!D)throw new Error("Function called outside component initialization");return D}function vt(n){xt().$$.on_mount.push(n)}const T=[],it=[],F=[],rt=[],Ct=Promise.resolve();let B=!1;function kt(){B||(B=!0,Ct.then(dt))}function R(n){F.push(n)}const X=new Set;let U=0;function dt(){const n=D;do{for(;U<T.length;){const s=T[U];U++,$(s),Lt(s.$$)}for($(null),T.length=0,U=0;it.length;)it.pop()();for(let s=0;s<F.length;s+=1){const t=F[s];X.has(t)||(X.add(t),t())}F.length=0}while(T.length);for(;rt.length;)rt.pop()();B=!1,X.clear(),$(n)}function Lt(n){if(n.fragment!==null){n.update(),M(n.before_update);const s=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,s),n.after_update.forEach(R)}}const Ot=new Set;function zt(n,s){n&&n.i&&(Ot.delete(n),n.i(s))}function It(n,s,t,e){const{fragment:o,on_mount:r,on_destroy:i,after_update:a}=n.$$;o&&o.m(s,t),e||R(()=>{const d=r.map(lt).filter(gt);i?i.push(...d):M(d),n.$$.on_mount=[]}),a.forEach(R)}function Tt(n,s){const t=n.$$;t.fragment!==null&&(M(t.on_destroy),t.fragment&&t.fragment.d(s),t.on_destroy=t.fragment=null,t.ctx=[])}function $t(n,s){n.$$.dirty[0]===-1&&(T.push(n),kt(),n.$$.dirty.fill(0)),n.$$.dirty[s/31|0]|=1<<s%31}function Dt(n,s,t,e,o,r,i,a=[-1]){const d=D;$(n);const c=n.$$={fragment:null,ctx:null,props:r,update:P,not_equal:o,bound:ot(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(s.context||(d?d.$$.context:[])),callbacks:ot(),dirty:a,skip_bound:!1,root:s.target||d.$$.root};i&&i(c.root);let m=!1;if(c.ctx=t?t(n,s.props||{},(f,g,...x)=>{const b=x.length?x[0]:g;return c.ctx&&o(c.ctx[f],c.ctx[f]=b)&&(!c.skip_bound&&c.bound[f]&&c.bound[f](b),m&&$t(n,f)),g}):[],c.update(),m=!0,M(c.before_update),c.fragment=e?e(c.ctx):!1,s.target){if(s.hydrate){const f=_t(s.target);c.fragment&&c.fragment.l(f),f.forEach(A)}else c.fragment&&c.fragment.c();s.intro&&zt(n.$$.fragment),It(n,s.target,s.anchor,s.customElement),dt()}$(d)}class Mt{$destroy(){Tt(this,1),this.$destroy=P}$on(s,t){const e=this.$$.callbacks[s]||(this.$$.callbacks[s]=[]);return e.push(t),()=>{const o=e.indexOf(t);o!==-1&&e.splice(o,1)}}$set(s){this.$$set&&!bt(s)&&(this.$$.skip_bound=!0,this.$$set(s),this.$$.skip_bound=!1)}}const Et={functions:{visualize:{inputs:["Video ID","Show Controls"],outputs:[],functionInit:n=>{n.yt=n.dom.querySelector(".yt")},functionUpdate:(n,s,t)=>{s||(s="m4-HM_sCvtQ"),n.yt.src="https://www.youtube.com/embed/"+s+"?autoplay=1&controls="+(t?"1":"0")}}},elements:[{type:"input-text",name:"Video ID"},{type:"input-bool",name:"Show Controls"},{type:"custom",html:`
        <iframe class="yt rounded-lg" width="560" height="315" src="https://www.youtube.com/embed/m4-HM_sCvtQ?autoplay=1&controls=0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
      `}]},Nt={functions:{output:{inputs:["Input 1","Input 2","Operation"],outputs:["Result"],functionUpdate:(n,s,t,e)=>{switch(e){case"+":return s+t;case"-":return s-t;case"*":return s*t;case"/":return s/t;default:return 0}}}},elements:[{type:"output-text",name:"Result"},[{type:"ui-dropdown",name:"Operation",values:[{value:"+",label:"Add"},{value:"-",label:"Subtract"},{value:"*",label:"Multiply"},{value:"/",label:"Divide"}]}],[{type:"input-text",name:"Input 1"}],[{type:"input-text",name:"Input 2"}]]},St={functions:{output:{inputs:["Input"],outputs:[],functionInit:(n,s)=>{n.display=n.dom.querySelector(".display")},functionUpdate:(n,s)=>{n.display.innerText=s}}},elements:[{type:"input-text",name:"Input"},{type:"custom",name:"Display",html:`
      <div class="bg-red rounded-lg">
        <span class="display text-3xl"></span>
      </div>
      `}]};function at(n,s,t){return n>=s&&n<=t||n>=t&&n<=s}function ct(n,s,t){const e=t.zoom,o=t.zoom,r=-n*t.zoom+t.cameraWidth/2,i=-s*t.zoom+t.cameraHeight/2;return`${e},0,0,0,0,${o},0,0,0,0,1,0,${r},${i},0,1`}function q(n,s){if(s.name==="")return;const t=document.createElement("span");t.classList.add("sl-label"),t.innerText=s.name,n.appendChild(t)}class ut{constructor(s){l(this,"g");l(this,"gid");l(this,"position_x");l(this,"position_y");this.g=s,s.gid++,this.gid=s.gid.toString(),this.position_x=0,this.position_y=0}domMouseDown(s){this.g.isMouseDown=!0,this.g.targetNode=this,this.g.mousedown_x=s.clientX,this.g.mousedown_y=s.clientY,this.g.dx=0,this.g.dy=0,this.g.dx_offset=0,this.g.dy_offset=0,this.onFocus(),this.customMouseDown(s),s.stopPropagation()}customMouseDown(s){console.debug(s)}domMouseUp(){}onFocus(){}offFocus(){}onDrag(){}onPan(){}}class G extends ut{constructor(t,e,o){super(o);l(this,"parent");l(this,"config");l(this,"dom");this.config=t,this.parent=e,this.dom=null}}class pt extends G{constructor(t,e,o,r){super(t,e,o);l(this,"connector_x");l(this,"connector_y");l(this,"c_total_offset_x");l(this,"c_total_offset_y");l(this,"name");l(this,"parentContent");l(this,"connector");this.connector_x=0,this.connector_y=0,this.c_total_offset_x=0,this.c_total_offset_y=0,this.dom=null,this.parentContent=r,this.connector=null,t.name?this.name=t.name:(o.gid++,this.name=o.gid.toString()),this.parent.elements[this.name]=this,this.g.globalNodes[this.gid]=this}pxToInt(t){return parseInt(t.substring(0,t.length-2))}updateDOMproperties(){const t=this.parent.nodeContainerOffsetLeft,e=this.parent.nodeContainerOffsetTop,o=0;this.pxToInt(window.getComputedStyle(this.parentContent).marginLeft)+this.pxToInt(window.getComputedStyle(this.parentContent).paddingLeft)+this.pxToInt(window.getComputedStyle(this.parentContent).borderLeftWidth)+this.parentContent.offsetLeft;const r=this.parentContent.offsetTop,i=this.pxToInt(window.getComputedStyle(this.connector).marginLeft)+this.pxToInt(window.getComputedStyle(this.connector).paddingLeft)+this.pxToInt(window.getComputedStyle(this.connector).borderLeftWidth)+this.connector.offsetLeft,a=this.pxToInt(window.getComputedStyle(this.connector).marginTop)+this.pxToInt(window.getComputedStyle(this.connector).paddingTop)+this.pxToInt(window.getComputedStyle(this.connector).borderTopWidth)+this.connector.offsetTop;console.debug(`connector_offset_x: ${i} connector_offset_y: ${a}`);const d=this.connector.getBoundingClientRect().width,c=this.connector.getBoundingClientRect().height;this.c_total_offset_x=t+o+i+d/2,this.c_total_offset_y=e+r+a+c/2}setLineXY(t,e,o){t.setAttribute("x1",""+0),t.setAttribute("y1",""+0),t.setAttribute("x2",""+e),t.setAttribute("y2",""+o),t.setAttribute("stroke-width",`${4*this.g.zoom}`)}}class Ut extends pt{constructor(t,e,o,r){super(t,e,o,r);l(this,"inputDOM");l(this,"inputValue");l(this,"peerOutput");this.inputDOM=null,this.peerOutput=null;const i=document.createElement("div");i.classList.add("sl-input");const a=document.createElement("span");switch(a.classList.add("sl-input-connector"),a.id=`input-${this.gid}`,a.onmousedown=this.domMouseDown.bind(this),i.appendChild(a),this.inputValue=()=>{},t.type){case"input-text":{q(i,t);const d=document.createElement("input");d.classList.add("sl-input-text"),d.type="text",i.appendChild(d),this.inputDOM=d,d.onkeyup=()=>{var c;(c=this.parent)==null||c.findLeaf()},this.inputValue=()=>this.inputDOM.value}break;case"input-bool":{q(i,t);const d=document.createElement("input");d.classList.add("sl-input-bool"),d.type="checkbox",i.appendChild(d),this.inputDOM=d,d.onchange=()=>{var c;(c=this.parent)==null||c.findLeaf()},this.inputValue=()=>this.inputDOM.checked}break}this.connector=a,this.dom=i}domMouseDown(t){this.peerOutput&&(super.domMouseDown(t),this.g.targetNode=this.peerOutput,this.g.dx_offset=(this.connector_x-this.peerOutput.connector_x)*this.g.zoom,this.g.dy_offset=(this.connector_y-this.peerOutput.connector_y)*this.g.zoom,this.g.dx=this.g.dx_offset,this.g.dy=this.g.dy_offset,this.peerOutput.customMouseDown(t),this.peerOutput.disconnectFromInput(this),t.stopPropagation())}updateConnectorPosition(){this.connector_x=this.parent.position_x+this.c_total_offset_x,this.connector_y=this.parent.position_y+this.c_total_offset_y}disconnectFromOutput(){var t;this.peerOutput=null,(t=this.dom)==null||t.classList.remove("connected")}connectToOutput(t){var e;this.peerOutput=t,(e=this.dom)==null||e.classList.add("connected")}nodeDrag(){this.updateConnectorPosition(),this.peerOutput&&this.peerOutput.nodeDrag()}getValue(){return this.peerOutput?this.peerOutput.getValue():this.inputDOM?this.inputValue():null}}class At extends pt{constructor(t,e,o,r){super(t,e,o,r);l(this,"val");l(this,"svgTmp");l(this,"svgs");this.val=null,this.svgTmp={svg:null,line:null},this.svgs=[];const i=document.createElement("div");i.classList.add("sl-output"),q(i,t);const a=document.createElement("span");a.classList.add("sl-output-connector"),a.id=`output-${this.gid}`,a.onmousedown=this.domMouseDown.bind(this),i.appendChild(a),this.connector=a,this.dom=i}connectToInput(t){if(console.debug("Connecting to input: ",t),this===t.peerOutput){console.debug("Already connected");return}t.peerOutput&&(console.debug("Disconnecting from: ",t.peerOutput),t.peerOutput.disconnectFromInput(t),t.disconnectFromOutput()),console.debug("Now connecting to: ",t),t.connectToOutput(this);const e=this.createNewSVG(),o=e[0],r=e[1],i={svg:o,line:r,to:t,from:this,connector_x:this.connector_x,connector_y:this.connector_y,x2:0,y2:0,connector:this};this.svgs.push(i),this.g.globalLines.push(i),this.g.canvas.appendChild(o),this.setLineXY(r,t.connector_x-this.connector_x,t.connector_y-this.connector_y),this.parent.outputCount++,t.parent.inputCount++}disconnectFromInput(t){console.debug("Disconnecting from input: ",t);for(const e of this.svgs)if(e.to==t){this.g.canvas.removeChild(e.svg),this.svgs=this.svgs.filter(o=>o!=e),this.g.globalLines=this.g.globalLines.filter(o=>o!=e),console.debug("Deleted line: ",e);break}t.disconnectFromOutput(),this.parent.outputCount--,t.parent.inputCount--}updateConnectorPosition(){this.connector_x=this.parent.position_x+this.c_total_offset_x,this.connector_y=this.parent.position_y+this.c_total_offset_y}getValue(){return this.parent.exec(),this.val}setValue(t){this.val=t}moveToParent(){if(this.updateConnectorPosition(),this.svgTmp.line&&(this.svgTmp.svg.style.transform=`translate3d(${this.connector_x}px, ${this.connector_y}px, 0)`),!(this.svgs.length<1))for(const t of this.svgs)t.svg.style.transform=`translate3d(${this.connector_x}px, ${this.connector_y}px, 0)`,t.connector_x=this.connector_x,t.connector_y=this.connector_y,t.x2=t.to.connector_x-this.connector_x,t.y2=t.to.connector_y-this.connector_y,this.setLineXY(t.line,t.x2,t.y2)}createNewSVG(){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.classList.add("sl-connector-svg"),t.style.pointerEvents="none",t.style.position="absolute",t.style.overflow="visible",t.setAttribute("width","4"),t.setAttribute("height","4"),t.style.willChange="transform";const e=document.createElementNS("http://www.w3.org/2000/svg","line");return e.classList.add("sl-connector-line"),e.setAttribute("stroke-width",`${4*this.g.zoom}`),t.appendChild(e),this.updateConnectorPosition(),t.style.transform=`translate3d(${this.connector_x}px, ${this.connector_y}px, 0)`,this.g.canvas.appendChild(t),[t,e]}customMouseDown(t){const e=this.createNewSVG();this.svgTmp.svg=e[0],this.svgTmp.line=e[1],this.moveToParent(),this.setLineXY(this.svgTmp.line,this.g.dx,this.g.dy)}onDrag(){let t=9999,e=0,o=0;const r=this.g.hoverDOM;if(r&&r.id&&r.id.startsWith("input-")){const i=r.id.split("-")[1],a=this.g.globalNodes[i];a.updateConnectorPosition(),e=a.connector_x,o=a.connector_y,t=Math.sqrt(Math.pow(this.connector_x+this.g.dx/this.g.zoom-e,2)+Math.pow(this.connector_y+this.g.dy/this.g.zoom-o,2))}t<40?this.setLineXY(this.svgTmp.line,e-this.connector_x,o-this.connector_y):this.setLineXY(this.svgTmp.line,this.g.dx/this.g.zoom,this.g.dy/this.g.zoom)}nodeDrag(){this.moveToParent()}domMouseUp(){const t=this.g.hoverDOM;if(t&&t.id&&t.id.startsWith("input-")){console.debug("Connecting to input: ",t.id);const e=this.g.globalNodes[t.id.split("-")[1]];this.connectToInput(e),e.parent.findLeaf()}this.g.canvas.removeChild(this.svgTmp.svg),this.svgTmp={svg:null,line:null}}}class Ft extends G{constructor(t,e,o,r){super(t,e,o);l(this,"parentContent");l(this,"getUIvalue");l(this,"setUIvalue");l(this,"name");this.parentContent=r,this.name=t.name,this.getUIvalue=()=>null,this.setUIvalue=d=>{console.debug(d)};const i=document.createElement("div");switch(i.classList.add("sl-ui"),t.type){case"ui-paragraph":const d=document.createElement("p");d.style.pointerEvents="none",d.innerText=t.text,i.appendChild(d);break;case"ui-display":const c=document.createElement("p");c.style.pointerEvents="none",c.innerText="Output",i.appendChild(c),this.setSetFunction(f=>{c.innerText=f});break;case"ui-dropdown":const m=document.createElement("select");m.classList.add("sl-ui-dropdown");for(const f of t.values){const g=document.createElement("option");g.innerText=f.label,g.value=f.value,m.appendChild(g)}i.appendChild(m),this.setGetFunction(()=>m.value),this.setExecTrigger(m,"change");break}this.dom=i,this.name&&(this.parent.elements[this.name]=this)}setExecTrigger(t,e){t.addEventListener(e,()=>{var o;(o=this.parent)==null||o.findLeaf()}),console.debug(t,e)}setGetFunction(t){this.getUIvalue=t}setSetFunction(t){this.setUIvalue=t}getValue(){return this.getUIvalue()}setValue(t){return this.setUIvalue(t)}}class Pt extends G{constructor(t,e,o,r){super(t,e,o);l(this,"parentContent");l(this,"getUIvalue");l(this,"setUIvalue");this.parentContent=r,this.getUIvalue=()=>null,this.setUIvalue=a=>{console.debug(a)};const i=document.createElement("template");i.innerHTML=t.html.trim(),this.dom=i.content.firstChild}setExecTrigger(t,e){console.debug(t,e)}setGetFunction(t){this.getUIvalue=t}setSetFunction(t){this.setUIvalue=t}getValue(){return this.getUIvalue()}setValue(t){return this.setUIvalue(t)}}class Wt extends ut{constructor(t,e,o=0,r=0){super(e);l(this,"config");l(this,"inputs");l(this,"outputs");l(this,"inputCount");l(this,"outputCount");l(this,"elements");l(this,"dom");l(this,"hasIandO");l(this,"nodeWidth");l(this,"nodeHeight");l(this,"nodeContainerWidth");l(this,"nodeContainerHeight");l(this,"nodeContainerOffsetLeft");l(this,"nodeContainerOffsetTop");l(this,"functions");l(this,"pan_start_x");l(this,"pan_start_y");l(this,"overlapping");this.config=t,this.position_x=o,this.position_y=r,this.inputs=[],this.outputs=[],this.inputCount=0,this.outputCount=0,this.elements={},this.pan_start_x=0,this.pan_start_y=0,this.overlapping=null;const i=document.createElement("div");i.classList.add("sl-node"),i.style.willChange="transform",i.style.position="absolute",i.style.transformOrigin="top left",i.style.position="absolute";const a=document.createElement("div");a.classList.add("sl-node-container"),a.style.position="relative";for(const d of t.elements){const c=document.createElement("div");if(c.style.position="relative",c.style.display="flex",c.style.flexDirection="row",c.classList.add("sl-node-content"),a.appendChild(c),d instanceof Array)for(const m of d){const f=this._initParseComponent(m,c);f&&c.appendChild(f.dom)}else{const m=this._initParseComponent(d,c);m&&c.appendChild(m.dom)}a.appendChild(c)}if(i.appendChild(a),i.id=this.gid,i.onmousedown=this.domMouseDown.bind(this),this.dom=i,this.inputs.length>0&&this.outputs.length>0?this.hasIandO=!0:this.hasIandO=!1,this.g.canvas.appendChild(i),this.nodeWidth=i.offsetWidth,this.nodeHeight=i.offsetHeight,this.nodeContainerWidth=a.offsetWidth,this.nodeContainerHeight=a.offsetHeight,this.nodeContainerOffsetLeft=a.offsetLeft,this.nodeContainerOffsetTop=a.offsetTop,this.updateDOMproperties(),this.g.nodeArray.push(this),new ResizeObserver(()=>{this.updateDOMproperties()}).observe(this.dom),this.functions=[],t.functions){this.functions=t.functions;for(const[d,c]of Object.entries(this.functions))c.functionInit!==void 0&&c.functionInit(this)}}_initParseComponent(t,e){let o=null;switch(t.type){case"input-text":case"input-bool":o=new Ut(t,this,this.g,e),o.parent=this,this.g.globalNodes[o.gid]=o,this.inputs.push(o);break;case"output-text":o=new At(t,this,this.g,e),o.parent=this,this.g.globalNodes[o.gid]=o,this.outputs.push(o);break;case"ui-display":case"ui-dropdown":case"ui-paragraph":o=new Ft(t,this,this.g,e),o.parent=this,this.g.globalNodes[o.gid]=o;break;case"custom":o=new Pt(t,this,this.g,e),o.parent=this,this.g.globalNodes[o.gid]=o;break;default:console.warn("Unknown type "+t.type)}return o}customMouseDown(t){console.debug(t),this.pan_start_x=this.position_x,this.pan_start_y=this.position_y}domMouseUp(){if(this.position_x=this.pan_start_x+this.g.dx/this.g.zoom,this.position_y=this.pan_start_y+this.g.dy/this.g.zoom,this.overlapping==null)return;const t=this.overlapping.from,e=this.overlapping.to,o=this.inputs[0],r=this.outputs[0];t.disconnectFromInput(e),t.connectToInput(o),r.connectToInput(e)}onPan(){this.dom.style.transform=`translate3d(${this.position_x}px, ${this.position_y}px, 0)`;for(const t of this.inputs)t.onPan();for(const t of this.outputs)t.onPan()}onDrag(){this.position_x=this.pan_start_x+this.g.dx/this.g.zoom,this.position_y=this.pan_start_y+this.g.dy/this.g.zoom,this.dom.style.transform=`translate3d(${this.position_x}px, ${this.position_y}px, 0)`;for(const e of this.inputs)e.nodeDrag();for(const e of this.outputs)e.nodeDrag();if(this.overlapping=null,!this.hasIandO||this.outputCount>0||this.inputCount>0)return;let t=9999;for(const e of this.g.globalLines)e.line.classList.remove("overlapping"),at(this.position_x+this.nodeWidth/2,e.connector_x,e.connector_x+e.x2)&&at(this.position_y+this.nodeHeight/2,e.connector_y,e.connector_y+e.y2)&&(e.y2+e.connector_x)/2<t&&(this.overlapping=e,t=(e.y2+this.position_y)/2);!this.overlapping||this.overlapping.line.classList.add("overlapping")}onFocus(){for(const t of this.g.nodeArray)t.dom.classList.remove("focused"),t.dom.style.zIndex="10";this.dom.classList.add("focused"),this.dom.style.zIndex="20"}offFocus(){this.dom.classList.remove("focused"),this.dom.style.zIndex="10"}updateDOMproperties(){this.nodeHeight=this.dom.offsetHeight,this.nodeWidth=this.dom.offsetWidth;for(const t of this.inputs)t.updateDOMproperties();for(const t of this.outputs)t.updateDOMproperties()}findLeaf(){var e;let t=0;for(const[o,r]of Object.entries(this.functions))for(const i of r.outputs){const a=this.elements[i];if(a==null){console.warn(`Output '${i}' was not found in elements. Double check '${i}' is defined.`);return}if(!(!a.svgs||a.svgs.length<1)){t++;for(const d of a.svgs)(e=d.to.parent)==null||e.findLeaf()}}t===0&&this.exec()}exec(){if(!!this.functions)for(const[t,e]of Object.entries(this.functions)){const o=[this];for(const i of e.inputs)if(i in this.elements){const a=this.elements[i];o.push(a.getValue())}const r=e.functionUpdate(...o);for(const i of e.outputs){const a=this.elements[i];if(a==null){console.warn(`Output '${i}' was not found in elements. Double check '${i}' is defined.`);return}a.setValue(r)}}}}class Ht{constructor(s){l(this,"g");this.g={canvas:null,canvasContainer:null,isMouseDown:!1,mousedown_x:0,mousedown_y:0,mouse_x:0,mouse_y:0,camera_pan_start_x:0,camera_pan_start_y:0,dx:0,dy:0,dx_offset:0,dy_offset:0,camera_x:0,camera_y:0,zoom:1,cameraWidth:0,cameraHeight:0,targetNode:null,hoverDOM:null,gid:0,nodeArray:[],globalLines:[],globalNodes:{}};const t=this.g;if(t.canvasContainer=document.getElementById(s),!t.canvasContainer){console.error("Canvas not found");return}t.cameraWidth=t.canvasContainer.clientWidth,t.cameraHeight=t.canvasContainer.clientHeight,console.debug(`Canvas size: ${t.cameraWidth}x${t.cameraHeight}`);const e=document.createElement("div");e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.className="canvas",t.canvasContainer.appendChild(e),t.canvas=e,t.canvas.style.transform=`translate(${t.cameraWidth/2}px, ${t.cameraHeight/2}px)`,t.canvasContainer.addEventListener("mousedown",function(o){t.isMouseDown=!0,t.mousedown_x=o.clientX,t.mousedown_y=o.clientY,t.camera_pan_start_x=t.camera_x,t.camera_pan_start_y=t.camera_y;for(const r of t.nodeArray)r.offFocus()}),t.canvasContainer.addEventListener("mousemove",function(o){t.hoverDOM=o.target,t.mouse_x=o.clientX-t.canvasContainer.offsetLeft,t.mouse_y=o.clientY-t.canvasContainer.offsetTop,t.isMouseDown&&(t.dx=o.clientX-t.mousedown_x+t.dx_offset,t.dy=o.clientY-t.mousedown_y+t.dy_offset,t.targetNode==null&&(t.camera_x=t.camera_pan_start_x-t.dx/t.zoom,t.camera_y=t.camera_pan_start_y-t.dy/t.zoom,t.canvas.style.transform=`matrix3d(${ct(t.camera_x,t.camera_y,t)})`,t.canvas.style.cursor="grabbing"))}),t.canvasContainer.addEventListener("wheel",function(o){const r=1*t.zoom*(-o.deltaY/600);if(o.preventDefault(),t.zoom+r<.2){t.zoom=.2;return}else if(t.zoom+r>3){t.zoom=3;return}const i=(t.mouse_x-t.cameraWidth/2)*r,a=(t.mouse_y-t.cameraHeight/2)*r;t.zoom+=r,t.camera_x+=i/t.zoom/t.zoom,t.camera_y+=a/t.zoom/t.zoom,t.canvas.style.transform=`matrix3d(${ct(t.camera_x,t.camera_y,t)})`,o.preventDefault()}),t.canvasContainer.addEventListener("mouseup",function(o){t.isMouseDown=!1,t.canvas.style.cursor="default",t.targetNode==null||t.targetNode.domMouseUp(),t.targetNode=null,t.dx=0,t.dy=0,t.dx_offset=0,t.dy_offset=0}),console.info("Initialized SnapLine..."),window.requestAnimationFrame(this.step.bind(this))}step(){this.g.targetNode&&this.g.targetNode.onDrag(),window.requestAnimationFrame(this.step.bind(this))}addNode(s,t,e){const o=new Wt(s,this.g,t,e);return this.g.globalNodes[o.gid]=o,o}deleteNode(s){console.debug(s)}connectNodes(s,t,e,o){console.debug(s,t,e,o)}}function Vt(n){let s,t,e,o,r,i,a,d,c,m,f,g,x,b,Q,W,C,K,H,k,J,E,v,L,Z,y,V,O,tt,Y,z,et,N,j,nt;return{c(){s=h("base"),t=w(),e=h("main"),o=h("link"),i=w(),a=h("navbar"),d=h("div"),c=h("div"),m=h("label"),m.textContent="Add Node",f=w(),g=h("ul"),x=h("li"),b=h("button"),b.textContent="Math",Q=w(),W=h("li"),C=h("button"),C.textContent="YouTube",K=w(),H=h("li"),k=h("button"),k.textContent="Print",J=w(),E=h("div"),v=h("div"),L=h("label"),L.textContent="Theme",Z=w(),y=h("ul"),V=h("li"),O=h("button"),O.textContent="Standard",tt=w(),Y=h("li"),z=h("button"),z.textContent="Retro",et=w(),N=h("div"),p(s,"href","BASEURL"),p(o,"href",r="lib/theme/"+n[1]),p(o,"rel","stylesheet"),p(o,"type","text/css"),p(m,"tabindex","0"),p(m,"class","btn btn-sm"),p(b,"class","btn-sm"),p(C,"class","btn-sm"),p(k,"class","btn-sm"),p(g,"tabindex","0"),p(g,"class","dropdown-content menu p-2 shadow bg-base-100 rounded-box w-52"),p(c,"class","dropdown"),p(d,"class","flex-1"),p(L,"tabindex","0"),p(L,"class","btn btn-sm btn-outline"),p(O,"class","btn-sm"),p(z,"class","btn-sm"),p(y,"tabindex","0"),p(y,"class","dropdown-content menu p-2 shadow bg-base-100 rounded-box w-52"),p(v,"class","dropdown dropdown-end"),p(E,"class","flex-none"),p(a,"class","navbar px-5 fixed z-20 bg-white shadow-sm"),p(N,"class","w-full h-screen bg-white overflow-hidden relative select-none"),p(N,"id","node-editor")},m(_,S){u(document.head,s),st(_,t,S),st(_,e,S),u(e,o),u(e,i),u(e,a),u(a,d),u(d,c),u(c,m),u(c,f),u(c,g),u(g,x),u(x,b),u(g,Q),u(g,W),u(W,C),u(g,K),u(g,H),u(H,k),u(a,J),u(a,E),u(E,v),u(v,L),u(v,Z),u(v,y),u(y,V),u(V,O),u(y,tt),u(y,Y),u(Y,z),u(e,et),u(e,N),j||(nt=[I(b,"click",n[3]),I(C,"click",n[4]),I(k,"click",n[5]),I(O,"click",n[6]),I(z,"click",n[7])],j=!0)},p(_,[S]){S&2&&r!==(r="lib/theme/"+_[1])&&p(o,"href",r)},i:P,o:P,d(_){A(s),_&&A(t),_&&A(e),j=!1,M(nt)}}}function Yt(n,s,t){let e=null;vt(async()=>{t(0,e=new Ht("node-editor"))});let o="standard.css";function r(f){t(1,o=f)}return[e,o,r,()=>e.addNode(Nt,0,0),()=>e.addNode(Et,0,0),()=>e.addNode(St,0,0),()=>r("standard.css"),()=>r("retro.css")]}class jt extends Mt{constructor(s){super(),Dt(this,s,Yt,Vt,wt,{})}}new jt({target:document.getElementById("app")});
