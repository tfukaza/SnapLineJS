var dt=Object.defineProperty;var ut=(e,n,t)=>n in e?dt(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var l=(e,n,t)=>(ut(e,typeof n!="symbol"?n+"":n,t),t);const pt=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}};pt();function A(){}function it(e){return e()}function tt(){return Object.create(null)}function M(e){e.forEach(it)}function ht(e){return typeof e=="function"}function ft(e,n){return e!=e?n==n:e!==n||e&&typeof e=="object"||typeof e=="function"}function mt(e){return Object.keys(e).length===0}function u(e,n){e.appendChild(n)}function gt(e,n,t){e.insertBefore(n,t||null)}function rt(e){e.parentNode.removeChild(e)}function f(e){return document.createElement(e)}function wt(e){return document.createTextNode(e)}function w(){return wt(" ")}function I(e,n,t,o){return e.addEventListener(n,t,o),()=>e.removeEventListener(n,t,o)}function h(e,n,t){t==null?e.removeAttribute(n):e.getAttribute(n)!==t&&e.setAttribute(n,t)}function bt(e){return Array.from(e.childNodes)}let D;function $(e){D=e}function yt(){if(!D)throw new Error("Function called outside component initialization");return D}function _t(e){yt().$$.on_mount.push(e)}const T=[],et=[],U=[],nt=[],xt=Promise.resolve();let j=!1;function vt(){j||(j=!0,xt.then(at))}function X(e){U.push(e)}const Y=new Set;let S=0;function at(){const e=D;do{for(;S<T.length;){const n=T[S];S++,$(n),Ct(n.$$)}for($(null),T.length=0,S=0;et.length;)et.pop()();for(let n=0;n<U.length;n+=1){const t=U[n];Y.has(t)||(Y.add(t),t())}U.length=0}while(T.length);for(;nt.length;)nt.pop()();j=!1,Y.clear(),$(e)}function Ct(e){if(e.fragment!==null){e.update(),M(e.before_update);const n=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,n),e.after_update.forEach(X)}}const kt=new Set;function Ot(e,n){e&&e.i&&(kt.delete(e),e.i(n))}function zt(e,n,t,o){const{fragment:s,on_mount:r,on_destroy:i,after_update:a}=e.$$;s&&s.m(n,t),o||X(()=>{const d=r.map(it).filter(ht);i?i.push(...d):M(d),e.$$.on_mount=[]}),a.forEach(X)}function Lt(e,n){const t=e.$$;t.fragment!==null&&(M(t.on_destroy),t.fragment&&t.fragment.d(n),t.on_destroy=t.fragment=null,t.ctx=[])}function It(e,n){e.$$.dirty[0]===-1&&(T.push(e),vt(),e.$$.dirty.fill(0)),e.$$.dirty[n/31|0]|=1<<n%31}function Tt(e,n,t,o,s,r,i,a=[-1]){const d=D;$(e);const c=e.$$={fragment:null,ctx:null,props:r,update:A,not_equal:s,bound:tt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(d?d.$$.context:[])),callbacks:tt(),dirty:a,skip_bound:!1,root:n.target||d.$$.root};i&&i(c.root);let p=!1;if(c.ctx=t?t(e,n.props||{},(m,g,...b)=>{const _=b.length?b[0]:g;return c.ctx&&s(c.ctx[m],c.ctx[m]=_)&&(!c.skip_bound&&c.bound[m]&&c.bound[m](_),p&&It(e,m)),g}):[],c.update(),p=!0,M(c.before_update),c.fragment=o?o(c.ctx):!1,n.target){if(n.hydrate){const m=bt(n.target);c.fragment&&c.fragment.l(m),m.forEach(rt)}else c.fragment&&c.fragment.c();n.intro&&Ot(e.$$.fragment),zt(e,n.target,n.anchor,n.customElement),at()}$(d)}class $t{$destroy(){Lt(this,1),this.$destroy=A}$on(n,t){const o=this.$$.callbacks[n]||(this.$$.callbacks[n]=[]);return o.push(t),()=>{const s=o.indexOf(t);s!==-1&&o.splice(s,1)}}$set(n){this.$$set&&!mt(n)&&(this.$$.skip_bound=!0,this.$$set(n),this.$$.skip_bound=!1)}}const Dt={functions:{visualize:{inputs:["Video ID","Show Controls"],outputs:[],functionInit:e=>{e.yt=e.dom.querySelector(".yt")},functionUpdate:(e,n,t)=>{n||(n="m4-HM_sCvtQ"),e.yt.src="https://www.youtube.com/embed/"+n+"?autoplay=1&controls="+(t?"1":"0")}}},elements:[{type:"input-text",name:"Video ID"},{type:"input-bool",name:"Show Controls"},{type:"custom",html:`
        <iframe class="yt rounded-lg" width="560" height="315" src="https://www.youtube.com/embed/m4-HM_sCvtQ?autoplay=1&controls=0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
      `}]},Mt={functions:{output:{inputs:["Input 1","Input 2","Operation"],outputs:["Result"],functionUpdate:(e,n,t,o)=>{switch(o){case"+":return n+t;case"-":return n-t;case"*":return n*t;case"/":return n/t;default:return 0}}}},elements:[{type:"output-text",name:"Result"},[{type:"ui-dropdown",name:"Operation",values:[{value:"+",label:"Add"},{value:"-",label:"Subtract"},{value:"*",label:"Multiply"},{value:"/",label:"Divide"}]}],[{type:"input-text",name:"Input 1"}],[{type:"input-text",name:"Input 2"}]]},Et={functions:{output:{inputs:["Input"],outputs:[],functionInit:(e,n)=>{e.display=e.dom.querySelector(".display")},functionUpdate:(e,n)=>{e.display.innerText=n}}},elements:[{type:"input-text",name:"Input"},{type:"custom",name:"Display",html:`
      <div class="bg-red rounded-lg">
        <span class="display text-3xl"></span>
      </div>
      `}]};function ot(e,n,t){return e>=n&&e<=t||e>=t&&e<=n}function st(e,n,t){const o=t.zoom,s=t.zoom,r=-e*t.zoom+t.cameraWidth/2,i=-n*t.zoom+t.cameraHeight/2;return`${o},0,0,0,0,${s},0,0,0,0,1,0,${r},${i},0,1`}function B(e,n){if(n.name==="")return;const t=document.createElement("span");t.classList.add("sl-label"),t.innerText=n.name,e.appendChild(t)}class ct{constructor(n){l(this,"g");l(this,"gid");l(this,"position_x");l(this,"position_y");this.g=n,n.gid++,this.gid=n.gid.toString(),this.position_x=0,this.position_y=0}domMouseDown(n){this.g.isMouseDown=!0,this.g.targetNode=this,this.g.mousedown_x=n.clientX,this.g.mousedown_y=n.clientY,this.g.dx=0,this.g.dy=0,this.g.dx_offset=0,this.g.dy_offset=0,this.onFocus(),this.customMouseDown(n),n.stopPropagation()}customMouseDown(n){console.debug(n)}domMouseUp(){}onFocus(){}offFocus(){}onDrag(){}onPan(){}}class R extends ct{constructor(t,o,s){super(s);l(this,"parent");l(this,"config");l(this,"dom");this.config=t,this.parent=o,this.dom=null}}class lt extends R{constructor(t,o,s,r){super(t,o,s);l(this,"connector_x");l(this,"connector_y");l(this,"c_total_offset_x");l(this,"c_total_offset_y");l(this,"name");l(this,"parentContent");l(this,"connector");this.connector_x=0,this.connector_y=0,this.c_total_offset_x=0,this.c_total_offset_y=0,this.dom=null,this.parentContent=r,this.connector=null,t.name?this.name=t.name:(s.gid++,this.name=s.gid.toString()),this.parent.elements[this.name]=this,this.g.globalNodes[this.gid]=this}pxToInt(t){return parseInt(t.substring(0,t.length-2))}updateDOMproperties(){const t=this.parent.nodeContainerOffsetLeft,o=this.parent.nodeContainerOffsetTop,s=0;this.pxToInt(window.getComputedStyle(this.parentContent).marginLeft)+this.pxToInt(window.getComputedStyle(this.parentContent).paddingLeft)+this.pxToInt(window.getComputedStyle(this.parentContent).borderLeftWidth)+this.parentContent.offsetLeft;const r=this.parentContent.offsetTop,i=this.pxToInt(window.getComputedStyle(this.connector).marginLeft)+this.pxToInt(window.getComputedStyle(this.connector).paddingLeft)+this.pxToInt(window.getComputedStyle(this.connector).borderLeftWidth)+this.connector.offsetLeft,a=this.pxToInt(window.getComputedStyle(this.connector).marginTop)+this.pxToInt(window.getComputedStyle(this.connector).paddingTop)+this.pxToInt(window.getComputedStyle(this.connector).borderTopWidth)+this.connector.offsetTop;console.debug(`connector_offset_x: ${i} connector_offset_y: ${a}`);const d=this.connector.getBoundingClientRect().width,c=this.connector.getBoundingClientRect().height;this.c_total_offset_x=t+s+i+d/2,this.c_total_offset_y=o+r+a+c/2}setLineXY(t,o,s){t.setAttribute("x1",""+0),t.setAttribute("y1",""+0),t.setAttribute("x2",""+o),t.setAttribute("y2",""+s),t.setAttribute("stroke-width",`${4*this.g.zoom}`)}}class Nt extends lt{constructor(t,o,s,r){super(t,o,s,r);l(this,"inputDOM");l(this,"inputValue");l(this,"peerOutput");this.inputDOM=null,this.peerOutput=null;const i=document.createElement("div");i.classList.add("sl-input");const a=document.createElement("span");switch(a.classList.add("sl-input-connector"),a.id=`input-${this.gid}`,a.onmousedown=this.domMouseDown.bind(this),i.appendChild(a),this.inputValue=()=>{},t.type){case"input-text":{B(i,t);const d=document.createElement("input");d.classList.add("sl-input-text"),d.type="text",i.appendChild(d),this.inputDOM=d,d.onkeyup=()=>{var c;(c=this.parent)==null||c.findLeaf()},this.inputValue=()=>this.inputDOM.value}break;case"input-bool":{B(i,t);const d=document.createElement("input");d.classList.add("sl-input-bool"),d.type="checkbox",i.appendChild(d),this.inputDOM=d,d.onchange=()=>{var c;(c=this.parent)==null||c.findLeaf()},this.inputValue=()=>this.inputDOM.checked}break}this.connector=a,this.dom=i}domMouseDown(t){this.peerOutput&&(super.domMouseDown(t),this.g.targetNode=this.peerOutput,this.g.dx_offset=(this.connector_x-this.peerOutput.connector_x)*this.g.zoom,this.g.dy_offset=(this.connector_y-this.peerOutput.connector_y)*this.g.zoom,this.g.dx=this.g.dx_offset,this.g.dy=this.g.dy_offset,this.peerOutput.customMouseDown(t),this.peerOutput.disconnectFromInput(this),t.stopPropagation())}updateConnectorPosition(){this.connector_x=this.parent.position_x+this.c_total_offset_x,this.connector_y=this.parent.position_y+this.c_total_offset_y}disconnectFromOutput(){var t;this.peerOutput=null,(t=this.dom)==null||t.classList.remove("connected")}connectToOutput(t){var o;this.peerOutput=t,(o=this.dom)==null||o.classList.add("connected")}nodeDrag(){this.updateConnectorPosition(),this.peerOutput&&this.peerOutput.nodeDrag()}getValue(){return this.peerOutput?this.peerOutput.getValue():this.inputDOM?this.inputValue():null}}class St extends lt{constructor(t,o,s,r){super(t,o,s,r);l(this,"val");l(this,"svgTmp");l(this,"svgs");this.val=null,this.svgTmp={svg:null,line:null},this.svgs=[];const i=document.createElement("div");i.classList.add("sl-output"),B(i,t);const a=document.createElement("span");a.classList.add("sl-output-connector"),a.id=`output-${this.gid}`,a.onmousedown=this.domMouseDown.bind(this),i.appendChild(a),this.connector=a,this.dom=i}connectToInput(t){if(console.debug("Connecting to input: ",t),this===t.peerOutput){console.debug("Already connected");return}t.peerOutput&&(console.debug("Disconnecting from: ",t.peerOutput),t.peerOutput.disconnectFromInput(t),t.disconnectFromOutput()),console.debug("Now connecting to: ",t),t.connectToOutput(this);const o=this.createNewSVG(),s=o[0],r=o[1],i={svg:s,line:r,to:t,from:this,connector_x:this.connector_x,connector_y:this.connector_y,x2:0,y2:0,connector:this};this.svgs.push(i),this.g.globalLines.push(i),this.g.canvas.appendChild(s),this.setLineXY(r,t.connector_x-this.connector_x,t.connector_y-this.connector_y),this.parent.outputCount++,t.parent.inputCount++}disconnectFromInput(t){console.debug("Disconnecting from input: ",t);for(const o of this.svgs)if(o.to==t){this.g.canvas.removeChild(o.svg),this.svgs=this.svgs.filter(s=>s!=o),this.g.globalLines=this.g.globalLines.filter(s=>s!=o),console.debug("Deleted line: ",o);break}t.disconnectFromOutput(),this.parent.outputCount--,t.parent.inputCount--}updateConnectorPosition(){this.connector_x=this.parent.position_x+this.c_total_offset_x,this.connector_y=this.parent.position_y+this.c_total_offset_y}getValue(){return this.parent.exec(),this.val}setValue(t){this.val=t}moveToParent(){if(this.updateConnectorPosition(),this.svgTmp.line&&(this.svgTmp.svg.style.transform=`translate3d(${this.connector_x}px, ${this.connector_y}px, 0)`),!(this.svgs.length<1))for(const t of this.svgs)t.svg.style.transform=`translate3d(${this.connector_x}px, ${this.connector_y}px, 0)`,t.connector_x=this.connector_x,t.connector_y=this.connector_y,t.x2=t.to.connector_x-this.connector_x,t.y2=t.to.connector_y-this.connector_y,this.setLineXY(t.line,t.x2,t.y2)}createNewSVG(){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.classList.add("sl-connector-svg"),t.style.pointerEvents="none",t.style.position="absolute",t.style.overflow="visible",t.setAttribute("width","4"),t.setAttribute("height","4"),t.style.willChange="transform";const o=document.createElementNS("http://www.w3.org/2000/svg","line");return o.classList.add("sl-connector-line"),o.setAttribute("stroke-width",`${4*this.g.zoom}`),t.appendChild(o),this.updateConnectorPosition(),t.style.transform=`translate3d(${this.connector_x}px, ${this.connector_y}px, 0)`,this.g.canvas.appendChild(t),[t,o]}customMouseDown(t){const o=this.createNewSVG();this.svgTmp.svg=o[0],this.svgTmp.line=o[1],this.moveToParent(),this.setLineXY(this.svgTmp.line,this.g.dx,this.g.dy)}onDrag(){let t=9999,o=0,s=0;const r=this.g.hoverDOM;if(r&&r.id&&r.id.startsWith("input-")){const i=r.id.split("-")[1],a=this.g.globalNodes[i];a.updateConnectorPosition(),o=a.connector_x,s=a.connector_y,t=Math.sqrt(Math.pow(this.connector_x+this.g.dx/this.g.zoom-o,2)+Math.pow(this.connector_y+this.g.dy/this.g.zoom-s,2))}t<40?this.setLineXY(this.svgTmp.line,o-this.connector_x,s-this.connector_y):this.setLineXY(this.svgTmp.line,this.g.dx/this.g.zoom,this.g.dy/this.g.zoom)}nodeDrag(){this.moveToParent()}domMouseUp(){const t=this.g.hoverDOM;if(t&&t.id&&t.id.startsWith("input-")){console.debug("Connecting to input: ",t.id);const o=this.g.globalNodes[t.id.split("-")[1]];this.connectToInput(o),o.parent.findLeaf()}this.g.canvas.removeChild(this.svgTmp.svg),this.svgTmp={svg:null,line:null}}}class Ut extends R{constructor(t,o,s,r){super(t,o,s);l(this,"parentContent");l(this,"getUIvalue");l(this,"setUIvalue");l(this,"name");this.parentContent=r,this.name=t.name,this.getUIvalue=()=>null,this.setUIvalue=d=>{console.debug(d)};const i=document.createElement("div");switch(i.classList.add("sl-ui"),t.type){case"ui-paragraph":const d=document.createElement("p");d.style.pointerEvents="none",d.innerText=t.text,i.appendChild(d);break;case"ui-display":const c=document.createElement("p");c.style.pointerEvents="none",c.innerText="Output",i.appendChild(c),this.setSetFunction(m=>{c.innerText=m});break;case"ui-dropdown":const p=document.createElement("select");p.classList.add("sl-ui-dropdown");for(const m of t.values){const g=document.createElement("option");g.innerText=m.label,g.value=m.value,p.appendChild(g)}i.appendChild(p),this.setGetFunction(()=>p.value),this.setExecTrigger(p,"change");break}this.dom=i,this.name&&(this.parent.elements[this.name]=this)}setExecTrigger(t,o){t.addEventListener(o,()=>{var s;(s=this.parent)==null||s.findLeaf()}),console.debug(t,o)}setGetFunction(t){this.getUIvalue=t}setSetFunction(t){this.setUIvalue=t}getValue(){return this.getUIvalue()}setValue(t){return this.setUIvalue(t)}}class At extends R{constructor(t,o,s,r){super(t,o,s);l(this,"parentContent");l(this,"getUIvalue");l(this,"setUIvalue");this.parentContent=r,this.getUIvalue=()=>null,this.setUIvalue=a=>{console.debug(a)};const i=document.createElement("template");i.innerHTML=t.html.trim(),this.dom=i.content.firstChild}setExecTrigger(t,o){console.debug(t,o)}setGetFunction(t){this.getUIvalue=t}setSetFunction(t){this.setUIvalue=t}getValue(){return this.getUIvalue()}setValue(t){return this.setUIvalue(t)}}class Ft extends ct{constructor(t,o,s=0,r=0){super(o);l(this,"config");l(this,"inputs");l(this,"outputs");l(this,"inputCount");l(this,"outputCount");l(this,"elements");l(this,"dom");l(this,"hasIandO");l(this,"nodeWidth");l(this,"nodeHeight");l(this,"nodeContainerWidth");l(this,"nodeContainerHeight");l(this,"nodeContainerOffsetLeft");l(this,"nodeContainerOffsetTop");l(this,"functions");l(this,"pan_start_x");l(this,"pan_start_y");l(this,"overlapping");this.config=t,this.position_x=s,this.position_y=r,this.inputs=[],this.outputs=[],this.inputCount=0,this.outputCount=0,this.elements={},this.pan_start_x=0,this.pan_start_y=0,this.overlapping=null;const i=document.createElement("div");i.classList.add("sl-node"),i.style.willChange="transform",i.style.position="absolute",i.style.transformOrigin="top left",i.style.position="absolute";const a=document.createElement("div");a.classList.add("sl-node-container"),a.style.position="relative";for(const d of t.elements){const c=document.createElement("div");if(c.style.position="relative",c.style.display="flex",c.style.flexDirection="row",c.classList.add("sl-node-content"),a.appendChild(c),d instanceof Array)for(const p of d){const m=this._initParseComponent(p,c);m&&c.appendChild(m.dom)}else{const p=this._initParseComponent(d,c);p&&c.appendChild(p.dom)}a.appendChild(c)}if(i.appendChild(a),i.id=this.gid,i.onmousedown=this.domMouseDown.bind(this),this.dom=i,this.inputs.length>0&&this.outputs.length>0?this.hasIandO=!0:this.hasIandO=!1,this.g.canvas.appendChild(i),this.nodeWidth=i.offsetWidth,this.nodeHeight=i.offsetHeight,this.nodeContainerWidth=a.offsetWidth,this.nodeContainerHeight=a.offsetHeight,this.nodeContainerOffsetLeft=a.offsetLeft,this.nodeContainerOffsetTop=a.offsetTop,this.updateDOMproperties(),this.g.nodeArray.push(this),new ResizeObserver(()=>{this.updateDOMproperties()}).observe(this.dom),this.functions=[],t.functions){this.functions=t.functions;for(const[d,c]of Object.entries(this.functions))c.functionInit!==void 0&&c.functionInit(this)}}_initParseComponent(t,o){let s=null;switch(t.type){case"input-text":case"input-bool":s=new Nt(t,this,this.g,o),s.parent=this,this.g.globalNodes[s.gid]=s,this.inputs.push(s);break;case"output-text":s=new St(t,this,this.g,o),s.parent=this,this.g.globalNodes[s.gid]=s,this.outputs.push(s);break;case"ui-display":case"ui-dropdown":case"ui-paragraph":s=new Ut(t,this,this.g,o),s.parent=this,this.g.globalNodes[s.gid]=s;break;case"custom":s=new At(t,this,this.g,o),s.parent=this,this.g.globalNodes[s.gid]=s;break;default:console.warn("Unknown type "+t.type)}return s}customMouseDown(t){console.debug(t),this.pan_start_x=this.position_x,this.pan_start_y=this.position_y}domMouseUp(){if(this.position_x=this.pan_start_x+this.g.dx/this.g.zoom,this.position_y=this.pan_start_y+this.g.dy/this.g.zoom,this.overlapping==null)return;const t=this.overlapping.from,o=this.overlapping.to,s=this.inputs[0],r=this.outputs[0];t.disconnectFromInput(o),t.connectToInput(s),r.connectToInput(o)}onPan(){this.dom.style.transform=`translate3d(${this.position_x}px, ${this.position_y}px, 0)`;for(const t of this.inputs)t.onPan();for(const t of this.outputs)t.onPan()}onDrag(){this.position_x=this.pan_start_x+this.g.dx/this.g.zoom,this.position_y=this.pan_start_y+this.g.dy/this.g.zoom,this.dom.style.transform=`translate3d(${this.position_x}px, ${this.position_y}px, 0)`;for(const o of this.inputs)o.nodeDrag();for(const o of this.outputs)o.nodeDrag();if(this.overlapping=null,!this.hasIandO||this.outputCount>0||this.inputCount>0)return;let t=9999;for(const o of this.g.globalLines)o.line.classList.remove("overlapping"),ot(this.position_x+this.nodeWidth/2,o.connector_x,o.connector_x+o.x2)&&ot(this.position_y+this.nodeHeight/2,o.connector_y,o.connector_y+o.y2)&&(o.y2+o.connector_x)/2<t&&(this.overlapping=o,t=(o.y2+this.position_y)/2);!this.overlapping||this.overlapping.line.classList.add("overlapping")}onFocus(){for(const t of this.g.nodeArray)t.dom.classList.remove("focused"),t.dom.style.zIndex="10";this.dom.classList.add("focused"),this.dom.style.zIndex="20"}offFocus(){this.dom.classList.remove("focused"),this.dom.style.zIndex="10"}updateDOMproperties(){this.nodeHeight=this.dom.offsetHeight,this.nodeWidth=this.dom.offsetWidth;for(const t of this.inputs)t.updateDOMproperties();for(const t of this.outputs)t.updateDOMproperties()}findLeaf(){var o;let t=0;for(const[s,r]of Object.entries(this.functions))for(const i of r.outputs){const a=this.elements[i];if(a==null){console.warn(`Output '${i}' was not found in elements. Double check '${i}' is defined.`);return}if(!(!a.svgs||a.svgs.length<1)){t++;for(const d of a.svgs)(o=d.to.parent)==null||o.findLeaf()}}t===0&&this.exec()}exec(){if(!!this.functions)for(const[t,o]of Object.entries(this.functions)){const s=[this];for(const i of o.inputs)if(i in this.elements){const a=this.elements[i];s.push(a.getValue())}const r=o.functionUpdate(...s);for(const i of o.outputs){const a=this.elements[i];if(a==null){console.warn(`Output '${i}' was not found in elements. Double check '${i}' is defined.`);return}a.setValue(r)}}}}class Pt{constructor(n){l(this,"g");this.g={canvas:null,canvasContainer:null,isMouseDown:!1,mousedown_x:0,mousedown_y:0,mouse_x:0,mouse_y:0,camera_pan_start_x:0,camera_pan_start_y:0,dx:0,dy:0,dx_offset:0,dy_offset:0,camera_x:0,camera_y:0,zoom:1,cameraWidth:0,cameraHeight:0,targetNode:null,hoverDOM:null,gid:0,nodeArray:[],globalLines:[],globalNodes:{}};const t=this.g;if(t.canvasContainer=document.getElementById(n),!t.canvasContainer){console.error("Canvas not found");return}t.cameraWidth=t.canvasContainer.clientWidth,t.cameraHeight=t.canvasContainer.clientHeight,console.debug(`Canvas size: ${t.cameraWidth}x${t.cameraHeight}`);const o=document.createElement("div");o.style.position="absolute",o.style.top="0px",o.style.left="0px",o.className="canvas",t.canvasContainer.appendChild(o),t.canvas=o,t.canvas.style.transform=`translate(${t.cameraWidth/2}px, ${t.cameraHeight/2}px)`,t.canvasContainer.addEventListener("mousedown",function(s){t.isMouseDown=!0,t.mousedown_x=s.clientX,t.mousedown_y=s.clientY,t.camera_pan_start_x=t.camera_x,t.camera_pan_start_y=t.camera_y;for(const r of t.nodeArray)r.offFocus()}),t.canvasContainer.addEventListener("mousemove",function(s){t.hoverDOM=s.target,t.mouse_x=s.clientX-t.canvasContainer.offsetLeft,t.mouse_y=s.clientY-t.canvasContainer.offsetTop,t.isMouseDown&&(t.dx=s.clientX-t.mousedown_x+t.dx_offset,t.dy=s.clientY-t.mousedown_y+t.dy_offset,t.targetNode==null&&(t.camera_x=t.camera_pan_start_x-t.dx/t.zoom,t.camera_y=t.camera_pan_start_y-t.dy/t.zoom,t.canvas.style.transform=`matrix3d(${st(t.camera_x,t.camera_y,t)})`,t.canvas.style.cursor="grabbing"))}),t.canvasContainer.addEventListener("wheel",function(s){const r=1*t.zoom*(-s.deltaY/600);if(s.preventDefault(),t.zoom+r<.2){t.zoom=.2;return}else if(t.zoom+r>3){t.zoom=3;return}const i=(t.mouse_x-t.cameraWidth/2)*r,a=(t.mouse_y-t.cameraHeight/2)*r;t.zoom+=r,t.camera_x+=i/t.zoom/t.zoom,t.camera_y+=a/t.zoom/t.zoom,t.canvas.style.transform=`matrix3d(${st(t.camera_x,t.camera_y,t)})`,s.preventDefault()}),t.canvasContainer.addEventListener("mouseup",function(s){t.isMouseDown=!1,t.canvas.style.cursor="default",t.targetNode==null||t.targetNode.domMouseUp(),t.targetNode=null,t.dx=0,t.dy=0,t.dx_offset=0,t.dy_offset=0}),console.info("Initialized SnapLine..."),window.requestAnimationFrame(this.step.bind(this))}step(){this.g.targetNode&&this.g.targetNode.onDrag(),window.requestAnimationFrame(this.step.bind(this))}addNode(n,t,o){const s=new Ft(n,this.g,t,o);return this.g.globalNodes[s.gid]=s,s}deleteNode(n){console.debug(n)}connectNodes(n,t,o,s){console.debug(n,t,o,s)}}function Wt(e){let n,t,o,s,r,i,a,d,c,p,m,g,b,_,C,q,F,k,G,E,x,O,Q,y,P,z,K,W,L,J,N,H,Z;return{c(){n=f("main"),t=f("link"),s=w(),r=f("navbar"),i=f("div"),a=f("div"),d=f("label"),d.textContent="Add Node",c=w(),p=f("ul"),m=f("li"),g=f("button"),g.textContent="Math",b=w(),_=f("li"),C=f("button"),C.textContent="YouTube",q=w(),F=f("li"),k=f("button"),k.textContent="Print",G=w(),E=f("div"),x=f("div"),O=f("label"),O.textContent="Theme",Q=w(),y=f("ul"),P=f("li"),z=f("button"),z.textContent="Standard",K=w(),W=f("li"),L=f("button"),L.textContent="Retro",J=w(),N=f("div"),h(t,"href",o=e[2]+"theme/"+e[1]),h(t,"rel","stylesheet"),h(t,"type","text/css"),h(d,"tabindex","0"),h(d,"class","btn btn-sm"),h(g,"class","btn-sm"),h(C,"class","btn-sm"),h(k,"class","btn-sm"),h(p,"tabindex","0"),h(p,"class","dropdown-content menu p-2 shadow bg-base-100 rounded-box w-52"),h(a,"class","dropdown"),h(i,"class","flex-1"),h(O,"tabindex","0"),h(O,"class","btn btn-sm btn-outline"),h(z,"class","btn-sm"),h(L,"class","btn-sm"),h(y,"tabindex","0"),h(y,"class","dropdown-content menu p-2 shadow bg-base-100 rounded-box w-52"),h(x,"class","dropdown dropdown-end"),h(E,"class","flex-none"),h(r,"class","navbar px-5 fixed z-20 bg-white shadow-sm"),h(N,"class","w-full h-screen bg-white overflow-hidden relative select-none"),h(N,"id","node-editor")},m(v,V){gt(v,n,V),u(n,t),u(n,s),u(n,r),u(r,i),u(i,a),u(a,d),u(a,c),u(a,p),u(p,m),u(m,g),u(p,b),u(p,_),u(_,C),u(p,q),u(p,F),u(F,k),u(r,G),u(r,E),u(E,x),u(x,O),u(x,Q),u(x,y),u(y,P),u(P,z),u(y,K),u(y,W),u(W,L),u(n,J),u(n,N),H||(Z=[I(g,"click",e[4]),I(C,"click",e[5]),I(k,"click",e[6]),I(z,"click",e[7]),I(L,"click",e[8])],H=!0)},p(v,[V]){V&2&&o!==(o=v[2]+"theme/"+v[1])&&h(t,"href",o)},i:A,o:A,d(v){v&&rt(n),H=!1,M(Z)}}}function Ht(e,n,t){const s="/";let r=null;_t(async()=>{t(0,r=new Pt("node-editor"))});let i="standard.css";function a(b){t(1,i=b)}return[r,i,s,a,()=>r.addNode(Mt,0,0),()=>r.addNode(Dt,0,0),()=>r.addNode(Et,0,0),()=>a("standard.css"),()=>a("retro.css")]}class Vt extends $t{constructor(n){super(),Tt(this,n,Ht,Wt,ft,{})}}new Vt({target:document.getElementById("app")});
