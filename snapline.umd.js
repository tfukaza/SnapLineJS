!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(t="undefined"!=typeof globalThis?globalThis:t||self).SnapLineJs=i()}(this,(function(){"use strict";var t=Object.defineProperty,i=(i,n,e)=>((i,n,e)=>n in i?t(i,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[n]=e)(i,"symbol"!=typeof n?n+"":n,e),n=(t=>(t[t.node=0]="node",t[t.connector=1]="connector",t[t.line=2]="line",t[t.unspecified=3]="unspecified",t[t.inputConnector=4]="inputConnector",t[t.outputConnector=5]="outputConnector",t[t.invalid=6]="invalid",t))(n||{});"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function e(t){return t&&t.t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var r,s={exports:{}};(r=s).exports=function(){function t(t,i){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);i&&(e=e.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),n.push.apply(n,e)}return n}function i(i){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?t(Object(e),!0).forEach((function(t){a(i,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):t(Object(e)).forEach((function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))}))}return i}function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function e(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function s(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,d(e.key),e)}}function o(t,i,n){return i&&s(t.prototype,i),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function a(t,i,n){return(i=d(i))in t?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t}function u(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&c(t,i)}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,i){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,e=h(t);if(i){var r=h(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return function(t,i){if(i&&("object"==typeof i||"function"==typeof i))return i;if(void 0!==i)throw new TypeError("Derived constructors may only return object or undefined");return f(t)}(this,n)}}function v(){return v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,n){var e=function(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=h(t)););return t}(t,i);if(e){var r=Object.getOwnPropertyDescriptor(e,i);return r.get?r.get.call(arguments.length<3?t:n):r.value}},v.apply(this,arguments)}function d(t){var i=function(t,i){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,i||"default");if("object"!=typeof e)return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===i?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}var p=function(t){return!(!t||!t.Window)&&t instanceof t.Window},g=void 0,m=void 0;function y(t){g=t;var i=t.document.createTextNode("");i.ownerDocument!==t.document&&"function"==typeof t.wrap&&t.wrap(i)===i&&(t=t.wrap(t)),m=t}function b(t){return p(t)?t:(t.ownerDocument||t).defaultView||m.window}"undefined"!=typeof window&&window&&y(window);var w=function(t){return!!t&&"object"===n(t)},x=function(t){return"function"==typeof t},k={window:function(t){return t===m||p(t)},docFrag:function(t){return w(t)&&11===t.nodeType},object:w,func:x,number:function(t){return"number"==typeof t},bool:function(t){return"boolean"==typeof t},string:function(t){return"string"==typeof t},element:function(t){if(!t||"object"!==n(t))return!1;var i=b(t)||m;return/object|function/.test("undefined"==typeof Element?"undefined":n(Element))?t instanceof Element||t instanceof i.Element:1===t.nodeType&&"string"==typeof t.nodeName},plainObject:function(t){return w(t)&&!!t.constructor&&/function Object\b/.test(t.constructor.toString())},array:function(t){return w(t)&&void 0!==t.length&&x(t.splice)}};function M(t){var i=t.interaction;if("drag"===i.prepared.name){var n=i.prepared.axis;"x"===n?(i.coords.cur.page.y=i.coords.start.page.y,i.coords.cur.client.y=i.coords.start.client.y,i.coords.velocity.client.y=0,i.coords.velocity.page.y=0):"y"===n&&(i.coords.cur.page.x=i.coords.start.page.x,i.coords.cur.client.x=i.coords.start.client.x,i.coords.velocity.client.x=0,i.coords.velocity.page.x=0)}}function O(t){var i=t.iEvent,n=t.interaction;if("drag"===n.prepared.name){var e=n.prepared.axis;if("x"===e||"y"===e){var r="x"===e?"y":"x";i.page[r]=n.coords.start.page[r],i.client[r]=n.coords.start.client[r],i.delta[r]=0}}}var S={id:"actions/drag",install:function(t){var i=t.actions,n=t.Interactable,e=t.defaults;n.prototype.draggable=S.draggable,i.map.drag=S,i.methodDict.drag="draggable",e.actions.drag=S.defaults},listeners:{"interactions:before-action-move":M,"interactions:action-resume":M,"interactions:action-move":O,"auto-start:check":function(t){var i=t.interaction,n=t.interactable,e=t.buttons,r=n.options.drag;if(r&&r.enabled&&(!i.pointerIsDown||!/mouse|pointer/.test(i.pointerType)||e&n.options.drag.mouseButtons))return t.action={name:"drag",axis:"start"===r.lockAxis?r.startAxis:r.lockAxis},!1}},draggable:function(t){return k.object(t)?(this.options.drag.enabled=!1!==t.enabled,this.setPerAction("drag",t),this.setOnEvents("drag",t),/^(xy|x|y|start)$/.test(t.lockAxis)&&(this.options.drag.lockAxis=t.lockAxis),/^(xy|x|y)$/.test(t.startAxis)&&(this.options.drag.startAxis=t.startAxis),this):k.bool(t)?(this.options.drag.enabled=t,this):this.options.drag},beforeMove:M,move:O,defaults:{startAxis:"xy",lockAxis:"xy"},getCursor:function(){return"move"},filterEventType:function(t){return 0===t.search("drag")}},E=S,T={init:function(t){var i=t;T.document=i.document,T.DocumentFragment=i.DocumentFragment||D,T.SVGElement=i.SVGElement||D,T.SVGSVGElement=i.SVGSVGElement||D,T.SVGElementInstance=i.SVGElementInstance||D,T.Element=i.Element||D,T.HTMLElement=i.HTMLElement||T.Element,T.Event=i.Event,T.Touch=i.Touch||D,T.PointerEvent=i.PointerEvent||i.MSPointerEvent},document:null,DocumentFragment:null,SVGElement:null,SVGSVGElement:null,SVGElementInstance:null,Element:null,HTMLElement:null,Event:null,Touch:null,PointerEvent:null};function D(){}var C=T,_={init:function(t){var i=C.Element,n=t.navigator||{};_.supportsTouch="ontouchstart"in t||k.func(t.DocumentTouch)&&C.document instanceof t.DocumentTouch,_.supportsPointerEvent=!1!==n.pointerEnabled&&!!C.PointerEvent,_.isIOS=/iP(hone|od|ad)/.test(n.platform),_.isIOS7=/iP(hone|od|ad)/.test(n.platform)&&/OS 7[^\d]/.test(n.appVersion),_.isIe9=/MSIE 9/.test(n.userAgent),_.isOperaMobile="Opera"===n.appName&&_.supportsTouch&&/Presto/.test(n.userAgent),_.prefixedMatchesSelector="matches"in i.prototype?"matches":"webkitMatchesSelector"in i.prototype?"webkitMatchesSelector":"mozMatchesSelector"in i.prototype?"mozMatchesSelector":"oMatchesSelector"in i.prototype?"oMatchesSelector":"msMatchesSelector",_.pEventTypes=_.supportsPointerEvent?C.PointerEvent===t.MSPointerEvent?{up:"MSPointerUp",down:"MSPointerDown",over:"mouseover",out:"mouseout",move:"MSPointerMove",cancel:"MSPointerCancel"}:{up:"pointerup",down:"pointerdown",over:"pointerover",out:"pointerout",move:"pointermove",cancel:"pointercancel"}:null,_.wheelEvent=C.document&&"onmousewheel"in C.document?"mousewheel":"wheel"},supportsTouch:null,supportsPointerEvent:null,isIOS7:null,isIOS:null,isIe9:null,isOperaMobile:null,prefixedMatchesSelector:null,pEventTypes:null,wheelEvent:null},P=_;function j(t,i){if(t.contains)return t.contains(i);for(;i;){if(i===t)return!0;i=i.parentNode}return!1}function z(t,i){for(;k.element(t);){if(R(t,i))return t;t=I(t)}return null}function I(t){var i=t.parentNode;if(k.docFrag(i)){for(;(i=i.host)&&k.docFrag(i););return i}return i}function R(t,i){return m!==g&&(i=i.replace(/\/deep\//g," ")),t[P.prefixedMatchesSelector](i)}var F=function(t){return t.parentNode||t.host};function L(t,i){for(var n,e=[],r=t;(n=F(r))&&r!==i&&n!==r.ownerDocument;)e.unshift(r),r=n;return e}function $(t,i,n){for(;k.element(t);){if(R(t,i))return!0;if((t=I(t))===n)return R(t,i)}return!1}function A(t){return t.correspondingUseElement||t}function N(t){var i=t instanceof C.SVGElement?t.getBoundingClientRect():t.getClientRects()[0];return i&&{left:i.left,right:i.right,top:i.top,bottom:i.bottom,width:i.width||i.right-i.left,height:i.height||i.bottom-i.top}}function X(t){var i,n=N(t);if(!P.isIOS7&&n){var e={x:(i=(i=b(t))||m).scrollX||i.document.documentElement.scrollLeft,y:i.scrollY||i.document.documentElement.scrollTop};n.left+=e.x,n.right+=e.x,n.top+=e.y,n.bottom+=e.y}return n}function Y(t){for(var i=[];t;)i.push(t),t=I(t);return i}function U(t){return!!k.string(t)&&(C.document.querySelector(t),!0)}function B(t,i){for(var n in i)t[n]=i[n];return t}function W(t,i,n){return"parent"===t?I(n):"self"===t?i.getRect(n):z(n,t)}function q(t,i,n,e){var r=t;return k.string(r)?r=W(r,i,n):k.func(r)&&(r=r.apply(void 0,e)),k.element(r)&&(r=X(r)),r}function V(t){return t&&{x:"x"in t?t.x:t.left,y:"y"in t?t.y:t.top}}function H(t){return!t||"x"in t&&"y"in t||((t=B({},t)).x=t.left||0,t.y=t.top||0,t.width=t.width||(t.right||0)-t.x,t.height=t.height||(t.bottom||0)-t.y),t}function G(t,i,n){t.left&&(i.left+=n.x),t.right&&(i.right+=n.x),t.top&&(i.top+=n.y),t.bottom&&(i.bottom+=n.y),i.width=i.right-i.left,i.height=i.bottom-i.top}function K(t,i,n){var e=n&&t.options[n];return V(q(e&&e.origin||t.options.origin,t,i,[t&&i]))||{x:0,y:0}}function Z(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){return!0},e=arguments.length>3?arguments[3]:void 0;if(e=e||{},k.string(t)&&-1!==t.search(" ")&&(t=J(t)),k.array(t))return t.forEach((function(t){return Z(t,i,n,e)})),e;if(k.object(t)&&(i=t,t=""),k.func(i)&&n(t))e[t]=e[t]||[],e[t].push(i);else if(k.array(i))for(var r=0,s=i;r<s.length;r++){var o=s[r];Z(t,o,n,e)}else if(k.object(i))for(var a in i)Z(J(a).map((function(i){return"".concat(t).concat(i)})),i[a],n,e);return e}function J(t){return t.trim().split(/ +/)}var Q=function(t,i){return Math.sqrt(t*t+i*i)},tt=["webkit","moz"];function it(t,i){t.o||(t.o={});var n=function(n){if(tt.some((function(t){return 0===n.indexOf(t)})))return 1;"function"!=typeof t[n]&&"__set"!==n&&Object.defineProperty(t,n,{get:function(){return n in t.o?t.o[n]:t.o[n]=i[n]},set:function(i){t.o[n]=i},configurable:!0})};for(var e in i)n(e);return t}function nt(t,i){t.page=t.page||{},t.page.x=i.page.x,t.page.y=i.page.y,t.client=t.client||{},t.client.x=i.client.x,t.client.y=i.client.y,t.timeStamp=i.timeStamp}function et(t){t.page.x=0,t.page.y=0,t.client.x=0,t.client.y=0}function rt(t){return t instanceof C.Event||t instanceof C.Touch}function st(t,i,n){return t=t||"page",(n=n||{}).x=i[t+"X"],n.y=i[t+"Y"],n}function ot(t,i){return i=i||{x:0,y:0},P.isOperaMobile&&rt(t)?(st("screen",t,i),i.x+=window.scrollX,i.y+=window.scrollY):st("page",t,i),i}function at(t){return k.number(t.pointerId)?t.pointerId:t.identifier}function ut(t,i,n){var e,r,s=i.length>1?ct(i):i[0];ot(s,t.page),e=s,r=(r=t.client)||{},P.isOperaMobile&&rt(e)?st("screen",e,r):st("client",e,r),t.timeStamp=n}function ht(t){var i=[];return k.array(t)?(i[0]=t[0],i[1]=t[1]):"touchend"===t.type?1===t.touches.length?(i[0]=t.touches[0],i[1]=t.changedTouches[0]):0===t.touches.length&&(i[0]=t.changedTouches[0],i[1]=t.changedTouches[1]):(i[0]=t.touches[0],i[1]=t.touches[1]),i}function ct(t){for(var i={pageX:0,pageY:0,clientX:0,clientY:0,screenX:0,screenY:0},n=0;n<t.length;n++){var e=t[n];for(var r in i)i[r]+=e[r]}for(var s in i)i[s]/=t.length;return i}function ft(t){if(!t.length)return null;var i=ht(t),n=Math.min(i[0].pageX,i[1].pageX),e=Math.min(i[0].pageY,i[1].pageY),r=Math.max(i[0].pageX,i[1].pageX),s=Math.max(i[0].pageY,i[1].pageY);return{x:n,y:e,left:n,top:e,right:r,bottom:s,width:r-n,height:s-e}}function lt(t,i){var n=i+"X",e=i+"Y",r=ht(t),s=r[0][n]-r[1][n],o=r[0][e]-r[1][e];return Q(s,o)}function vt(t,i){var n=i+"X",e=i+"Y",r=ht(t),s=r[1][n]-r[0][n],o=r[1][e]-r[0][e];return 180*Math.atan2(o,s)/Math.PI}function dt(t){return k.string(t.pointerType)?t.pointerType:k.number(t.pointerType)?[void 0,void 0,"touch","pen","mouse"][t.pointerType]:/touch/.test(t.type||"")||t instanceof C.Touch?"touch":"mouse"}function pt(t){var i=k.func(t.composedPath)?t.composedPath():t.path;return[A(i?i[0]:t.target),A(t.currentTarget)]}var gt=function(){function t(i){e(this,t),this.immediatePropagationStopped=!1,this.propagationStopped=!1,this.u=i}return o(t,[{key:"preventDefault",value:function(){}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}}]),t}();Object.defineProperty(gt.prototype,"interaction",{get:function(){return this.u.h},set:function(){}});var mt=function(t,i){for(var n=0;n<i.length;n++){var e=i[n];t.push(e)}return t},yt=function(t){return mt([],t)},bt=function(t,i){for(var n=0;n<t.length;n++)if(i(t[n],n,t))return n;return-1},wt=function(t,i){return t[bt(t,i)]},xt=function(t){u(n,t);var i=l(n);function n(t,r,s){var o;e(this,n),(o=i.call(this,r.u)).dropzone=void 0,o.dragEvent=void 0,o.relatedTarget=void 0,o.draggable=void 0,o.propagationStopped=!1,o.immediatePropagationStopped=!1;var a="dragleave"===s?t.prev:t.cur,u=a.element,h=a.dropzone;return o.type=s,o.target=u,o.currentTarget=u,o.dropzone=h,o.dragEvent=r,o.relatedTarget=r.target,o.draggable=r.interactable,o.timeStamp=r.timeStamp,o}return o(n,[{key:"reject",value:function(){var t=this,i=this.u.dropState;if("dropactivate"===this.type||this.dropzone&&i.cur.dropzone===this.dropzone&&i.cur.element===this.target)if(i.prev.dropzone=this.dropzone,i.prev.element=this.target,i.rejected=!0,i.events.enter=null,this.stopImmediatePropagation(),"dropactivate"===this.type){var e=i.activeDrops,r=bt(e,(function(i){var n=i.dropzone,e=i.element;return n===t.dropzone&&e===t.target}));i.activeDrops.splice(r,1);var s=new n(i,this.dragEvent,"dropdeactivate");s.dropzone=this.dropzone,s.target=this.target,this.dropzone.fire(s)}else this.dropzone.fire(new n(i,this.dragEvent,"dragleave"))}},{key:"preventDefault",value:function(){}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}}]),n}(gt);function kt(t,i){for(var n=0,e=t.slice();n<e.length;n++){var r=e[n],s=r.dropzone,o=r.element;i.dropzone=s,i.target=o,s.fire(i),i.propagationStopped=i.immediatePropagationStopped=!1}}function Mt(t,i){for(var n=function(t,i){for(var n=[],e=0,r=t.interactables.list;e<r.length;e++){var s=r[e];if(s.options.drop.enabled){var o=s.options.drop.accept;if(!(k.element(o)&&o!==i||k.string(o)&&!R(i,o)||k.func(o)&&!o({dropzone:s,draggableElement:i})))for(var a=0,u=s.getAllElements();a<u.length;a++){var h=u[a];h!==i&&n.push({dropzone:s,element:h,rect:s.getRect(h)})}}}return n}(t,i),e=0;e<n.length;e++){var r=n[e];r.rect=r.dropzone.getRect(r.element)}return n}function Ot(t,i,n){for(var e=t.dropState,r=t.interactable,s=t.element,o=[],a=0,u=e.activeDrops;a<u.length;a++){var h=u[a],c=h.dropzone,f=h.element,l=h.rect,v=c.dropCheck(i,n,r,s,f,l);o.push(v?f:null)}var d=function(t){for(var i,n,e,r=[],s=0;s<t.length;s++){var o=t[s],a=t[i];if(o&&s!==i)if(a){var u=F(o),h=F(a);if(u!==o.ownerDocument)if(h!==o.ownerDocument)if(u!==h){r=r.length?r:L(a);var c=void 0;if(a instanceof C.HTMLElement&&o instanceof C.SVGElement&&!(o instanceof C.SVGSVGElement)){if(o===h)continue;c=o.ownerSVGElement}else c=o;for(var f=L(c,a.ownerDocument),l=0;f[l]&&f[l]===r[l];)l++;var v=[f[l-1],f[l],r[l]];if(v[0])for(var d=v[0].lastChild;d;){if(d===v[1]){i=s,r=f;break}if(d===v[2])break;d=d.previousSibling}}else e=a,(parseInt(b(n=o).getComputedStyle(n).zIndex,10)||0)>=(parseInt(b(e).getComputedStyle(e).zIndex,10)||0)&&(i=s);else i=s}else i=s}return i}(o);return e.activeDrops[d]||null}function St(t,i,n){var e=t.dropState,r={enter:null,leave:null,activate:null,deactivate:null,move:null,drop:null};return"dragstart"===n.type&&(r.activate=new xt(e,n,"dropactivate"),r.activate.target=null,r.activate.dropzone=null),"dragend"===n.type&&(r.deactivate=new xt(e,n,"dropdeactivate"),r.deactivate.target=null,r.deactivate.dropzone=null),e.rejected||(e.cur.element!==e.prev.element&&(e.prev.dropzone&&(r.leave=new xt(e,n,"dragleave"),n.dragLeave=r.leave.target=e.prev.element,n.prevDropzone=r.leave.dropzone=e.prev.dropzone),e.cur.dropzone&&(r.enter=new xt(e,n,"dragenter"),n.dragEnter=e.cur.element,n.dropzone=e.cur.dropzone)),"dragend"===n.type&&e.cur.dropzone&&(r.drop=new xt(e,n,"drop"),n.dropzone=e.cur.dropzone,n.relatedTarget=e.cur.element),"dragmove"===n.type&&e.cur.dropzone&&(r.move=new xt(e,n,"dropmove"),n.dropzone=e.cur.dropzone)),r}function Et(t,i){var n=t.dropState,e=n.activeDrops,r=n.cur,s=n.prev;i.leave&&s.dropzone.fire(i.leave),i.enter&&r.dropzone.fire(i.enter),i.move&&r.dropzone.fire(i.move),i.drop&&r.dropzone.fire(i.drop),i.deactivate&&kt(e,i.deactivate),n.prev.dropzone=r.dropzone,n.prev.element=r.element}function Tt(t,i){var n=t.interaction,e=t.iEvent,r=t.event;if("dragmove"===e.type||"dragend"===e.type){var s=n.dropState;i.dynamicDrop&&(s.activeDrops=Mt(i,n.element));var o=e,a=Ot(n,o,r);s.rejected=s.rejected&&!!a&&a.dropzone===s.cur.dropzone&&a.element===s.cur.element,s.cur.dropzone=a&&a.dropzone,s.cur.element=a&&a.element,s.events=St(n,0,o)}}var Dt={id:"actions/drop",install:function(t){var i=t.actions,n=t.interactStatic,e=t.Interactable,r=t.defaults;t.usePlugin(E),e.prototype.dropzone=function(t){return function(t,i){if(k.object(i)){if(t.options.drop.enabled=!1!==i.enabled,i.listeners){var n=Z(i.listeners),e=Object.keys(n).reduce((function(t,i){return t[/^(enter|leave)/.test(i)?"drag".concat(i):/^(activate|deactivate|move)/.test(i)?"drop".concat(i):i]=n[i],t}),{}),r=t.options.drop.listeners;r&&t.off(r),t.on(e),t.options.drop.listeners=e}return k.func(i.ondrop)&&t.on("drop",i.ondrop),k.func(i.ondropactivate)&&t.on("dropactivate",i.ondropactivate),k.func(i.ondropdeactivate)&&t.on("dropdeactivate",i.ondropdeactivate),k.func(i.ondragenter)&&t.on("dragenter",i.ondragenter),k.func(i.ondragleave)&&t.on("dragleave",i.ondragleave),k.func(i.ondropmove)&&t.on("dropmove",i.ondropmove),/^(pointer|center)$/.test(i.overlap)?t.options.drop.overlap=i.overlap:k.number(i.overlap)&&(t.options.drop.overlap=Math.max(Math.min(1,i.overlap),0)),"accept"in i&&(t.options.drop.accept=i.accept),"checker"in i&&(t.options.drop.checker=i.checker),t}return k.bool(i)?(t.options.drop.enabled=i,t):t.options.drop}(this,t)},e.prototype.dropCheck=function(t,i,n,e,r,s){return function(t,i,n,e,r,s,o){var a=!1;if(!(o=o||t.getRect(s)))return!!t.options.drop.checker&&t.options.drop.checker(i,n,a,t,s,e,r);var u=t.options.drop.overlap;if("pointer"===u){var h=K(e,r,"drag"),c=ot(i);c.x+=h.x,c.y+=h.y;var f=c.x>o.left&&c.x<o.right,l=c.y>o.top&&c.y<o.bottom;a=f&&l}var v=e.getRect(r);if(v&&"center"===u){var d=v.left+v.width/2,p=v.top+v.height/2;a=d>=o.left&&d<=o.right&&p>=o.top&&p<=o.bottom}return v&&k.number(u)&&(a=Math.max(0,Math.min(o.right,v.right)-Math.max(o.left,v.left))*Math.max(0,Math.min(o.bottom,v.bottom)-Math.max(o.top,v.top))/(v.width*v.height)>=u),t.options.drop.checker&&(a=t.options.drop.checker(i,n,a,t,s,e,r)),a}(this,t,i,n,e,r,s)},n.dynamicDrop=function(i){return k.bool(i)?(t.dynamicDrop=i,n):t.dynamicDrop},B(i.phaselessTypes,{dragenter:!0,dragleave:!0,dropactivate:!0,dropdeactivate:!0,dropmove:!0,drop:!0}),i.methodDict.drop="dropzone",t.dynamicDrop=!1,r.actions.drop=Dt.defaults},listeners:{"interactions:before-action-start":function(t){var i=t.interaction;"drag"===i.prepared.name&&(i.dropState={cur:{dropzone:null,element:null},prev:{dropzone:null,element:null},rejected:null,events:null,activeDrops:[]})},"interactions:after-action-start":function(t,i){var n=t.interaction,e=(t.event,t.iEvent);if("drag"===n.prepared.name){var r=n.dropState;r.activeDrops=[],r.events={},r.activeDrops=Mt(i,n.element),r.events=St(n,0,e),r.events.activate&&(kt(r.activeDrops,r.events.activate),i.fire("actions/drop:start",{interaction:n,dragEvent:e}))}},"interactions:action-move":Tt,"interactions:after-action-move":function(t,i){var n=t.interaction,e=t.iEvent;if("drag"===n.prepared.name){var r=n.dropState;Et(n,r.events),i.fire("actions/drop:move",{interaction:n,dragEvent:e}),r.events={}}},"interactions:action-end":function(t,i){if("drag"===t.interaction.prepared.name){var n=t.interaction,e=t.iEvent;Tt(t,i),Et(n,n.dropState.events),i.fire("actions/drop:end",{interaction:n,dragEvent:e})}},"interactions:stop":function(t){var i=t.interaction;if("drag"===i.prepared.name){var n=i.dropState;n&&(n.activeDrops=null,n.events=null,n.cur.dropzone=null,n.cur.element=null,n.prev.dropzone=null,n.prev.element=null,n.rejected=!1)}}},getActiveDrops:Mt,getDrop:Ot,getDropEvents:St,fireDropEvents:Et,filterEventType:function(t){return 0===t.search("drag")||0===t.search("drop")},defaults:{enabled:!1,accept:null,overlap:"pointer"}},Ct=Dt;function _t(t){var i=t.interaction,n=t.iEvent,e=t.phase;if("gesture"===i.prepared.name){var r=i.pointers.map((function(t){return t.pointer})),s="start"===e,o="end"===e,a=i.interactable.options.deltaSource;if(n.touches=[r[0],r[1]],s)n.distance=lt(r,a),n.box=ft(r),n.scale=1,n.ds=0,n.angle=vt(r,a),n.da=0,i.gesture.startDistance=n.distance,i.gesture.startAngle=n.angle;else if(o||i.pointers.length<2){var u=i.prevEvent;n.distance=u.distance,n.box=u.box,n.scale=u.scale,n.ds=0,n.angle=u.angle,n.da=0}else n.distance=lt(r,a),n.box=ft(r),n.scale=n.distance/i.gesture.startDistance,n.angle=vt(r,a),n.ds=n.scale-i.gesture.scale,n.da=n.angle-i.gesture.angle;i.gesture.distance=n.distance,i.gesture.angle=n.angle,k.number(n.scale)&&n.scale!==1/0&&!isNaN(n.scale)&&(i.gesture.scale=n.scale)}}var Pt={id:"actions/gesture",before:["actions/drag","actions/resize"],install:function(t){var i=t.actions,n=t.Interactable,e=t.defaults;n.prototype.gesturable=function(t){return k.object(t)?(this.options.gesture.enabled=!1!==t.enabled,this.setPerAction("gesture",t),this.setOnEvents("gesture",t),this):k.bool(t)?(this.options.gesture.enabled=t,this):this.options.gesture},i.map.gesture=Pt,i.methodDict.gesture="gesturable",e.actions.gesture=Pt.defaults},listeners:{"interactions:action-start":_t,"interactions:action-move":_t,"interactions:action-end":_t,"interactions:new":function(t){t.interaction.gesture={angle:0,distance:0,scale:1,startAngle:0,startDistance:0}},"auto-start:check":function(t){if(!(t.interaction.pointers.length<2)){var i=t.interactable.options.gesture;if(i&&i.enabled)return t.action={name:"gesture"},!1}}},defaults:{},getCursor:function(){return""},filterEventType:function(t){return 0===t.search("gesture")}},jt=Pt;function zt(t,i,n,e,r,s,o){if(!i)return!1;if(!0===i){var a=k.number(s.width)?s.width:s.right-s.left,u=k.number(s.height)?s.height:s.bottom-s.top;if(o=Math.min(o,Math.abs(("left"===t||"right"===t?a:u)/2)),a<0&&("left"===t?t="right":"right"===t&&(t="left")),u<0&&("top"===t?t="bottom":"bottom"===t&&(t="top")),"left"===t){var h=a>=0?s.left:s.right;return n.x<h+o}if("top"===t){var c=u>=0?s.top:s.bottom;return n.y<c+o}if("right"===t)return n.x>(a>=0?s.right:s.left)-o;if("bottom"===t)return n.y>(u>=0?s.bottom:s.top)-o}return!!k.element(e)&&(k.element(i)?i===e:$(e,i,r))}function It(t){var i=t.iEvent,n=t.interaction;if("resize"===n.prepared.name&&n.resizeAxes){var e=i;n.interactable.options.resize.square?("y"===n.resizeAxes?e.delta.x=e.delta.y:e.delta.y=e.delta.x,e.axes="xy"):(e.axes=n.resizeAxes,"x"===n.resizeAxes?e.delta.y=0:"y"===n.resizeAxes&&(e.delta.x=0))}}var Rt,Ft,Lt={id:"actions/resize",before:["actions/drag"],install:function(t){var i=t.actions,n=t.browser,e=t.Interactable,r=t.defaults;Lt.cursors=n.isIe9?{x:"e-resize",y:"s-resize",xy:"se-resize",top:"n-resize",left:"w-resize",bottom:"s-resize",right:"e-resize",topleft:"se-resize",bottomright:"se-resize",topright:"ne-resize",bottomleft:"ne-resize"}:{x:"ew-resize",y:"ns-resize",xy:"nwse-resize",top:"ns-resize",left:"ew-resize",bottom:"ns-resize",right:"ew-resize",topleft:"nwse-resize",bottomright:"nwse-resize",topright:"nesw-resize",bottomleft:"nesw-resize"},Lt.defaultMargin=n.supportsTouch||n.supportsPointerEvent?20:10,e.prototype.resizable=function(i){return function(t,i,n){return k.object(i)?(t.options.resize.enabled=!1!==i.enabled,t.setPerAction("resize",i),t.setOnEvents("resize",i),k.string(i.axis)&&/^x$|^y$|^xy$/.test(i.axis)?t.options.resize.axis=i.axis:null===i.axis&&(t.options.resize.axis=n.defaults.actions.resize.axis),k.bool(i.preserveAspectRatio)?t.options.resize.preserveAspectRatio=i.preserveAspectRatio:k.bool(i.square)&&(t.options.resize.square=i.square),t):k.bool(i)?(t.options.resize.enabled=i,t):t.options.resize}(this,i,t)},i.map.resize=Lt,i.methodDict.resize="resizable",r.actions.resize=Lt.defaults},listeners:{"interactions:new":function(t){t.interaction.resizeAxes="xy"},"interactions:action-start":function(t){!function(t){var i=t.iEvent,n=t.interaction;if("resize"===n.prepared.name&&n.prepared.edges){var e=i,r=n.rect;n.l={start:B({},r),corrected:B({},r),previous:B({},r),delta:{left:0,right:0,width:0,top:0,bottom:0,height:0}},e.edges=n.prepared.edges,e.rect=n.l.corrected,e.deltaRect=n.l.delta}}(t),It(t)},"interactions:action-move":function(t){!function(t){var i=t.iEvent,n=t.interaction;if("resize"===n.prepared.name&&n.prepared.edges){var e=i,r=n.interactable.options.resize.invert,s="reposition"===r||"negate"===r,o=n.rect,a=n.l,u=a.start,h=a.corrected,c=a.delta,f=a.previous;if(B(f,h),s){if(B(h,o),"reposition"===r){if(h.top>h.bottom){var l=h.top;h.top=h.bottom,h.bottom=l}if(h.left>h.right){var v=h.left;h.left=h.right,h.right=v}}}else h.top=Math.min(o.top,u.bottom),h.bottom=Math.max(o.bottom,u.top),h.left=Math.min(o.left,u.right),h.right=Math.max(o.right,u.left);for(var d in h.width=h.right-h.left,h.height=h.bottom-h.top,h)c[d]=h[d]-f[d];e.edges=n.prepared.edges,e.rect=h,e.deltaRect=c}}(t),It(t)},"interactions:action-end":function(t){var i=t.iEvent,n=t.interaction;if("resize"===n.prepared.name&&n.prepared.edges){var e=i;e.edges=n.prepared.edges,e.rect=n.l.corrected,e.deltaRect=n.l.delta}},"auto-start:check":function(t){var i=t.interaction,n=t.interactable,e=t.element,r=t.rect,s=t.buttons;if(r){var o=B({},i.coords.cur.page),a=n.options.resize;if(a&&a.enabled&&(!i.pointerIsDown||!/mouse|pointer/.test(i.pointerType)||s&a.mouseButtons)){if(k.object(a.edges)){var u={left:!1,right:!1,top:!1,bottom:!1};for(var h in u)u[h]=zt(h,a.edges[h],o,i.v.eventTarget,e,r,a.margin||Lt.defaultMargin);u.left=u.left&&!u.right,u.top=u.top&&!u.bottom,(u.left||u.right||u.top||u.bottom)&&(t.action={name:"resize",edges:u})}else{var c="y"!==a.axis&&o.x>r.right-Lt.defaultMargin,f="x"!==a.axis&&o.y>r.bottom-Lt.defaultMargin;(c||f)&&(t.action={name:"resize",axes:(c?"x":"")+(f?"y":"")})}return!t.action&&void 0}}}},defaults:{square:!1,preserveAspectRatio:!1,axis:"xy",margin:NaN,edges:null,invert:"none"},cursors:null,getCursor:function(t){var i=t.edges,n=t.axis,e=t.name,r=Lt.cursors,s=null;if(n)s=r[e+n];else if(i){for(var o="",a=0,u=["top","bottom","left","right"];a<u.length;a++){var h=u[a];i[h]&&(o+=h)}s=r[o]}return s},filterEventType:function(t){return 0===t.search("resize")},defaultMargin:null},$t=Lt,At={id:"actions",install:function(t){t.usePlugin(jt),t.usePlugin($t),t.usePlugin(E),t.usePlugin(Ct)}},Nt=0,Xt={request:function(t){return Rt(t)},cancel:function(t){return Ft(t)},init:function(t){if(Rt=t.requestAnimationFrame,Ft=t.cancelAnimationFrame,!Rt)for(var i=["ms","moz","webkit","o"],n=0;n<i.length;n++){var e=i[n];Rt=t["".concat(e,"RequestAnimationFrame")],Ft=t["".concat(e,"CancelAnimationFrame")]||t["".concat(e,"CancelRequestAnimationFrame")]}Rt=Rt&&Rt.bind(t),Ft=Ft&&Ft.bind(t),Rt||(Rt=function(i){var n=Date.now(),e=Math.max(0,16-(n-Nt)),r=t.setTimeout((function(){i(n+e)}),e);return Nt=n+e,r},Ft=function(t){return clearTimeout(t)})}},Yt={defaults:{enabled:!1,margin:60,container:null,speed:300},now:Date.now,interaction:null,i:0,x:0,y:0,isScrolling:!1,prevTime:0,margin:0,speed:0,start:function(t){Yt.isScrolling=!0,Xt.cancel(Yt.i),t.autoScroll=Yt,Yt.interaction=t,Yt.prevTime=Yt.now(),Yt.i=Xt.request(Yt.scroll)},stop:function(){Yt.isScrolling=!1,Yt.interaction&&(Yt.interaction.autoScroll=null),Xt.cancel(Yt.i)},scroll:function(){var t=Yt.interaction,i=t.interactable,n=t.element,e=t.prepared.name,r=i.options[e].autoScroll,s=Ut(r.container,i,n),o=Yt.now(),a=(o-Yt.prevTime)/1e3,u=r.speed*a;if(u>=1){var h={x:Yt.x*u,y:Yt.y*u};if(h.x||h.y){var c=Bt(s);k.window(s)?s.scrollBy(h.x,h.y):s&&(s.scrollLeft+=h.x,s.scrollTop+=h.y);var f=Bt(s),l={x:f.x-c.x,y:f.y-c.y};(l.x||l.y)&&i.fire({type:"autoscroll",target:n,interactable:i,delta:l,interaction:t,container:s})}Yt.prevTime=o}Yt.isScrolling&&(Xt.cancel(Yt.i),Yt.i=Xt.request(Yt.scroll))},check:function(t,i){var n;return null==(n=t.options[i].autoScroll)?void 0:n.enabled},onInteractionMove:function(t){var i=t.interaction,n=t.pointer;if(i.interacting()&&Yt.check(i.interactable,i.prepared.name))if(i.simulation)Yt.x=Yt.y=0;else{var e,r,s,o,a=i.interactable,u=i.element,h=i.prepared.name,c=a.options[h].autoScroll,f=Ut(c.container,a,u);if(k.window(f))o=n.clientX<Yt.margin,e=n.clientY<Yt.margin,r=n.clientX>f.innerWidth-Yt.margin,s=n.clientY>f.innerHeight-Yt.margin;else{var l=N(f);o=n.clientX<l.left+Yt.margin,e=n.clientY<l.top+Yt.margin,r=n.clientX>l.right-Yt.margin,s=n.clientY>l.bottom-Yt.margin}Yt.x=r?1:o?-1:0,Yt.y=s?1:e?-1:0,Yt.isScrolling||(Yt.margin=c.margin,Yt.speed=c.speed,Yt.start(i))}}};function Ut(t,i,n){return(k.string(t)?W(t,i,n):t)||b(n)}function Bt(t){return k.window(t)&&(t=window.document.body),{x:t.scrollLeft,y:t.scrollTop}}var Wt={id:"auto-scroll",install:function(t){var i=t.defaults,n=t.actions;t.autoScroll=Yt,Yt.now=function(){return t.now()},n.phaselessTypes.autoscroll=!0,i.perAction.autoScroll=Yt.defaults},listeners:{"interactions:new":function(t){t.interaction.autoScroll=null},"interactions:destroy":function(t){t.interaction.autoScroll=null,Yt.stop(),Yt.interaction&&(Yt.interaction=null)},"interactions:stop":Yt.stop,"interactions:action-move":function(t){return Yt.onInteractionMove(t)}}};function qt(t,i){var n=!1;return function(){return n||(m.console.warn(i),n=!0),t.apply(this,arguments)}}function Vt(t,i){return t.name=i.name,t.axis=i.axis,t.edges=i.edges,t}function Ht(t){return k.bool(t)?(this.options.styleCursor=t,this):null===t?(delete this.options.styleCursor,this):this.options.styleCursor}function Gt(t){return k.func(t)?(this.options.actionChecker=t,this):null===t?(delete this.options.actionChecker,this):this.options.actionChecker}var Kt={id:"auto-start/interactableMethods",install:function(t){var i=t.Interactable;i.prototype.getAction=function(i,n,e,r){var s,o,a,u,h,c,f,l=(o=n,a=e,u=r,h=t,c=(s=this).getRect(u),f={action:null,interactable:s,interaction:a,element:u,rect:c,buttons:o.buttons||{0:1,1:4,3:8,4:16}[o.button]},h.fire("auto-start:check",f),f.action);return this.options.actionChecker?this.options.actionChecker(i,n,l,this,r,e):l},i.prototype.ignoreFrom=qt((function(t){return this.p("ignoreFrom",t)}),"Interactable.ignoreFrom() has been deprecated. Use Interactble.draggable({ignoreFrom: newValue})."),i.prototype.allowFrom=qt((function(t){return this.p("allowFrom",t)}),"Interactable.allowFrom() has been deprecated. Use Interactble.draggable({allowFrom: newValue})."),i.prototype.actionChecker=Gt,i.prototype.styleCursor=Ht}};function Zt(t,i,n,e,r){return i.testIgnoreAllow(i.options[t.name],n,e)&&i.options[t.name].enabled&&ii(i,n,t,r)?t:null}function Jt(t,i,n,e,r,s,o){for(var a=0,u=e.length;a<u;a++){var h=e[a],c=r[a],f=h.getAction(i,n,t,c);if(f){var l=Zt(f,h,c,s,o);if(l)return{action:l,interactable:h,element:c}}}return{action:null,interactable:null,element:null}}function Qt(t,i,n,e,r){var s=[],o=[],a=e;function u(t){s.push(t),o.push(a)}for(;k.element(a);){s=[],o=[],r.interactables.forEachMatch(a,u);var h=Jt(t,i,n,s,o,e,r);if(h.action&&!h.interactable.options[h.action.name].manualStart)return h;a=I(a)}return{action:null,interactable:null,element:null}}function ti(t,i,n){var e=i.action,r=i.interactable,s=i.element;e=e||{name:null},t.interactable=r,t.element=s,Vt(t.prepared,e),t.rect=r&&e.name?r.getRect(s):null,ri(t,n),n.fire("autoStart:prepared",{interaction:t})}function ii(t,i,n,e){var r=t.options,s=r[n.name].max,o=r[n.name].maxPerElement,a=e.autoStart.maxInteractions,u=0,h=0,c=0;if(!(s&&o&&a))return!1;for(var f=0,l=e.interactions.list;f<l.length;f++){var v=l[f],d=v.prepared.name;if(v.interacting()){if(++u>=a)return!1;if(v.interactable===t){if((h+=d===n.name?1:0)>=s)return!1;if(v.element===i&&(c++,d===n.name&&c>=o))return!1}}}return a>0}function ni(t,i){return k.number(t)?(i.autoStart.maxInteractions=t,this):i.autoStart.maxInteractions}function ei(t,i,n){var e=n.autoStart.cursorElement;e&&e!==t&&(e.style.cursor=""),t.ownerDocument.documentElement.style.cursor=i,t.style.cursor=i,n.autoStart.cursorElement=i?t:null}function ri(t,i){var n=t.interactable,e=t.element,r=t.prepared;if("mouse"===t.pointerType&&n&&n.options.styleCursor){var s="";if(r.name){var o=n.options[r.name].cursorChecker;s=k.func(o)?o(r,n,e,t.m):i.actions.map[r.name].getCursor(r)}ei(t.element,s||"",i)}else i.autoStart.cursorElement&&ei(i.autoStart.cursorElement,"",i)}var si={id:"auto-start/base",before:["actions"],install:function(t){var i=t.interactStatic,n=t.defaults;t.usePlugin(Kt),n.base.actionChecker=null,n.base.styleCursor=!0,B(n.perAction,{manualStart:!1,max:1/0,maxPerElement:1,allowFrom:null,ignoreFrom:null,mouseButtons:1}),i.maxInteractions=function(i){return ni(i,t)},t.autoStart={maxInteractions:1/0,withinInteractionLimit:ii,cursorElement:null}},listeners:{"interactions:down":function(t,i){var n=t.interaction,e=t.pointer,r=t.event,s=t.eventTarget;n.interacting()||ti(n,Qt(n,e,r,s,i),i)},"interactions:move":function(t,i){var n,e,r,s,o,a;e=i,r=(n=t).interaction,s=n.pointer,o=n.event,a=n.eventTarget,"mouse"!==r.pointerType||r.pointerIsDown||r.interacting()||ti(r,Qt(r,s,o,a,e),e),function(t,i){var n=t.interaction;if(n.pointerIsDown&&!n.interacting()&&n.pointerWasMoved&&n.prepared.name){i.fire("autoStart:before-start",t);var e=n.interactable,r=n.prepared.name;r&&e&&(e.options[r].manualStart||!ii(e,n.element,n.prepared,i)?n.stop():(n.start(n.prepared,e,n.element),ri(n,i)))}}(t,i)},"interactions:stop":function(t,i){var n=t.interaction,e=n.interactable;e&&e.options.styleCursor&&ei(n.element,"",i)}},maxInteractions:ni,withinInteractionLimit:ii,validateAction:Zt},oi={id:"auto-start/dragAxis",listeners:{"autoStart:before-start":function(t,i){var n=t.interaction,e=t.eventTarget,r=t.dx,s=t.dy;if("drag"===n.prepared.name){var o=Math.abs(r),a=Math.abs(s),u=n.interactable.options.drag,h=u.startAxis,c=o>a?"x":o<a?"y":"xy";if(n.prepared.axis="start"===u.lockAxis?c[0]:u.lockAxis,"xy"!==c&&"xy"!==h&&h!==c){n.prepared.name=null;for(var f=e,l=function(t){if(t!==n.interactable){var r=n.interactable.options.drag;if(!r.manualStart&&t.testIgnoreAllow(r,f,e)){var s=t.getAction(n.downPointer,n.downEvent,n,f);if(s&&"drag"===s.name&&function(t,i){if(!i)return!1;var n=i.options.drag.startAxis;return"xy"===t||"xy"===n||n===t}(c,t)&&si.validateAction(s,t,f,e,i))return t}}};k.element(f);){var v=i.interactables.forEachMatch(f,l);if(v){n.prepared.name="drag",n.interactable=v,n.element=f;break}f=I(f)}}}}}};function ai(t){var i=t.prepared&&t.prepared.name;if(!i)return null;var n=t.interactable.options;return n[i].hold||n[i].delay}var ui={id:"auto-start/hold",install:function(t){var i=t.defaults;t.usePlugin(si),i.perAction.hold=0,i.perAction.delay=0},listeners:{"interactions:new":function(t){t.interaction.autoStartHoldTimer=null},"autoStart:prepared":function(t){var i=t.interaction,n=ai(i);n>0&&(i.autoStartHoldTimer=setTimeout((function(){i.start(i.prepared,i.interactable,i.element)}),n))},"interactions:move":function(t){var i=t.interaction,n=t.duplicate;i.autoStartHoldTimer&&i.pointerWasMoved&&!n&&(clearTimeout(i.autoStartHoldTimer),i.autoStartHoldTimer=null)},"autoStart:before-start":function(t){var i=t.interaction;ai(i)>0&&(i.prepared.name=null)}},getHoldDuration:ai},hi={id:"auto-start",install:function(t){t.usePlugin(si),t.usePlugin(ui),t.usePlugin(oi)}},ci=function(t){return/^(always|never|auto)$/.test(t)?(this.options.preventDefault=t,this):k.bool(t)?(this.options.preventDefault=t?"always":"never",this):this.options.preventDefault};function fi(t){var i=t.interaction,n=t.event;i.interactable&&i.interactable.checkAndPreventDefault(n)}var li={id:"core/interactablePreventDefault",install:function(t){var i=t.Interactable;i.prototype.preventDefault=ci,i.prototype.checkAndPreventDefault=function(i){return function(t,i,n){var e=t.options.preventDefault;if("never"!==e)if("always"!==e){if(i.events.supportsPassive&&/^touch(start|move)$/.test(n.type)){var r=b(n.target).document,s=i.getDocOptions(r);if(!s||!s.events||!1!==s.events.passive)return}/^(mouse|pointer|touch)*(down|start)/i.test(n.type)||k.element(n.target)&&R(n.target,"input,select,textarea,[contenteditable=true],[contenteditable=true] *")||n.preventDefault()}else n.preventDefault()}(this,t,i)},t.interactions.docEvents.push({type:"dragstart",listener:function(i){for(var n=0,e=t.interactions.list;n<e.length;n++){var r=e[n];if(r.element&&(r.element===i.target||j(r.element,i.target)))return void r.interactable.checkAndPreventDefault(i)}}})},listeners:["down","move","up","cancel"].reduce((function(t,i){return t["interactions:".concat(i)]=fi,t}),{})};function vi(t,i){if(i.phaselessTypes[t])return!0;for(var n in i.map)if(0===t.indexOf(n)&&t.substr(n.length)in i.phases)return!0;return!1}function di(t){var i={};for(var n in t){var e=t[n];k.plainObject(e)?i[n]=di(e):k.array(e)?i[n]=yt(e):i[n]=e}return i}var pi=function(){function t(i){e(this,t),this.states=[],this.startOffset={left:0,right:0,top:0,bottom:0},this.startDelta=void 0,this.result=void 0,this.endResult=void 0,this.startEdges=void 0,this.edges=void 0,this.interaction=void 0,this.interaction=i,this.result=gi(),this.edges={left:!1,right:!1,top:!1,bottom:!1}}return o(t,[{key:"start",value:function(t,i){var n,e,r,s,o,a=t.phase,u=this.interaction,h=(s=(r=u).interactable.options[r.prepared.name],(o=s.modifiers)&&o.length?o:["snap","snapSize","snapEdges","restrict","restrictEdges","restrictSize"].map((function(t){var i=s[t];return i&&i.enabled&&{options:i,methods:i.k}})).filter((function(t){return!!t})));this.prepareStates(h),this.startEdges=B({},u.edges),this.edges=B({},this.startEdges),this.startOffset=(e=i,(n=u.rect)?{left:e.x-n.left,top:e.y-n.top,right:n.right-e.x,bottom:n.bottom-e.y}:{left:0,top:0,right:0,bottom:0}),this.startDelta={x:0,y:0};var c=this.fillArg({phase:a,pageCoords:i,preEnd:!1});return this.result=gi(),this.startAll(c),this.result=this.setAll(c)}},{key:"fillArg",value:function(t){var i=this.interaction;return t.interaction=i,t.interactable=i.interactable,t.element=i.element,t.rect||(t.rect=i.rect),t.edges||(t.edges=this.startEdges),t.startOffset=this.startOffset,t}},{key:"startAll",value:function(t){for(var i=0,n=this.states;i<n.length;i++){var e=n[i];e.methods.start&&(t.state=e,e.methods.start(t))}}},{key:"setAll",value:function(t){var i=t.phase,n=t.preEnd,e=t.skipModifiers,r=t.rect,s=t.edges;t.coords=B({},t.pageCoords),t.rect=B({},r),t.edges=B({},s);for(var o=e?this.states.slice(e):this.states,a=gi(t.coords,t.rect),u=0;u<o.length;u++){var h,c=o[u],f=c.options,l=B({},t.coords),v=null;null!=(h=c.methods)&&h.set&&this.shouldDo(f,n,i)&&(t.state=c,v=c.methods.set(t),G(t.edges,t.rect,{x:t.coords.x-l.x,y:t.coords.y-l.y})),a.eventProps.push(v)}B(this.edges,t.edges),a.delta.x=t.coords.x-t.pageCoords.x,a.delta.y=t.coords.y-t.pageCoords.y,a.rectDelta.left=t.rect.left-r.left,a.rectDelta.right=t.rect.right-r.right,a.rectDelta.top=t.rect.top-r.top,a.rectDelta.bottom=t.rect.bottom-r.bottom;var d=this.result.coords,p=this.result.rect;if(d&&p){var g=a.rect.left!==p.left||a.rect.right!==p.right||a.rect.top!==p.top||a.rect.bottom!==p.bottom;a.changed=g||d.x!==a.coords.x||d.y!==a.coords.y}return a}},{key:"applyToInteraction",value:function(t){var i=this.interaction,n=t.phase,e=i.coords.cur,r=i.coords.start,s=this.result,o=this.startDelta,a=s.delta;"start"===n&&B(this.startDelta,s.delta);for(var u=0,h=[[r,o],[e,a]];u<h.length;u++){var c=h[u],f=c[0],l=c[1];f.page.x+=l.x,f.page.y+=l.y,f.client.x+=l.x,f.client.y+=l.y}var v=this.result.rectDelta,d=t.rect||i.rect;d.left+=v.left,d.right+=v.right,d.top+=v.top,d.bottom+=v.bottom,d.width=d.right-d.left,d.height=d.bottom-d.top}},{key:"setAndApply",value:function(t){var i=this.interaction,n=t.phase,e=t.preEnd,r=t.skipModifiers,s=this.setAll(this.fillArg({preEnd:e,phase:n,pageCoords:t.modifiedCoords||i.coords.cur.page}));if(this.result=s,!s.changed&&(!r||r<this.states.length)&&i.interacting())return!1;if(t.modifiedCoords){var o=i.coords.cur.page,a={x:t.modifiedCoords.x-o.x,y:t.modifiedCoords.y-o.y};s.coords.x+=a.x,s.coords.y+=a.y,s.delta.x+=a.x,s.delta.y+=a.y}this.applyToInteraction(t)}},{key:"beforeEnd",value:function(t){var i=t.interaction,n=t.event,e=this.states;if(e&&e.length){for(var r=!1,s=0;s<e.length;s++){var o=e[s];t.state=o;var a=o.options,u=o.methods,h=u.beforeEnd&&u.beforeEnd(t);if(h)return this.endResult=h,!1;r=r||!r&&this.shouldDo(a,!0,t.phase,!0)}r&&i.move({event:n,preEnd:!0})}}},{key:"stop",value:function(t){var i=t.interaction;if(this.states&&this.states.length){var n=B({states:this.states,interactable:i.interactable,element:i.element,rect:null},t);this.fillArg(n);for(var e=0,r=this.states;e<r.length;e++){var s=r[e];n.state=s,s.methods.stop&&s.methods.stop(n)}this.states=null,this.endResult=null}}},{key:"prepareStates",value:function(t){this.states=[];for(var i=0;i<t.length;i++){var n=t[i],e=n.options,r=n.methods,s=n.name;this.states.push({options:e,methods:r,index:i,name:s})}return this.states}},{key:"restoreInteractionCoords",value:function(t){var i=t.interaction,n=i.coords,e=i.rect,r=i.modification;if(r.result){for(var s=r.startDelta,o=r.result,a=o.delta,u=o.rectDelta,h=0,c=[[n.start,s],[n.cur,a]];h<c.length;h++){var f=c[h],l=f[0],v=f[1];l.page.x-=v.x,l.page.y-=v.y,l.client.x-=v.x,l.client.y-=v.y}e.left-=u.left,e.right-=u.right,e.top-=u.top,e.bottom-=u.bottom}}},{key:"shouldDo",value:function(t,i,n,e){return!(!t||!1===t.enabled||e&&!t.endOnly||t.endOnly&&!i||"start"===n&&!t.setStart)}},{key:"copyFrom",value:function(t){this.startOffset=t.startOffset,this.startDelta=t.startDelta,this.startEdges=t.startEdges,this.edges=t.edges,this.states=t.states.map((function(t){return di(t)})),this.result=gi(B({},t.result.coords),B({},t.result.rect))}},{key:"destroy",value:function(){for(var t in this)this[t]=null}}]),t}();function gi(t,i){return{rect:i,coords:t,delta:{x:0,y:0},rectDelta:{left:0,right:0,top:0,bottom:0},eventProps:[],changed:!0}}function mi(t,i){var n=t.defaults,e={start:t.start,set:t.set,beforeEnd:t.beforeEnd,stop:t.stop},r=function(t){var r=t||{};for(var s in r.enabled=!1!==r.enabled,n)s in r||(r[s]=n[s]);var o={options:r,methods:e,name:i,enable:function(){return r.enabled=!0,o},disable:function(){return r.enabled=!1,o}};return o};return i&&"string"==typeof i&&(r.M=n,r.k=e),r}function yi(t){var i=t.iEvent,n=t.interaction.modification.result;n&&(i.modifiers=n.eventProps)}var bi={id:"modifiers/base",before:["actions"],install:function(t){t.defaults.perAction.modifiers=[]},listeners:{"interactions:new":function(t){var i=t.interaction;i.modification=new pi(i)},"interactions:before-action-start":function(t){var i=t.interaction,n=t.interaction.modification;n.start(t,i.coords.start.page),i.edges=n.edges,n.applyToInteraction(t)},"interactions:before-action-move":function(t){var i=t.interaction,n=i.modification,e=n.setAndApply(t);return i.edges=n.edges,e},"interactions:before-action-end":function(t){var i=t.interaction,n=i.modification,e=n.beforeEnd(t);return i.edges=n.startEdges,e},"interactions:action-start":yi,"interactions:action-move":yi,"interactions:action-end":yi,"interactions:after-action-start":function(t){return t.interaction.modification.restoreInteractionCoords(t)},"interactions:after-action-move":function(t){return t.interaction.modification.restoreInteractionCoords(t)},"interactions:stop":function(t){return t.interaction.modification.stop(t)}}},wi={base:{preventDefault:"auto",deltaSource:"page"},perAction:{enabled:!1,origin:{x:0,y:0}},actions:{}},xi=function(t){u(n,t);var i=l(n);function n(t,r,s,o,a,u,h){var c;e(this,n),(c=i.call(this,t)).relatedTarget=null,c.screenX=void 0,c.screenY=void 0,c.button=void 0,c.buttons=void 0,c.ctrlKey=void 0,c.shiftKey=void 0,c.altKey=void 0,c.metaKey=void 0,c.page=void 0,c.client=void 0,c.delta=void 0,c.rect=void 0,c.x0=void 0,c.y0=void 0,c.t0=void 0,c.dt=void 0,c.duration=void 0,c.clientX0=void 0,c.clientY0=void 0,c.velocity=void 0,c.speed=void 0,c.swipe=void 0,c.axes=void 0,c.preEnd=void 0,a=a||t.element;var l=t.interactable,v=(l&&l.options||wi).deltaSource,d=K(l,a,s),p="start"===o,g="end"===o,m=p?f(c):t.prevEvent,y=p?t.coords.start:g?{page:m.page,client:m.client,timeStamp:t.coords.cur.timeStamp}:t.coords.cur;return c.page=B({},y.page),c.client=B({},y.client),c.rect=B({},t.rect),c.timeStamp=y.timeStamp,g||(c.page.x-=d.x,c.page.y-=d.y,c.client.x-=d.x,c.client.y-=d.y),c.ctrlKey=r.ctrlKey,c.altKey=r.altKey,c.shiftKey=r.shiftKey,c.metaKey=r.metaKey,c.button=r.button,c.buttons=r.buttons,c.target=a,c.currentTarget=a,c.preEnd=u,c.type=h||s+(o||""),c.interactable=l,c.t0=p?t.pointers[t.pointers.length-1].downTime:m.t0,c.x0=t.coords.start.page.x-d.x,c.y0=t.coords.start.page.y-d.y,c.clientX0=t.coords.start.client.x-d.x,c.clientY0=t.coords.start.client.y-d.y,c.delta=p||g?{x:0,y:0}:{x:c[v].x-m[v].x,y:c[v].y-m[v].y},c.dt=t.coords.delta.timeStamp,c.duration=c.timeStamp-c.t0,c.velocity=B({},t.coords.velocity[v]),c.speed=Q(c.velocity.x,c.velocity.y),c.swipe=g||"inertiastart"===o?c.getSwipe():null,c}return o(n,[{key:"getSwipe",value:function(){var t=this.u;if(t.prevEvent.speed<600||this.timeStamp-t.prevEvent.timeStamp>150)return null;var i=180*Math.atan2(t.prevEvent.velocityY,t.prevEvent.velocityX)/Math.PI;i<0&&(i+=360);var n=112.5<=i&&i<247.5,e=202.5<=i&&i<337.5;return{up:e,down:!e&&22.5<=i&&i<157.5,left:n,right:!n&&(292.5<=i||i<67.5),angle:i,speed:t.prevEvent.speed,velocity:{x:t.prevEvent.velocityX,y:t.prevEvent.velocityY}}}},{key:"preventDefault",value:function(){}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}}]),n}(gt);Object.defineProperties(xi.prototype,{pageX:{get:function(){return this.page.x},set:function(t){this.page.x=t}},pageY:{get:function(){return this.page.y},set:function(t){this.page.y=t}},clientX:{get:function(){return this.client.x},set:function(t){this.client.x=t}},clientY:{get:function(){return this.client.y},set:function(t){this.client.y=t}},dx:{get:function(){return this.delta.x},set:function(t){this.delta.x=t}},dy:{get:function(){return this.delta.y},set:function(t){this.delta.y=t}},velocityX:{get:function(){return this.velocity.x},set:function(t){this.velocity.x=t}},velocityY:{get:function(){return this.velocity.y},set:function(t){this.velocity.y=t}}});var ki,Mi=o((function t(i,n,r,s,o){e(this,t),this.id=void 0,this.pointer=void 0,this.event=void 0,this.downTime=void 0,this.downTarget=void 0,this.id=i,this.pointer=n,this.event=r,this.downTime=s,this.downTarget=o})),Oi=((ki={}).interactable="",ki.element="",ki.prepared="",ki.pointerIsDown="",ki.pointerWasMoved="",ki.h="",ki),Si=function(t){return t.start="",t.move="",t.end="",t.stop="",t.interacting="",t}({}),Ei=0,Ti=function(){function t(i){var n=this,r=i.pointerType,s=i.scopeFire;e(this,t),this.interactable=null,this.element=null,this.rect=null,this.l=void 0,this.edges=null,this.O=void 0,this.prepared={name:null,axis:null,edges:null},this.pointerType=void 0,this.pointers=[],this.downEvent=null,this.downPointer={},this.v={pointer:null,event:null,eventTarget:null},this.prevEvent=null,this.pointerIsDown=!1,this.pointerWasMoved=!1,this.m=!1,this.S=!1,this.T=!0,this.h=void 0,this.simulation=null,this.doMove=qt((function(t){this.move(t)}),"The interaction.doMove() method has been renamed to interaction.move()"),this.coords={start:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},prev:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},cur:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},delta:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},velocity:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0}},this.D=Ei++,this.O=s,this.pointerType=r;var o=this;this.h={};var a=function(t){Object.defineProperty(n.h,t,{get:function(){return o[t]}})};for(var u in Oi)a(u);var h=function(t){Object.defineProperty(n.h,t,{value:function(){return o[t].apply(o,arguments)}})};for(var c in Si)h(c);this.O("interactions:new",{interaction:this})}return o(t,[{key:"pointerMoveTolerance",get:function(){return 1}},{key:"pointerDown",value:function(t,i,n){var e=this.updatePointer(t,i,n,!0),r=this.pointers[e];this.O("interactions:down",{pointer:t,event:i,eventTarget:n,pointerIndex:e,pointerInfo:r,type:"down",interaction:this})}},{key:"start",value:function(t,i,n){return!(this.interacting()||!this.pointerIsDown||this.pointers.length<("gesture"===t.name?2:1)||!i.options[t.name].enabled)&&(Vt(this.prepared,t),this.interactable=i,this.element=n,this.rect=i.getRect(n),this.edges=this.prepared.edges?B({},this.prepared.edges):{left:!0,right:!0,top:!0,bottom:!0},this.T=!1,this.m=this.C({interaction:this,event:this.downEvent,phase:"start"})&&!this.T,this.m)}},{key:"pointerMove",value:function(t,i,n){this.simulation||this.modification&&this.modification.endResult||this.updatePointer(t,i,n,!1);var e,r,s=this.coords.cur.page.x===this.coords.prev.page.x&&this.coords.cur.page.y===this.coords.prev.page.y&&this.coords.cur.client.x===this.coords.prev.client.x&&this.coords.cur.client.y===this.coords.prev.client.y;this.pointerIsDown&&!this.pointerWasMoved&&(e=this.coords.cur.client.x-this.coords.start.client.x,r=this.coords.cur.client.y-this.coords.start.client.y,this.pointerWasMoved=Q(e,r)>this.pointerMoveTolerance);var o,a,u,h=this.getPointerIndex(t),c={pointer:t,pointerIndex:h,pointerInfo:this.pointers[h],event:i,type:"move",eventTarget:n,dx:e,dy:r,duplicate:s,interaction:this};s||(o=this.coords.velocity,a=this.coords.delta,u=Math.max(a.timeStamp/1e3,.001),o.page.x=a.page.x/u,o.page.y=a.page.y/u,o.client.x=a.client.x/u,o.client.y=a.client.y/u,o.timeStamp=u),this.O("interactions:move",c),s||this.simulation||(this.interacting()&&(c.type=null,this.move(c)),this.pointerWasMoved&&nt(this.coords.prev,this.coords.cur))}},{key:"move",value:function(t){t&&t.event||et(this.coords.delta),(t=B({pointer:this.v.pointer,event:this.v.event,eventTarget:this.v.eventTarget,interaction:this},t||{})).phase="move",this.C(t)}},{key:"pointerUp",value:function(t,i,n,e){var r=this.getPointerIndex(t);-1===r&&(r=this.updatePointer(t,i,n,!1));var s=/cancel$/i.test(i.type)?"cancel":"up";this.O("interactions:".concat(s),{pointer:t,pointerIndex:r,pointerInfo:this.pointers[r],event:i,eventTarget:n,type:s,curEventTarget:e,interaction:this}),this.simulation||this.end(i),this.removePointer(t,i)}},{key:"documentBlur",value:function(t){this.end(t),this.O("interactions:blur",{event:t,type:"blur",interaction:this})}},{key:"end",value:function(t){var i;this.S=!0,t=t||this.v.event,this.interacting()&&(i=this.C({event:t,interaction:this,phase:"end"})),this.S=!1,!0===i&&this.stop()}},{key:"currentAction",value:function(){return this.m?this.prepared.name:null}},{key:"interacting",value:function(){return this.m}},{key:"stop",value:function(){this.O("interactions:stop",{interaction:this}),this.interactable=this.element=null,this.m=!1,this.T=!0,this.prepared.name=this.prevEvent=null}},{key:"getPointerIndex",value:function(t){var i=at(t);return"mouse"===this.pointerType||"pen"===this.pointerType?this.pointers.length-1:bt(this.pointers,(function(t){return t.id===i}))}},{key:"getPointerInfo",value:function(t){return this.pointers[this.getPointerIndex(t)]}},{key:"updatePointer",value:function(t,i,n,e){var r,s,o,a=at(t),u=this.getPointerIndex(t),h=this.pointers[u];return e=!1!==e&&(e||/(down|start)$/i.test(i.type)),h?h.pointer=t:(h=new Mi(a,t,i,null,null),u=this.pointers.length,this.pointers.push(h)),ut(this.coords.cur,this.pointers.map((function(t){return t.pointer})),this._()),r=this.coords.delta,s=this.coords.prev,o=this.coords.cur,r.page.x=o.page.x-s.page.x,r.page.y=o.page.y-s.page.y,r.client.x=o.client.x-s.client.x,r.client.y=o.client.y-s.client.y,r.timeStamp=o.timeStamp-s.timeStamp,e&&(this.pointerIsDown=!0,h.downTime=this.coords.cur.timeStamp,h.downTarget=n,it(this.downPointer,t),this.interacting()||(nt(this.coords.start,this.coords.cur),nt(this.coords.prev,this.coords.cur),this.downEvent=i,this.pointerWasMoved=!1)),this.P(t,i,n),this.O("interactions:update-pointer",{pointer:t,event:i,eventTarget:n,down:e,pointerInfo:h,pointerIndex:u,interaction:this}),u}},{key:"removePointer",value:function(t,i){var n=this.getPointerIndex(t);if(-1!==n){var e=this.pointers[n];this.O("interactions:remove-pointer",{pointer:t,event:i,eventTarget:null,pointerIndex:n,pointerInfo:e,interaction:this}),this.pointers.splice(n,1),this.pointerIsDown=!1}}},{key:"_updateLatestPointer",value:function(t,i,n){this.v.pointer=t,this.v.event=i,this.v.eventTarget=n}},{key:"destroy",value:function(){this.v.pointer=null,this.v.event=null,this.v.eventTarget=null}},{key:"_createPreparedEvent",value:function(t,i,n,e){return new xi(this,t,this.prepared.name,i,this.element,n,e)}},{key:"_fireEvent",value:function(t){var i;null==(i=this.interactable)||i.fire(t),(!this.prevEvent||t.timeStamp>=this.prevEvent.timeStamp)&&(this.prevEvent=t)}},{key:"_doPhase",value:function(t){var i=t.event,n=t.phase,e=t.preEnd,r=t.type,s=this.rect;if(s&&"move"===n&&(G(this.edges,s,this.coords.delta[this.interactable.options.deltaSource]),s.width=s.right-s.left,s.height=s.bottom-s.top),!1===this.O("interactions:before-action-".concat(n),t))return!1;var o=t.iEvent=this.j(i,n,e,r);return this.O("interactions:action-".concat(n),t),"start"===n&&(this.prevEvent=o),this.I(o),this.O("interactions:after-action-".concat(n),t),!0}},{key:"_now",value:function(){return Date.now()}}]),t}();function Di(t){Ci(t.interaction)}function Ci(t){if(!(i=t).offset.pending.x&&!i.offset.pending.y)return!1;var i,n=t.offset.pending;return Pi(t.coords.cur,n),Pi(t.coords.delta,n),G(t.edges,t.rect,n),n.x=0,n.y=0,!0}function _i(t){var i=t.x,n=t.y;this.offset.pending.x+=i,this.offset.pending.y+=n,this.offset.total.x+=i,this.offset.total.y+=n}function Pi(t,i){var n=t.page,e=t.client,r=i.x,s=i.y;n.x+=r,n.y+=s,e.x+=r,e.y+=s}Si.offsetBy="";var ji={id:"offset",before:["modifiers","pointer-events","actions","inertia"],install:function(t){t.Interaction.prototype.offsetBy=_i},listeners:{"interactions:new":function(t){t.interaction.offset={total:{x:0,y:0},pending:{x:0,y:0}}},"interactions:update-pointer":function(t){var i;(i=t.interaction).pointerIsDown&&(Pi(i.coords.cur,i.offset.total),i.offset.pending.x=0,i.offset.pending.y=0)},"interactions:before-action-start":Di,"interactions:before-action-move":Di,"interactions:before-action-end":function(t){var i=t.interaction;if(Ci(i))return i.move({offset:!0}),i.end(),!1},"interactions:stop":function(t){var i=t.interaction;i.offset.total.x=0,i.offset.total.y=0,i.offset.pending.x=0,i.offset.pending.y=0}}},zi=function(){function t(i){e(this,t),this.active=!1,this.isModified=!1,this.smoothEnd=!1,this.allowResume=!1,this.modification=void 0,this.modifierCount=0,this.modifierArg=void 0,this.startCoords=void 0,this.t0=0,this.v0=0,this.te=0,this.targetOffset=void 0,this.modifiedOffset=void 0,this.currentOffset=void 0,this.lambda_v0=0,this.one_ve_v0=0,this.timeout=void 0,this.interaction=void 0,this.interaction=i}return o(t,[{key:"start",value:function(t){var i=this.interaction,n=Ii(i);if(!n||!n.enabled)return!1;var e=i.coords.velocity.client,r=Q(e.x,e.y),s=this.modification||(this.modification=new pi(i));if(s.copyFrom(i.modification),this.t0=i._(),this.allowResume=n.allowResume,this.v0=r,this.currentOffset={x:0,y:0},this.startCoords=i.coords.cur.page,this.modifierArg=s.fillArg({pageCoords:this.startCoords,preEnd:!0,phase:"inertiastart"}),this.t0-i.coords.cur.timeStamp<50&&r>n.minSpeed&&r>n.endSpeed)this.startInertia();else{if(s.result=s.setAll(this.modifierArg),!s.result.changed)return!1;this.startSmoothEnd()}return i.modification.result.rect=null,i.offsetBy(this.targetOffset),i.C({interaction:i,event:t,phase:"inertiastart"}),i.offsetBy({x:-this.targetOffset.x,y:-this.targetOffset.y}),i.modification.result.rect=null,this.active=!0,i.simulation=this,!0}},{key:"startInertia",value:function(){var t=this,i=this.interaction.coords.velocity.client,n=Ii(this.interaction),e=n.resistance,r=-Math.log(n.endSpeed/this.v0)/e;this.targetOffset={x:(i.x-r)/e,y:(i.y-r)/e},this.te=r,this.lambda_v0=e/this.v0,this.one_ve_v0=1-n.endSpeed/this.v0;var s=this.modification,o=this.modifierArg;o.pageCoords={x:this.startCoords.x+this.targetOffset.x,y:this.startCoords.y+this.targetOffset.y},s.result=s.setAll(o),s.result.changed&&(this.isModified=!0,this.modifiedOffset={x:this.targetOffset.x+s.result.delta.x,y:this.targetOffset.y+s.result.delta.y}),this.onNextFrame((function(){return t.inertiaTick()}))}},{key:"startSmoothEnd",value:function(){var t=this;this.smoothEnd=!0,this.isModified=!0,this.targetOffset={x:this.modification.result.delta.x,y:this.modification.result.delta.y},this.onNextFrame((function(){return t.smoothEndTick()}))}},{key:"onNextFrame",value:function(t){var i=this;this.timeout=Xt.request((function(){i.active&&t()}))}},{key:"inertiaTick",value:function(){var t,i,n,e,r,s,o,a=this,u=this.interaction,h=Ii(u).resistance,c=(u._()-this.t0)/1e3;if(c<this.te){var f,l=1-(Math.exp(-h*c)-this.lambda_v0)/this.one_ve_v0;this.isModified?(t=0,i=0,n=this.targetOffset.x,e=this.targetOffset.y,r=this.modifiedOffset.x,s=this.modifiedOffset.y,f={x:Ri(o=l,t,n,r),y:Ri(o,i,e,s)}):f={x:this.targetOffset.x*l,y:this.targetOffset.y*l};var v={x:f.x-this.currentOffset.x,y:f.y-this.currentOffset.y};this.currentOffset.x+=v.x,this.currentOffset.y+=v.y,u.offsetBy(v),u.move(),this.onNextFrame((function(){return a.inertiaTick()}))}else u.offsetBy({x:this.modifiedOffset.x-this.currentOffset.x,y:this.modifiedOffset.y-this.currentOffset.y}),this.end()}},{key:"smoothEndTick",value:function(){var t=this,i=this.interaction,n=i._()-this.t0,e=Ii(i).smoothEndDuration;if(n<e){var r={x:Fi(n,0,this.targetOffset.x,e),y:Fi(n,0,this.targetOffset.y,e)},s={x:r.x-this.currentOffset.x,y:r.y-this.currentOffset.y};this.currentOffset.x+=s.x,this.currentOffset.y+=s.y,i.offsetBy(s),i.move({skipModifiers:this.modifierCount}),this.onNextFrame((function(){return t.smoothEndTick()}))}else i.offsetBy({x:this.targetOffset.x-this.currentOffset.x,y:this.targetOffset.y-this.currentOffset.y}),this.end()}},{key:"resume",value:function(t){var i=t.pointer,n=t.event,e=t.eventTarget,r=this.interaction;r.offsetBy({x:-this.currentOffset.x,y:-this.currentOffset.y}),r.updatePointer(i,n,e,!0),r.C({interaction:r,event:n,phase:"resume"}),nt(r.coords.prev,r.coords.cur),this.stop()}},{key:"end",value:function(){this.interaction.move(),this.interaction.end(),this.stop()}},{key:"stop",value:function(){this.active=this.smoothEnd=!1,this.interaction.simulation=null,Xt.cancel(this.timeout)}}]),t}();function Ii(t){var i=t.interactable,n=t.prepared;return i&&i.options&&n.name&&i.options[n.name].inertia}function Ri(t,i,n,e){var r=1-t;return r*r*i+2*r*t*n+t*t*e}function Fi(t,i,n,e){return-n*(t/=e)*(t-2)+i}var Li={id:"inertia",before:["modifiers","actions"],install:function(t){var i=t.defaults;t.usePlugin(ji),t.usePlugin(bi),t.actions.phases.inertiastart=!0,t.actions.phases.resume=!0,i.perAction.inertia={enabled:!1,resistance:10,minSpeed:100,endSpeed:10,allowResume:!0,smoothEndDuration:300}},listeners:{"interactions:new":function(t){var i=t.interaction;i.inertia=new zi(i)},"interactions:before-action-end":function(t){var i=t.interaction,n=t.event;return(!i.m||i.simulation||!i.inertia.start(n))&&null},"interactions:down":function(t){var i=t.interaction,n=t.eventTarget,e=i.inertia;if(e.active)for(var r=n;k.element(r);){if(r===i.element){e.resume(t);break}r=I(r)}},"interactions:stop":function(t){var i=t.interaction.inertia;i.active&&i.stop()},"interactions:before-action-resume":function(t){var i=t.interaction.modification;i.stop(t),i.start(t,t.interaction.coords.cur.page),i.applyToInteraction(t)},"interactions:before-action-inertiastart":function(t){return t.interaction.modification.setAndApply(t)},"interactions:action-resume":yi,"interactions:action-inertiastart":yi,"interactions:after-action-inertiastart":function(t){return t.interaction.modification.restoreInteractionCoords(t)},"interactions:after-action-resume":function(t){return t.interaction.modification.restoreInteractionCoords(t)}}};function $i(t,i){for(var n=0;n<i.length;n++){var e=i[n];if(t.immediatePropagationStopped)break;e(t)}}var Ai=function(){function t(i){e(this,t),this.options=void 0,this.types={},this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.global=void 0,this.options=B({},i||{})}return o(t,[{key:"fire",value:function(t){var i,n=this.global;(i=this.types[t.type])&&$i(t,i),!t.propagationStopped&&n&&(i=n[t.type])&&$i(t,i)}},{key:"on",value:function(t,i){var n=Z(t,i);for(t in n)this.types[t]=mt(this.types[t]||[],n[t])}},{key:"off",value:function(t,i){var n=Z(t,i);for(t in n){var e=this.types[t];if(e&&e.length)for(var r=0,s=n[t];r<s.length;r++){var o=s[r],a=e.indexOf(o);-1!==a&&e.splice(a,1)}}}},{key:"getRect",value:function(t){return null}}]),t}(),Ni=function(){function t(i){e(this,t),this.currentTarget=void 0,this.originalEvent=void 0,this.type=void 0,this.originalEvent=i,it(this,i)}return o(t,[{key:"preventOriginalDefault",value:function(){this.originalEvent.preventDefault()}},{key:"stopPropagation",value:function(){this.originalEvent.stopPropagation()}},{key:"stopImmediatePropagation",value:function(){this.originalEvent.stopImmediatePropagation()}}]),t}();function Xi(t){return k.object(t)?{capture:!!t.capture,passive:!!t.passive}:{capture:!!t,passive:!1}}function Yi(t,i){return t===i||("boolean"==typeof t?!!i.capture===t&&0==!!i.passive:!!t.capture==!!i.capture&&!!t.passive==!!i.passive)}var Ui={id:"events",install:function(t){var i,n=[],e={},r=[],s={add:o,remove:a,addDelegate:function(t,i,n,s,a){var c=Xi(a);if(!e[n]){e[n]=[];for(var f=0;f<r.length;f++){var l=r[f];o(l,n,u),o(l,n,h,!0)}}var v=e[n],d=wt(v,(function(n){return n.selector===t&&n.context===i}));d||(d={selector:t,context:i,listeners:[]},v.push(d)),d.listeners.push({func:s,options:c})},removeDelegate:function(t,i,n,r,s){var o,c=Xi(s),f=e[n],l=!1;if(f)for(o=f.length-1;o>=0;o--){var v=f[o];if(v.selector===t&&v.context===i){for(var d=v.listeners,p=d.length-1;p>=0;p--){var g=d[p];if(g.func===r&&Yi(g.options,c)){d.splice(p,1),d.length||(f.splice(o,1),a(i,n,u),a(i,n,h,!0)),l=!0;break}}if(l)break}}},delegateListener:u,delegateUseCapture:h,delegatedEvents:e,documents:r,targets:n,supportsOptions:!1,supportsPassive:!1};function o(t,i,e,r){if(t.addEventListener){var o=Xi(r),a=wt(n,(function(i){return i.eventTarget===t}));a||(a={eventTarget:t,events:{}},n.push(a)),a.events[i]||(a.events[i]=[]),wt(a.events[i],(function(t){return t.func===e&&Yi(t.options,o)}))||(t.addEventListener(i,e,s.supportsOptions?o:o.capture),a.events[i].push({func:e,options:o}))}}function a(t,i,e,r){if(t.addEventListener&&t.removeEventListener){var o=bt(n,(function(i){return i.eventTarget===t})),u=n[o];if(u&&u.events)if("all"!==i){var h=!1,c=u.events[i];if(c){if("all"===e){for(var f=c.length-1;f>=0;f--){var l=c[f];a(t,i,l.func,l.options)}return}for(var v=Xi(r),d=0;d<c.length;d++){var p=c[d];if(p.func===e&&Yi(p.options,v)){t.removeEventListener(i,e,s.supportsOptions?v:v.capture),c.splice(d,1),0===c.length&&(delete u.events[i],h=!0);break}}}h&&!Object.keys(u.events).length&&n.splice(o,1)}else for(i in u.events)u.events.hasOwnProperty(i)&&a(t,i,"all")}}function u(t,i){for(var n=Xi(i),r=new Ni(t),s=e[t.type],o=pt(t)[0],a=o;k.element(a);){for(var u=0;u<s.length;u++){var h=s[u],c=h.selector,f=h.context;if(R(a,c)&&j(f,o)&&j(f,a)){var l=h.listeners;r.currentTarget=a;for(var v=0;v<l.length;v++){var d=l[v];Yi(d.options,n)&&d.func(r)}}}a=I(a)}}function h(t){return u(t,!0)}return null==(i=t.document)||i.createElement("div").addEventListener("test",null,{get capture(){return s.supportsOptions=!0},get passive(){return s.supportsPassive=!0}}),t.events=s,s}},Bi={methodOrder:["simulationResume","mouseOrPen","hasPointer","idle"],search:function(t){for(var i=0,n=Bi.methodOrder;i<n.length;i++){var e=n[i],r=Bi[e](t);if(r)return r}return null},simulationResume:function(t){var i=t.pointerType,n=t.eventType,e=t.eventTarget,r=t.scope;if(!/down|start/i.test(n))return null;for(var s=0,o=r.interactions.list;s<o.length;s++){var a=o[s],u=e;if(a.simulation&&a.simulation.allowResume&&a.pointerType===i)for(;u;){if(u===a.element)return a;u=I(u)}}return null},mouseOrPen:function(t){var i,n=t.pointerId,e=t.pointerType,r=t.eventType,s=t.scope;if("mouse"!==e&&"pen"!==e)return null;for(var o=0,a=s.interactions.list;o<a.length;o++){var u=a[o];if(u.pointerType===e){if(u.simulation&&!Wi(u,n))continue;if(u.interacting())return u;i||(i=u)}}if(i)return i;for(var h=0,c=s.interactions.list;h<c.length;h++){var f=c[h];if(!(f.pointerType!==e||/down/i.test(r)&&f.simulation))return f}return null},hasPointer:function(t){for(var i=t.pointerId,n=0,e=t.scope.interactions.list;n<e.length;n++){var r=e[n];if(Wi(r,i))return r}return null},idle:function(t){for(var i=t.pointerType,n=0,e=t.scope.interactions.list;n<e.length;n++){var r=e[n];if(1===r.pointers.length){var s=r.interactable;if(s&&(!s.options.gesture||!s.options.gesture.enabled))continue}else if(r.pointers.length>=2)continue;if(!r.interacting()&&i===r.pointerType)return r}return null}};function Wi(t,i){return t.pointers.some((function(t){return t.id===i}))}var qi=Bi,Vi=["pointerDown","pointerMove","pointerUp","updatePointer","removePointer","windowBlur"];function Hi(t,i){return function(n){var e=i.interactions.list,r=dt(n),s=pt(n),o=s[0],a=s[1],u=[];if(/^touch/.test(n.type)){i.prevTouchTime=i.now();for(var h=0,c=n.changedTouches;h<c.length;h++){var f=c[h],l={pointer:f,pointerId:at(f),pointerType:r,eventType:n.type,eventTarget:o,curEventTarget:a,scope:i},v=Gi(l);u.push([l.pointer,l.eventTarget,l.curEventTarget,v])}}else{var d=!1;if(!P.supportsPointerEvent&&/mouse/.test(n.type)){for(var p=0;p<e.length&&!d;p++)d="mouse"!==e[p].pointerType&&e[p].pointerIsDown;d=d||i.now()-i.prevTouchTime<500||0===n.timeStamp}if(!d){var g={pointer:n,pointerId:at(n),pointerType:r,eventType:n.type,curEventTarget:a,eventTarget:o,scope:i},m=Gi(g);u.push([g.pointer,g.eventTarget,g.curEventTarget,m])}}for(var y=0;y<u.length;y++){var b=u[y],w=b[0],x=b[1],k=b[2];b[3][t](w,n,x,k)}}}function Gi(t){var i=t.pointerType,n=t.scope,e={interaction:qi.search(t),searchDetails:t};return n.fire("interactions:find",e),e.interaction||n.interactions.new({pointerType:i})}function Ki(t,i){var n=t.doc,e=t.scope,r=t.options,s=e.interactions.docEvents,o=e.events,a=o[i];for(var u in e.browser.isIOS&&!r.events&&(r.events={passive:!1}),o.delegatedEvents)a(n,u,o.delegateListener),a(n,u,o.delegateUseCapture,!0);for(var h=r&&r.events,c=0;c<s.length;c++){var f=s[c];a(n,f.type,f.listener,h)}}var Zi={id:"core/interactions",install:function(t){for(var i={},n=0;n<Vi.length;n++){var r=Vi[n];i[r]=Hi(r,t)}var s,a=P.pEventTypes;function h(){for(var i=0,n=t.interactions.list;i<n.length;i++){var e=n[i];if(e.pointerIsDown&&"touch"===e.pointerType&&!e.m)for(var r=function(){var i=o[s];t.documents.some((function(t){return j(t.doc,i.downTarget)}))||e.removePointer(i.pointer,i.event)},s=0,o=e.pointers;s<o.length;s++)r()}}(s=C.PointerEvent?[{type:a.down,listener:h},{type:a.down,listener:i.pointerDown},{type:a.move,listener:i.pointerMove},{type:a.up,listener:i.pointerUp},{type:a.cancel,listener:i.pointerUp}]:[{type:"mousedown",listener:i.pointerDown},{type:"mousemove",listener:i.pointerMove},{type:"mouseup",listener:i.pointerUp},{type:"touchstart",listener:h},{type:"touchstart",listener:i.pointerDown},{type:"touchmove",listener:i.pointerMove},{type:"touchend",listener:i.pointerUp},{type:"touchcancel",listener:i.pointerUp}]).push({type:"blur",listener:function(i){for(var n=0,e=t.interactions.list;n<e.length;n++)e[n].documentBlur(i)}}),t.prevTouchTime=0,t.Interaction=function(i){u(r,i);var n=l(r);function r(){return e(this,r),n.apply(this,arguments)}return o(r,[{key:"pointerMoveTolerance",get:function(){return t.interactions.pointerMoveTolerance},set:function(i){t.interactions.pointerMoveTolerance=i}},{key:"_now",value:function(){return t.now()}}]),r}(Ti),t.interactions={list:[],new:function(i){i.scopeFire=function(i,n){return t.fire(i,n)};var n=new t.Interaction(i);return t.interactions.list.push(n),n},listeners:i,docEvents:s,pointerMoveTolerance:1},t.usePlugin(li)},listeners:{"scope:add-document":function(t){return Ki(t,"add")},"scope:remove-document":function(t){return Ki(t,"remove")},"interactable:unset":function(t,i){for(var n=t.interactable,e=i.interactions.list.length-1;e>=0;e--){var r=i.interactions.list[e];r.interactable===n&&(r.stop(),i.fire("interactions:destroy",{interaction:r}),r.destroy(),i.interactions.list.length>2&&i.interactions.list.splice(e,1))}}},onDocSignal:Ki,doOnInteractions:Hi,methodNames:Vi},Ji=Zi,Qi=function(t){return t[t.On=0]="On",t[t.Off=1]="Off",t}(Qi||{}),tn=function(){function t(i,n,r,s){e(this,t),this.target=void 0,this.options=void 0,this.R=void 0,this.events=new Ai,this.F=void 0,this.L=void 0,this.$=void 0,this.A=void 0,this.R=n.actions,this.target=i,this.F=n.context||r,this.L=b(U(i)?this.F:i),this.$=this.L.document,this.A=s,this.set(n)}return o(t,[{key:"_defaults",get:function(){return{base:{},perAction:{},actions:{}}}},{key:"setOnEvents",value:function(t,i){return k.func(i.onstart)&&this.on("".concat(t,"start"),i.onstart),k.func(i.onmove)&&this.on("".concat(t,"move"),i.onmove),k.func(i.onend)&&this.on("".concat(t,"end"),i.onend),k.func(i.oninertiastart)&&this.on("".concat(t,"inertiastart"),i.oninertiastart),this}},{key:"updatePerActionListeners",value:function(t,i,n){var e,r=this,s=null==(e=this.R.map[t])?void 0:e.filterEventType,o=function(t){return(null==s||s(t))&&vi(t,r.R)};(k.array(i)||k.object(i))&&this.N(Qi.Off,t,i,void 0,o),(k.array(n)||k.object(n))&&this.N(Qi.On,t,n,void 0,o)}},{key:"setPerAction",value:function(t,i){var n=this.M;for(var e in i){var r=e,s=this.options[t],o=i[r];"listeners"===r&&this.updatePerActionListeners(t,s.listeners,o),k.array(o)?s[r]=yt(o):k.plainObject(o)?(s[r]=B(s[r]||{},di(o)),k.object(n.perAction[r])&&"enabled"in n.perAction[r]&&(s[r].enabled=!1!==o.enabled)):k.bool(o)&&k.object(n.perAction[r])?s[r].enabled=o:s[r]=o}}},{key:"getRect",value:function(t){return t=t||(k.element(this.target)?this.target:null),k.string(this.target)&&(t=t||this.F.querySelector(this.target)),X(t)}},{key:"rectChecker",value:function(t){var i=this;return k.func(t)?(this.getRect=function(n){var e=B({},t.apply(i,n));return"width"in e||(e.width=e.right-e.left,e.height=e.bottom-e.top),e},this):null===t?(delete this.getRect,this):this.getRect}},{key:"_backCompatOption",value:function(t,i){if(U(i)||k.object(i)){for(var n in this.options[t]=i,this.R.map)this.options[n][t]=i;return this}return this.options[t]}},{key:"origin",value:function(t){return this.p("origin",t)}},{key:"deltaSource",value:function(t){return"page"===t||"client"===t?(this.options.deltaSource=t,this):this.options.deltaSource}},{key:"getAllElements",value:function(){var t=this.target;return k.string(t)?Array.from(this.F.querySelectorAll(t)):k.func(t)&&t.getAllElements?t.getAllElements():k.element(t)?[t]:[]}},{key:"context",value:function(){return this.F}},{key:"inContext",value:function(t){return this.F===t.ownerDocument||j(this.F,t)}},{key:"testIgnoreAllow",value:function(t,i,n){return!this.testIgnore(t.ignoreFrom,i,n)&&this.testAllow(t.allowFrom,i,n)}},{key:"testAllow",value:function(t,i,n){return!t||!!k.element(n)&&(k.string(t)?$(n,t,i):!!k.element(t)&&j(t,n))}},{key:"testIgnore",value:function(t,i,n){return!(!t||!k.element(n))&&(k.string(t)?$(n,t,i):!!k.element(t)&&j(t,n))}},{key:"fire",value:function(t){return this.events.fire(t),this}},{key:"_onOff",value:function(t,i,n,e,r){k.object(i)&&!k.array(i)&&(e=n,n=null);var s=Z(i,n,r);for(var o in s){"wheel"===o&&(o=P.wheelEvent);for(var a=0,u=s[o];a<u.length;a++){var h=u[a];vi(o,this.R)?this.events[t===Qi.On?"on":"off"](o,h):k.string(this.target)?this.A[t===Qi.On?"addDelegate":"removeDelegate"](this.target,this.F,o,h,e):this.A[t===Qi.On?"add":"remove"](this.target,o,h,e)}}return this}},{key:"on",value:function(t,i,n){return this.N(Qi.On,t,i,n)}},{key:"off",value:function(t,i,n){return this.N(Qi.Off,t,i,n)}},{key:"set",value:function(t){var i=this.M;for(var n in k.object(t)||(t={}),this.options=di(i.base),this.R.methodDict){var e=n,r=this.R.methodDict[e];this.options[e]={},this.setPerAction(e,B(B({},i.perAction),i.actions[e])),this[r](t[e])}for(var s in t)"getRect"!==s?k.func(this[s])&&this[s](t[s]):this.rectChecker(t.getRect);return this}},{key:"unset",value:function(){if(k.string(this.target))for(var t in this.A.delegatedEvents)for(var i=this.A.delegatedEvents[t],n=i.length-1;n>=0;n--){var e=i[n],r=e.selector,s=e.context,o=e.listeners;r===this.target&&s===this.F&&i.splice(n,1);for(var a=o.length-1;a>=0;a--)this.A.removeDelegate(this.target,this.F,t,o[a][0],o[a][1])}else this.A.remove(this.target,"all")}}]),t}(),nn=function(){function t(i){var n=this;e(this,t),this.list=[],this.selectorMap={},this.scope=void 0,this.scope=i,i.addListeners({"interactable:unset":function(t){var i=t.interactable,e=i.target,r=k.string(e)?n.selectorMap[e]:e[n.scope.id],s=bt(r,(function(t){return t===i}));r.splice(s,1)}})}return o(t,[{key:"new",value:function(t,i){i=B(i||{},{actions:this.scope.actions});var n=new this.scope.Interactable(t,i,this.scope.document,this.scope.events);return this.scope.addDocument(n.$),this.list.push(n),k.string(t)?(this.selectorMap[t]||(this.selectorMap[t]=[]),this.selectorMap[t].push(n)):(n.target[this.scope.id]||Object.defineProperty(t,this.scope.id,{value:[],configurable:!0}),t[this.scope.id].push(n)),this.scope.fire("interactable:new",{target:t,options:i,interactable:n,win:this.scope.L}),n}},{key:"getExisting",value:function(t,i){var n=i&&i.context||this.scope.document,e=k.string(t),r=e?this.selectorMap[t]:t[this.scope.id];if(r)return wt(r,(function(i){return i.F===n&&(e||i.inContext(t))}))}},{key:"forEachMatch",value:function(t,i){for(var n=0,e=this.list;n<e.length;n++){var r=e[n],s=void 0;if((k.string(r.target)?k.element(t)&&R(t,r.target):t===r.target)&&r.inContext(t)&&(s=i(r)),void 0!==s)return s}}}]),t}(),en=function(){function t(){var i,n,r=this;e(this,t),this.id="__interact_scope_".concat(Math.floor(100*Math.random())),this.isInitialized=!1,this.listenerMaps=[],this.browser=P,this.defaults=di(wi),this.Eventable=Ai,this.actions={map:{},phases:{start:!0,move:!0,end:!0},methodDict:{},phaselessTypes:{}},this.interactStatic=(i=this,(n=function t(n,e){var r=i.interactables.getExisting(n,e);return r||((r=i.interactables.new(n,e)).events.global=t.globalEvents),r}).getPointerAverage=ct,n.getTouchBBox=ft,n.getTouchDistance=lt,n.getTouchAngle=vt,n.getElementRect=X,n.getElementClientRect=N,n.matchesSelector=R,n.closest=z,n.globalEvents={},n.version="1.10.27",n.scope=i,n.use=function(t,i){return this.scope.usePlugin(t,i),this},n.isSet=function(t,i){return!!this.scope.interactables.get(t,i&&i.context)},n.on=qt((function(t,i,n){if(k.string(t)&&-1!==t.search(" ")&&(t=t.trim().split(/ +/)),k.array(t)){for(var e=0,r=t;e<r.length;e++){var s=r[e];this.on(s,i,n)}return this}if(k.object(t)){for(var o in t)this.on(o,t[o],i);return this}return vi(t,this.scope.actions)?this.globalEvents[t]?this.globalEvents[t].push(i):this.globalEvents[t]=[i]:this.scope.events.add(this.scope.document,t,i,{options:n}),this}),"The interact.on() method is being deprecated"),n.off=qt((function(t,i,n){if(k.string(t)&&-1!==t.search(" ")&&(t=t.trim().split(/ +/)),k.array(t)){for(var e=0,r=t;e<r.length;e++){var s=r[e];this.off(s,i,n)}return this}if(k.object(t)){for(var o in t)this.off(o,t[o],i);return this}var a;return vi(t,this.scope.actions)?t in this.globalEvents&&-1!==(a=this.globalEvents[t].indexOf(i))&&this.globalEvents[t].splice(a,1):this.scope.events.remove(this.scope.document,t,i,n),this}),"The interact.off() method is being deprecated"),n.debug=function(){return this.scope},n.supportsTouch=function(){return P.supportsTouch},n.supportsPointerEvent=function(){return P.supportsPointerEvent},n.stop=function(){for(var t=0,i=this.scope.interactions.list;t<i.length;t++)i[t].stop();return this},n.pointerMoveTolerance=function(t){return k.number(t)?(this.scope.interactions.pointerMoveTolerance=t,this):this.scope.interactions.pointerMoveTolerance},n.addDocument=function(t,i){this.scope.addDocument(t,i)},n.removeDocument=function(t){this.scope.removeDocument(t)},n),this.InteractEvent=xi,this.Interactable=void 0,this.interactables=new nn(this),this.L=void 0,this.document=void 0,this.window=void 0,this.documents=[],this.X={list:[],map:{}},this.onWindowUnload=function(t){return r.removeDocument(t.target)};var s=this;this.Interactable=function(t){u(n,t);var i=l(n);function n(){return e(this,n),i.apply(this,arguments)}return o(n,[{key:"_defaults",get:function(){return s.defaults}},{key:"set",value:function(t){return v(h(n.prototype),"set",this).call(this,t),s.fire("interactable:set",{options:t,interactable:this}),this}},{key:"unset",value:function(){v(h(n.prototype),"unset",this).call(this);var t=s.interactables.list.indexOf(this);t<0||(s.interactables.list.splice(t,1),s.fire("interactable:unset",{interactable:this}))}}]),n}(tn)}return o(t,[{key:"addListeners",value:function(t,i){this.listenerMaps.push({id:i,map:t})}},{key:"fire",value:function(t,i){for(var n=0,e=this.listenerMaps;n<e.length;n++){var r=e[n].map[t];if(r&&!1===r(i,this,t))return!1}}},{key:"init",value:function(t){return this.isInitialized?this:(n=t,(i=this).isInitialized=!0,k.window(n)&&y(n),C.init(n),P.init(n),Xt.init(n),i.window=n,i.document=n.document,i.usePlugin(Ji),i.usePlugin(Ui),i);var i,n}},{key:"pluginIsInstalled",value:function(t){var i=t.id;return i?!!this.X.map[i]:-1!==this.X.list.indexOf(t)}},{key:"usePlugin",value:function(t,i){if(!this.isInitialized)return this;if(this.pluginIsInstalled(t))return this;if(t.id&&(this.X.map[t.id]=t),this.X.list.push(t),t.install&&t.install(this,i),t.listeners&&t.before){for(var n=0,e=this.listenerMaps.length,r=t.before.reduce((function(t,i){return t[i]=!0,t[rn(i)]=!0,t}),{});n<e;n++){var s=this.listenerMaps[n].id;if(s&&(r[s]||r[rn(s)]))break}this.listenerMaps.splice(n,0,{id:t.id,map:t.listeners})}else t.listeners&&this.listenerMaps.push({id:t.id,map:t.listeners});return this}},{key:"addDocument",value:function(t,i){if(-1!==this.getDocIndex(t))return!1;var n=b(t);i=i?B({},i):{},this.documents.push({doc:t,options:i}),this.events.documents.push(t),t!==this.document&&this.events.add(n,"unload",this.onWindowUnload),this.fire("scope:add-document",{doc:t,window:n,scope:this,options:i})}},{key:"removeDocument",value:function(t){var i=this.getDocIndex(t),n=b(t),e=this.documents[i].options;this.events.remove(n,"unload",this.onWindowUnload),this.documents.splice(i,1),this.events.documents.splice(i,1),this.fire("scope:remove-document",{doc:t,window:n,scope:this,options:e})}},{key:"getDocIndex",value:function(t){for(var i=0;i<this.documents.length;i++)if(this.documents[i].doc===t)return i;return-1}},{key:"getDocOptions",value:function(t){var i=this.getDocIndex(t);return-1===i?null:this.documents[i].options}},{key:"now",value:function(){return(this.window.Date||Date).now()}}]),t}();function rn(t){return t&&t.replace(/\/.*$/,"")}var sn=new en,on=sn.interactStatic,an="undefined"!=typeof globalThis?globalThis:window;sn.init(an);var un=Object.freeze({__proto__:null,edgeTarget:function(){},elements:function(){},grid:function(t){var i=[["x","y"],["left","top"],["right","bottom"],["width","height"]].filter((function(i){var n=i[0],e=i[1];return n in t||e in t})),n=function(n,e){for(var r=t.range,s=t.limits,o=void 0===s?{left:-1/0,right:1/0,top:-1/0,bottom:1/0}:s,a=t.offset,u=void 0===a?{x:0,y:0}:a,h={range:r,grid:t,x:null,y:null},c=0;c<i.length;c++){var f=i[c],l=f[0],v=f[1],d=Math.round((n-u.x)/t[l]),p=Math.round((e-u.y)/t[v]);h[l]=Math.max(o.left,Math.min(o.right,d*t[l]+u.x)),h[v]=Math.max(o.top,Math.min(o.bottom,p*t[v]+u.y))}return h};return n.grid=t,n.coordFields=i,n}}),hn={id:"snappers",install:function(t){var i=t.interactStatic;i.snappers=B(i.snappers||{},un),i.createSnapGrid=i.snappers.grid}},cn={start:function(t){var n=t.state,e=t.rect,r=t.edges,s=t.pageCoords,o=n.options,a=o.ratio,u=o.enabled,h=n.options,c=h.equalDelta,f=h.modifiers;"preserve"===a&&(a=e.width/e.height),n.startCoords=B({},s),n.startRect=B({},e),n.ratio=a,n.equalDelta=c;var l=n.linkedEdges={top:r.top||r.left&&!r.bottom,left:r.left||r.top&&!r.right,bottom:r.bottom||r.right&&!r.top,right:r.right||r.bottom&&!r.left};if(n.xIsPrimaryAxis=!(!r.left&&!r.right),n.equalDelta){var v=(l.left?1:-1)*(l.top?1:-1);n.edgeSign={x:v,y:v}}else n.edgeSign={x:l.left?-1:1,y:l.top?-1:1};if(!1!==u&&B(r,l),null!=f&&f.length){var d=new pi(t.interaction);d.copyFrom(t.interaction.modification),d.prepareStates(f),n.subModification=d,d.startAll(i({},t))}},set:function(t){var n=t.state,e=t.rect,r=t.coords,s=n.linkedEdges,o=B({},r),a=n.equalDelta?fn:ln;if(B(t.edges,s),a(n,n.xIsPrimaryAxis,r,e),!n.subModification)return null;var u=B({},e);G(s,u,{x:r.x-o.x,y:r.y-o.y});var h=n.subModification.setAll(i(i({},t),{},{rect:u,edges:s,pageCoords:r,prevCoords:r,prevRect:u})),c=h.delta;return h.changed&&(a(n,Math.abs(c.x)>Math.abs(c.y),h.coords,h.rect),B(r,h.coords)),h.eventProps},defaults:{ratio:"preserve",equalDelta:!1,modifiers:[],enabled:!1}};function fn(t,i,n){var e=t.startCoords,r=t.edgeSign;i?n.y=e.y+(n.x-e.x)*r.y:n.x=e.x+(n.y-e.y)*r.x}function ln(t,i,n,e){var r=t.startRect,s=t.startCoords,o=t.ratio,a=t.edgeSign;if(i){var u=e.width/o;n.y=s.y+(u-r.height)*a.y}else{var h=e.height*o;n.x=s.x+(h-r.width)*a.x}}var vn=mi(cn,"aspectRatio"),dn=function(){};dn.M={};var pn=dn;function gn(t,i,n){return k.func(t)?q(t,i.interactable,i.element,[n.x,n.y,i]):q(t,i.interactable,i.element)}var mn={start:function(t){var i=t.rect,n=t.startOffset,e=t.state,r=t.interaction,s=t.pageCoords,o=e.options,a=o.elementRect,u=B({left:0,top:0,right:0,bottom:0},o.offset||{});if(i&&a){var h=gn(o.restriction,r,s);if(h){var c=h.right-h.left-i.width,f=h.bottom-h.top-i.height;c<0&&(u.left+=c,u.right+=c),f<0&&(u.top+=f,u.bottom+=f)}u.left+=n.left-i.width*a.left,u.top+=n.top-i.height*a.top,u.right+=n.right-i.width*(1-a.right),u.bottom+=n.bottom-i.height*(1-a.bottom)}e.offset=u},set:function(t){var i,n=t.coords,e=t.interaction,r=t.state,s=r.options,o=r.offset,a=gn(s.restriction,e,n);if(a){var u=(!(i=a)||"left"in i&&"top"in i||((i=B({},i)).left=i.x||0,i.top=i.y||0,i.right=i.right||i.left+i.width,i.bottom=i.bottom||i.top+i.height),i);n.x=Math.max(Math.min(u.right-o.right,n.x),u.left+o.left),n.y=Math.max(Math.min(u.bottom-o.bottom,n.y),u.top+o.top)}},defaults:{restriction:null,elementRect:null,offset:null,endOnly:!1,enabled:!1}},yn=mi(mn,"restrict"),bn={top:1/0,left:1/0,bottom:-1/0,right:-1/0},wn={top:-1/0,left:-1/0,bottom:1/0,right:1/0};function xn(t,i){for(var n=0,e=["top","left","bottom","right"];n<e.length;n++){var r=e[n];r in t||(t[r]=i[r])}return t}var kn={noInner:bn,noOuter:wn,start:function(t){var i,n=t.interaction,e=t.startOffset,r=t.state,s=r.options;s&&(i=V(gn(s.offset,n,n.coords.start.page))),i=i||{x:0,y:0},r.offset={top:i.y+e.top,left:i.x+e.left,bottom:i.y-e.bottom,right:i.x-e.right}},set:function(t){var i=t.coords,n=t.edges,e=t.interaction,r=t.state,s=r.offset,o=r.options;if(n){var a=B({},i),u=gn(o.inner,e,a)||{},h=gn(o.outer,e,a)||{};xn(u,bn),xn(h,wn),n.top?i.y=Math.min(Math.max(h.top+s.top,a.y),u.top+s.top):n.bottom&&(i.y=Math.max(Math.min(h.bottom+s.bottom,a.y),u.bottom+s.bottom)),n.left?i.x=Math.min(Math.max(h.left+s.left,a.x),u.left+s.left):n.right&&(i.x=Math.max(Math.min(h.right+s.right,a.x),u.right+s.right))}},defaults:{inner:null,outer:null,offset:null,endOnly:!1,enabled:!1}},Mn=mi(kn,"restrictEdges"),On=B({get elementRect(){return{top:0,left:0,bottom:1,right:1}},set elementRect(t){}},mn.defaults),Sn=mi({start:mn.start,set:mn.set,defaults:On},"restrictRect"),En={width:-1/0,height:-1/0},Tn={width:1/0,height:1/0},Dn=mi({start:function(t){return kn.start(t)},set:function(t){var i=t.interaction,n=t.state,e=t.rect,r=t.edges,s=n.options;if(r){var o=H(gn(s.min,i,t.coords))||En,a=H(gn(s.max,i,t.coords))||Tn;n.options={endOnly:s.endOnly,inner:B({},kn.noInner),outer:B({},kn.noOuter)},r.top?(n.options.inner.top=e.bottom-o.height,n.options.outer.top=e.bottom-a.height):r.bottom&&(n.options.inner.bottom=e.top+o.height,n.options.outer.bottom=e.top+a.height),r.left?(n.options.inner.left=e.right-o.width,n.options.outer.left=e.right-a.width):r.right&&(n.options.inner.right=e.left+o.width,n.options.outer.right=e.left+a.width),kn.set(t),n.options=s}},defaults:{min:null,max:null,endOnly:!1,enabled:!1}},"restrictSize"),Cn={start:function(t){var i,n,e,r=t.interaction,s=t.interactable,o=t.element,a=t.rect,u=t.state,h=t.startOffset,c=u.options,f=c.offsetWithOrigin?(e=(n=t).interaction.element,V(q(n.state.options.origin,null,null,[e]))||K(n.interactable,e,n.interaction.prepared.name)):{x:0,y:0};if("startCoords"===c.offset)i={x:r.coords.start.page.x,y:r.coords.start.page.y};else{var l=q(c.offset,s,o,[r]);(i=V(l)||{x:0,y:0}).x+=f.x,i.y+=f.y}var v=c.relativePoints;u.offsets=a&&v&&v.length?v.map((function(t,n){return{index:n,relativePoint:t,x:h.left-a.width*t.x+i.x,y:h.top-a.height*t.y+i.y}})):[{index:0,relativePoint:null,x:i.x,y:i.y}]},set:function(t){var i=t.interaction,n=t.coords,e=t.state,r=e.options,s=e.offsets,o=K(i.interactable,i.element,i.prepared.name),a=B({},n),u=[];r.offsetWithOrigin||(a.x-=o.x,a.y-=o.y);for(var h=0,c=s;h<c.length;h++)for(var f=c[h],l=a.x-f.x,v=a.y-f.y,d=0,p=r.targets.length;d<p;d++){var g=r.targets[d],m=void 0;(m=k.func(g)?g(l,v,i.h,f,d):g)&&u.push({x:(k.number(m.x)?m.x:l)+f.x,y:(k.number(m.y)?m.y:v)+f.y,range:k.number(m.range)?m.range:r.range,source:g,index:d,offset:f})}for(var y={target:null,inRange:!1,distance:0,range:0,delta:{x:0,y:0}},b=0;b<u.length;b++){var w=u[b],x=w.range,M=w.x-a.x,O=w.y-a.y,S=Q(M,O),E=S<=x;x===1/0&&y.inRange&&y.range!==1/0&&(E=!1),y.target&&!(E?y.inRange&&x!==1/0?S/x<y.distance/y.range:x===1/0&&y.range!==1/0||S<y.distance:!y.inRange&&S<y.distance)||(y.target=w,y.distance=S,y.range=x,y.inRange=E,y.delta.x=M,y.delta.y=O)}return y.inRange&&(n.x=y.target.x,n.y=y.target.y),e.closest=y,y},defaults:{range:1/0,targets:null,offset:null,offsetWithOrigin:!0,origin:null,relativePoints:null,endOnly:!1,enabled:!1}},_n=mi(Cn,"snap"),Pn={start:function(t){var i=t.state,n=t.edges,e=i.options;if(!n)return null;t.state={options:{targets:null,relativePoints:[{x:n.left?0:1,y:n.top?0:1}],offset:e.offset||"self",origin:{x:0,y:0},range:e.range}},i.targetFields=i.targetFields||[["width","height"],["x","y"]],Cn.start(t),i.offsets=t.state.offsets,t.state=i},set:function(t){var i=t.interaction,n=t.state,e=t.coords,r=n.options,s=n.offsets,o={x:e.x-s[0].x,y:e.y-s[0].y};n.options=B({},r),n.options.targets=[];for(var a=0,u=r.targets||[];a<u.length;a++){var h=u[a],c=void 0;if(c=k.func(h)?h(o.x,o.y,i):h){for(var f=0,l=n.targetFields;f<l.length;f++){var v=l[f],d=v[0],p=v[1];if(d in c||p in c){c.x=c[d],c.y=c[p];break}}n.options.targets.push(c)}}var g=Cn.set(t);return n.options=r,g},defaults:{range:1/0,targets:null,offset:null,endOnly:!1,enabled:!1}},jn=mi(Pn,"snapSize"),zn={aspectRatio:vn,restrictEdges:Mn,restrict:yn,restrictRect:Sn,restrictSize:Dn,snapEdges:mi({start:function(t){var i=t.edges;return i?(t.state.targetFields=t.state.targetFields||[[i.left?"left":"right",i.top?"top":"bottom"]],Pn.start(t)):null},set:Pn.set,defaults:B(di(Pn.defaults),{targets:void 0,range:void 0,offset:{x:0,y:0}})},"snapEdges"),snap:_n,snapSize:jn,spring:pn,avoid:pn,transform:pn,rubberband:pn},In={id:"modifiers",install:function(t){var i=t.interactStatic;for(var n in t.usePlugin(bi),t.usePlugin(hn),i.modifiers=zn,zn){var e=zn[n],r=e.M,s=e.k;r.k=s,t.defaults.perAction[n]=r}}},Rn=function(t){u(n,t);var i=l(n);function n(t,r,s,o,a,u){var h;if(e(this,n),it(f(h=i.call(this,a)),s),s!==r&&it(f(h),r),h.timeStamp=u,h.originalEvent=s,h.type=t,h.pointerId=at(r),h.pointerType=dt(r),h.target=o,h.currentTarget=null,"tap"===t){var c=a.getPointerIndex(r);h.dt=h.timeStamp-a.pointers[c].downTime;var l=h.timeStamp-a.tapTime;h.double=!!a.prevTap&&"doubletap"!==a.prevTap.type&&a.prevTap.target===h.target&&l<500}else"doubletap"===t&&(h.dt=r.timeStamp-a.tapTime,h.double=!0);return h}return o(n,[{key:"_subtractOrigin",value:function(t){var i=t.x,n=t.y;return this.pageX-=i,this.pageY-=n,this.clientX-=i,this.clientY-=n,this}},{key:"_addOrigin",value:function(t){var i=t.x,n=t.y;return this.pageX+=i,this.pageY+=n,this.clientX+=i,this.clientY+=n,this}},{key:"preventDefault",value:function(){this.originalEvent.preventDefault()}}]),n}(gt),Fn={id:"pointer-events/base",before:["inertia","modifiers","auto-start","actions"],install:function(t){t.pointerEvents=Fn,t.defaults.actions.pointerEvents=Fn.defaults,B(t.actions.phaselessTypes,Fn.types)},listeners:{"interactions:new":function(t){var i=t.interaction;i.prevTap=null,i.tapTime=0},"interactions:update-pointer":function(t){var i=t.down,n=t.pointerInfo;!i&&n.hold||(n.hold={duration:1/0,timeout:null})},"interactions:move":function(t,i){var n=t.interaction,e=t.pointer,r=t.event,s=t.eventTarget;t.duplicate||n.pointerIsDown&&!n.pointerWasMoved||(n.pointerIsDown&&An(t),Ln({interaction:n,pointer:e,event:r,eventTarget:s,type:"move"},i))},"interactions:down":function(t,i){!function(t,i){for(var n=t.interaction,e=t.pointer,r=t.event,s=t.eventTarget,o=t.pointerIndex,a=n.pointers[o].hold,u=Y(s),h={interaction:n,pointer:e,event:r,eventTarget:s,type:"hold",targets:[],path:u,node:null},c=0;c<u.length;c++){var f=u[c];h.node=f,i.fire("pointerEvents:collect-targets",h)}if(h.targets.length){for(var l=1/0,v=0,d=h.targets;v<d.length;v++){var p=d[v].eventable.options.holdDuration;p<l&&(l=p)}a.duration=l,a.timeout=setTimeout((function(){Ln({interaction:n,eventTarget:s,pointer:e,event:r,type:"hold"},i)}),l)}}(t,i),Ln(t,i)},"interactions:up":function(t,i){var n,e,r,s,o,a;An(t),Ln(t,i),e=i,r=(n=t).interaction,s=n.pointer,o=n.event,a=n.eventTarget,r.pointerWasMoved||Ln({interaction:r,eventTarget:a,pointer:s,event:o,type:"tap"},e)},"interactions:cancel":function(t,i){An(t),Ln(t,i)}},PointerEvent:Rn,fire:Ln,collectEventTargets:$n,defaults:{holdDuration:600,ignoreFrom:null,allowFrom:null,origin:{x:0,y:0}},types:{down:!0,move:!0,up:!0,cancel:!0,tap:!0,doubletap:!0,hold:!0}};function Ln(t,i){var n=t.interaction,e=t.pointer,r=t.event,s=t.eventTarget,o=t.type,a=t.targets,u=void 0===a?$n(t,i):a,h=new Rn(o,e,r,s,n,i.now());i.fire("pointerEvents:new",{pointerEvent:h});for(var c={interaction:n,pointer:e,event:r,eventTarget:s,targets:u,type:o,pointerEvent:h},f=0;f<u.length;f++){var l=u[f];for(var v in l.props||{})h[v]=l.props[v];var d=K(l.eventable,l.node);if(h.Y(d),h.eventable=l.eventable,h.currentTarget=l.node,l.eventable.fire(h),h.U(d),h.immediatePropagationStopped||h.propagationStopped&&f+1<u.length&&u[f+1].node!==h.currentTarget)break}if(i.fire("pointerEvents:fired",c),"tap"===o){var p=h.double?Ln({interaction:n,pointer:e,event:r,eventTarget:s,type:"doubletap"},i):h;n.prevTap=p,n.tapTime=p.timeStamp}return h}function $n(t,i){var n=t.interaction,e=t.pointer,r=t.event,s=t.eventTarget,o=t.type,a=n.getPointerIndex(e),u=n.pointers[a];if("tap"===o&&(n.pointerWasMoved||!u||u.downTarget!==s))return[];for(var h=Y(s),c={interaction:n,pointer:e,event:r,eventTarget:s,type:o,path:h,targets:[],node:null},f=0;f<h.length;f++){var l=h[f];c.node=l,i.fire("pointerEvents:collect-targets",c)}return"hold"===o&&(c.targets=c.targets.filter((function(t){var i,e;return t.eventable.options.holdDuration===(null==(i=n.pointers[a])||null==(e=i.hold)?void 0:e.duration)}))),c.targets}function An(t){var i=t.interaction,n=t.pointerIndex,e=i.pointers[n].hold;e&&e.timeout&&(clearTimeout(e.timeout),e.timeout=null)}var Nn=Object.freeze({__proto__:null,default:Fn});function Xn(t){var i=t.interaction;i.holdIntervalHandle&&(clearInterval(i.holdIntervalHandle),i.holdIntervalHandle=null)}var Yn={id:"pointer-events/holdRepeat",install:function(t){t.usePlugin(Fn);var i=t.pointerEvents;i.defaults.holdRepeatInterval=0,i.types.holdrepeat=t.actions.phaselessTypes.holdrepeat=!0},listeners:["move","up","cancel","endall"].reduce((function(t,i){return t["pointerEvents:".concat(i)]=Xn,t}),{"pointerEvents:new":function(t){var i=t.pointerEvent;"hold"===i.type&&(i.count=(i.count||0)+1)},"pointerEvents:fired":function(t,i){var n=t.interaction,e=t.pointerEvent,r=t.eventTarget,s=t.targets;if("hold"===e.type&&s.length){var o=s[0].eventable.options.holdRepeatInterval;o<=0||(n.holdIntervalHandle=setTimeout((function(){i.pointerEvents.fire({interaction:n,eventTarget:r,type:"hold",pointer:e,event:e},i)}),o))}}})},Un={id:"pointer-events/interactableTargets",install:function(t){var i=t.Interactable;i.prototype.pointerEvents=function(t){return B(this.events.options,t),this};var n=i.prototype.p;i.prototype.p=function(t,i){var e=n.call(this,t,i);return e===this&&(this.events.options[t]=i),e}},listeners:{"pointerEvents:collect-targets":function(t,i){var n=t.targets,e=t.node,r=t.type,s=t.eventTarget;i.interactables.forEachMatch(e,(function(t){var i=t.events,o=i.options;i.types[r]&&i.types[r].length&&t.testIgnoreAllow(o,e,s)&&n.push({node:e,eventable:i,props:{interactable:t}})}))},"interactable:new":function(t){var i=t.interactable;i.events.getRect=function(t){return i.getRect(t)}},"interactable:set":function(t,i){var n=t.interactable,e=t.options;B(n.events.options,i.pointerEvents.defaults),B(n.events.options,e.pointerEvents||{})}}},Bn={id:"pointer-events",install:function(t){t.usePlugin(Nn),t.usePlugin(Yn),t.usePlugin(Un)}},Wn={id:"reflow",install:function(t){var i=t.Interactable;t.actions.phases.reflow=!0,i.prototype.reflow=function(i){return function(t,i,n){for(var e=t.getAllElements(),r=n.window.Promise,s=r?[]:null,o=function(){var o=e[a],u=t.getRect(o);if(!u)return 1;var h,c=wt(n.interactions.list,(function(n){return n.interacting()&&n.interactable===t&&n.element===o&&n.prepared.name===i.name}));if(c)c.move(),s&&(h=c.B||new r((function(t){c.W=t})));else{var f=H(u),l=function(t){return{coords:t,get page(){return this.coords.page},get client(){return this.coords.client},get timeStamp(){return this.coords.timeStamp},get pageX(){return this.coords.page.x},get pageY(){return this.coords.page.y},get clientX(){return this.coords.client.x},get clientY(){return this.coords.client.y},get pointerId(){return this.coords.pointerId},get target(){return this.coords.target},get type(){return this.coords.type},get pointerType(){return this.coords.pointerType},get buttons(){return this.coords.buttons},preventDefault:function(){}}}({page:{x:f.x,y:f.y},client:{x:f.x,y:f.y},timeStamp:n.now()});h=function(t,i,n,e,r){var s=t.interactions.new({pointerType:"reflow"}),o={interaction:s,event:r,pointer:r,eventTarget:n,phase:"reflow"};s.interactable=i,s.element=n,s.prevEvent=r,s.updatePointer(r,r,n,!0),et(s.coords.delta),Vt(s.prepared,e),s.C(o);var a=t.window.Promise,u=a?new a((function(t){s.W=t})):void 0;return s.B=u,s.start(e,i,n),s.m?(s.move(o),s.end(r)):(s.stop(),s.W()),s.removePointer(r,r),u}(n,t,o,i,l)}s&&s.push(h)},a=0;a<e.length&&!o();a++);return s&&r.all(s).then((function(){return t}))}(this,i,t)}},listeners:{"interactions:stop":function(t,i){var n,e,r=t.interaction;"reflow"===r.pointerType&&(r.W&&r.W(),n=i.interactions.list,e=r,n.splice(n.indexOf(e),1))}}};if(on.use(li),on.use(ji),on.use(Bn),on.use(Li),on.use(In),on.use(hi),on.use(At),on.use(Wt),on.use(Wn),on.default=on,"object"===n(r)&&r)try{r.exports=on}catch(ki){}return on.default=on,on}();const o=e(s.exports);var a=(t=>(t[t.none=0]="none",t[t.mouseLeft=1]="mouseLeft",t[t.mouseMiddle=2]="mouseMiddle",t[t.mouseRight=3]="mouseRight",t[t.touchSingle=4]="touchSingle",t[t.touchDouble=5]="touchDouble",t[t.invalid=4]="invalid",t))(a||{});class u{constructor(t){i(this,"_dom"),i(this,"_touchControl"),i(this,"_onCursorDown"),i(this,"_onCursorMove"),i(this,"_onCursorUp"),i(this,"_onScroll"),i(this,"_onRotate"),i(this,"_onKeyDown"),i(this,"_pointerMode"),i(this,"_currentCursorState"),t.addEventListener("wheel",this.onWheel.bind(this)),t.addEventListener("keydown",this.onKeyDown.bind(this)),document.addEventListener("mousemove",this.onMouseMove.bind(this)),document.addEventListener("mouseup",this.onMouseUp.bind(this)),this.q=null,this.V=null,this.H=null,this.G=null,this.K=null,this.Z=null,this.J=0,this.tt="none",this.it=t,this.nt=o(t),this.nt.on("down",(t=>{this.et(this.q,t),this.tt="pointer"})).on("move",(t=>{"gesture"!==this.tt&&this.et(this.V,t)})).on("up",(t=>{this.et(this.H,t),this.tt="none"})),this.nt.gesturable({onstart:t=>{"pointer"===this.tt&&this.et(this.H,t),t.button=1,this.et(this.q,t),this.tt="gesture"},onmove:t=>{"gesture"!==this.tt&&(this.tt="gesture"),t.button=1,this.et(this.V,t),this.rt(this.G,t,t.ds)},onend:t=>{t.button=1,this.et(this.H,t),this.tt="none"}})}et(t,i){null==t||t(i,i.target instanceof Element?i.target:null,this.convertMouseToCursorState(i.button),i.clientX,i.clientY)}rt(t,i,n){null==t||t(i,i.target instanceof Element?i.target:null,this.convertMouseToCursorState(i.button),i.clientX,i.clientY,n)}setCursorDownCallback(t){this.q=t}setCursorMoveCallback(t){this.V=t}setCursorUpCallback(t){this.H=t}setScrollCallback(t){this.G=t}setRotateCallback(t){this.K=t}setKeyDownCallback(t){this.Z=t}convertMouseToCursorState(t){switch(t){case 0:return 1;case 1:return 2;case 2:return 3;default:return 0}}onMouseDown(t){var i;null==(i=this.q)||i.call(this,t,t.target instanceof Element?t.target:null,this.convertMouseToCursorState(t.button),t.clientX,t.clientY)}onMouseMove(t){var i;const n=document.elementFromPoint(t.clientX,t.clientY);null==(i=this.V)||i.call(this,t,n,this.convertMouseToCursorState(t.button),t.clientX,t.clientY)}onMouseUp(t){var i;null==(i=this.H)||i.call(this,t,t.target instanceof Element?t.target:null,this.convertMouseToCursorState(t.button),t.clientX,t.clientY)}onWheel(t){var i;null==(i=this.G)||i.call(this,t,t.target instanceof Element?t.target:null,2,t.clientX,t.clientY,t.deltaY/1e3)}onKeyDown(t){var i;null==(i=this.Z)||i.call(this,t)}}class h{constructor(t){i(this,"g"),i(this,"gid"),i(this,"positionX"),i(this,"positionY"),i(this,"type"),this.g=t,this.gid=(++t.gid).toString(),this.positionX=0,this.positionY=0,this.type=n.unspecified}bindFunction(t){t.ontouchstart=this.domTouchStart.bind(this),t.onpointerdown=this.domMouseDown.bind(this)}domMouseDown(t){this.domCursorDown({button:t.button,clientX:t.clientX,clientY:t.clientY}),t.stopPropagation()}domTouchStart(t){this.domCursorDown({button:0,clientX:t.touches[0].clientX,clientY:t.touches[0].clientY}),t.stopPropagation()}domCursorDown(t){const i=t.button,n=t.clientX,e=t.clientY;0==i?this.g.st=a.mouseLeft:1==i?this.g.st=a.mouseMiddle:2==i&&(this.g.st=a.mouseRight),this.g.targetObject=this,this.g.mousedown_x=n,this.g.mousedown_y=e,this.g.dx=0,this.g.dy=0,this.g.dx_offset=0,this.g.dy_offset=0,this.componentCursorDown(t)}componentCursorDown(t){}domCursorUp(){this.componentCursorUp()}componentCursorUp(){}onFocus(){}offFocus(){}onDrag(){}onPan(){}destroy(){}}class c extends h{constructor(t,n,e){super(e),i(this,"parent"),i(this,"config"),i(this,"dom"),this.config=t,this.parent=n,this.dom=null}}class f extends c{constructor(t,n,e,r){super(n,e,r),i(this,"name"),i(this,"dom"),i(this,"prop"),this.name=n.name,this.prop=e.prop,this.dom=t}bindFunction(t){}addInputUpdateListener(t,i){this.dom.addEventListener(t,i.bind(this))}}class l extends c{constructor(t,e,r,s,o,a){super(e,r,s),i(this,"config"),i(this,"name"),i(this,"connectorX"),i(this,"connectorY"),i(this,"connectorTotalOffsetX"),i(this,"_connectorTotalOffsetY"),i(this,"prop"),i(this,"outgoingLines"),i(this,"incomingLines"),i(this,"type",n.connector),i(this,"dom"),i(this,"parent"),this.connectorX=0,this.connectorY=0,this.connectorTotalOffsetX=0,this.ot=0,this.dom=t,this.parent=r,this.prop=r.prop,this.outgoingLines=o,this.incomingLines=a,this.config=e,s.gid++,this.name=e.name||s.gid.toString(),this.g.globalNodeTable[this.gid]=this,this.dom.setAttribute("sl-gid",this.gid.toString()),this.bindFunction(this.dom)}updateFunction(){}startDragOutLine(){this.outgoingLines.unshift({svg:null,target:null,start:this,connector_x:this.connectorX,connector_y:this.connectorY,x2:0,y2:0,connector:this,requestDelete:!1,completedDelete:!1}),this.setAllLinePositions()}runDragOutLine(){let t=9999,i=0,n=0;const e=this.g.hoverDOM;if(0==this.outgoingLines.length)return;const[r,s]=this.g.camera.getWorldDeltaFromCameraDelta(this.g.dx,this.g.dy);if(e&&e.classList.contains("sl-connector")){const o=e.getAttribute("sl-gid");if(!o)return;const a=this.g.globalNodeTable[o];a.updateConnectorPosition(),i=a.connectorX,n=a.connectorY,t=Math.sqrt(Math.pow(this.connectorX+r-i,2)+Math.pow(this.connectorY+s-n,2)),t<40?this.setLineXYPosition(this.outgoingLines[0],i-this.connectorX,n-this.connectorY):this.setLineXYPosition(this.outgoingLines[0],r,s)}else this.setLineXYPosition(this.outgoingLines[0],r,s)}endDragOutLine(){const t=this.g.hoverDOM;if(t&&t.classList.contains("sl-connector")){const i=t.getAttribute("sl-gid");if(!i)return;const n=this.g.globalNodeTable[i];if(0==this.connectToConnector(n))return void this.deleteLine(0);n.prop[n.name]=this.prop[this.name],n.updateFunction(),this.setLineXYPosition(this.outgoingLines[0],n.connectorX-this.connectorX,n.connectorY-this.connectorY)}else this.deleteLine(0)}startPickUpLine(t){this.g.targetObject=t.start,[this.g.dx_offset,this.g.dy_offset]=this.g.camera.getCameraDeltaFromWorldDelta(this.connectorX-t.start.connectorX,this.connectorY-t.start.connectorY),this.g.dx=this.g.dx_offset,this.g.dy=this.g.dy_offset,t.start.disconnectFromConnector(this),this.disconnectFromConnector(t.start),this.deleteLine(this.incomingLines.indexOf(t)),t.start.startDragOutLine()}connectToConnector(t){const i=t.incomingLines.filter((t=>!t.requestDelete));return!i.some((t=>t.start==this))&&(t.config.maxConnectors!==i.length&&(this.updateConnectorPosition(),this.outgoingLines[0].target=t,t.incomingLines.push(this.outgoingLines[0]),!0))}disconnectFromConnector(t){for(const i of this.outgoingLines)if(i.target==t){i.requestDelete=!0;break}}updateConnectorPosition(){this.connectorX=this.parent.positionX+this.connectorTotalOffsetX,this.connectorY=this.parent.positionY+this.ot}setLineXYPosition(t,i,n){t.x2=i,t.y2=n}renderLinePosition(t){const i=t.svg;if(!i)return;this.setStyle(i,{position:"absolute",overflow:"visible",pointerEvents:"none",willChange:"transform",transform:`translate3d(${t.connector_x}px, ${t.connector_y}px, 0)`});const n=i.children[0];n.setAttribute("x1","0"),n.setAttribute("y1","0"),n.setAttribute("x2",""+t.x2),n.setAttribute("y2",""+t.y2)}setLinePosition(t){if(t.connector_x=t.start.connectorX,t.connector_y=t.start.connectorY,t.target)this.setLineXYPosition(t,t.target.connectorX-t.start.connectorX,t.target.connectorY-t.start.connectorY);else{const[i,n]=this.g.camera.getWorldDeltaFromCameraDelta(this.g.dx,this.g.dy);this.setLineXYPosition(t,i,n)}}setAllLinePositions(){this.updateConnectorPosition();for(const t of this.outgoingLines)this.setLinePosition(t);for(const t of this.incomingLines)t.start.setLinePosition(t)}updateDOMproperties(){const t=this.dom.getBoundingClientRect();if(!this.parent.dom)return;const i=this.parent.dom.getBoundingClientRect(),[n,e]=this.g.camera.getWorldDeltaFromCameraDelta(t.left-i.left,t.top-i.top),[r,s]=this.g.camera.getWorldDeltaFromCameraDelta(t.width/2,t.height/2);this.connectorTotalOffsetX=n+r,this.ot=e+s}createLineDOM(){const t=document.createElementNS("http://www.w3.org/2000/svg","svg"),i=document.createElementNS("http://www.w3.org/2000/svg","line");return t.appendChild(i),t.classList.add("sl-connector-svg"),i.classList.add("sl-connector-line"),i.setAttribute("stroke-width","4"),this.g.canvas.appendChild(t),t}setStyle(t,i){if(t)for(const n in i)t.style[n]=i[n]}deleteLine(t){if(0==this.outgoingLines.length)return;const i=this.outgoingLines[t];return i.requestDelete=!0,i}deleteAllLines(){for(const t of this.outgoingLines)t.requestDelete=!0}componentCursorDown(t){const i=this.incomingLines.filter((t=>!t.requestDelete));i.length>0?this.startPickUpLine(i[0]):this.config.allowDragOut&&this.startDragOutLine()}onDrag(){this.runDragOutLine()}componentCursorUp(){this.endDragOutLine(),this.parent.ut()}}class v extends h{constructor(t,e){super(e),i(this,"type",n.node),i(this,"nodeType"),i(this,"dom"),i(this,"connectors"),i(this,"components"),i(this,"allOutgoingLines"),i(this,"allIncomingLines"),i(this,"nodeWidth",0),i(this,"nodeHeight",0),i(this,"dragStartX",0),i(this,"dragStartY",0),i(this,"freeze"),i(this,"prop"),i(this,"propSetCallback"),i(this,"nodeStyle"),this.nodeType="",this.dom=t,this.connectors={},this.components={},this.allOutgoingLines={},this.allIncomingLines={},this.dragStartX=this.positionX,this.dragStartY=this.positionY,this.freeze=!1,this.prop={},this.prop=new Proxy(this.prop,{set:(t,i,n)=>{if(t[i=i.toString()]=n,this.propSetCallback[i]&&this.propSetCallback[i](n),i in this.connectors){const t=this.connectors[i].outgoingLines.filter((t=>t.target&&!t.requestDelete)).map((t=>t.target));if(t)for(const i of t)i&&(i.parent.prop[i.name]=n,i.parent.propSetCallback[i.name]&&i.parent.propSetCallback[i.name](n))}return!0}}),this.propSetCallback={},this.setNodeStyle({willChange:"transform",position:"absolute",transformOrigin:"top left"}),this.g.globalNodeList.push(this),this.initNode=this.initNode.bind(this),this.addConnector=this.addConnector.bind(this),this.addInputForm=this.addInputForm.bind(this),this.addPropSetCallback=this.addPropSetCallback.bind(this),this.setRenderNodeCallback=this.setRenderNodeCallback.bind(this),this.setRenderLinesCallback=this.setRenderLinesCallback.bind(this)}initNode(t){this.dom=t,this.dom.id=this.gid,this.renderNode(this.nodeStyle),this.bindFunction(this.dom),new ResizeObserver((()=>{this.updateDOMproperties()})).observe(this.dom)}updateDOMproperties(){if(this.dom){this.nodeHeight=this.dom.offsetHeight,this.nodeWidth=this.dom.offsetWidth;for(const t of Object.values(this.connectors))t.updateDOMproperties()}}setNodeStyle(t){this.nodeStyle=Object.assign({},this.nodeStyle,t)}filterDeletedLines(t){for(let i=0;i<t.length;i++)t[i].requestDelete&&t[i].completedDelete&&(t.splice(i,1),i--)}ht(t){for(const i of t){const t=i.start;if(i.svg){if(i.requestDelete&&!i.completedDelete){this.g.canvas.removeChild(i.svg),i.completedDelete=!0;continue}}else i.svg=t.createLineDOM();i.svg&&(i.connector_x=t.connectorX,i.connector_y=t.connectorY,i.target&&(i.x2=i.target.connectorX-t.connectorX,i.y2=i.target.connectorY-t.connectorY),i.svg.style.transform=`translate3d(${t.connectorX}px, ${t.connectorY}px, 0)`,t.renderLinePosition(i))}this.filterDeletedLines(t)}setRenderLinesCallback(t){this.ht=i=>{this.filterDeletedLines(i),t(i)}}ct(t,i,n=this){for(const e in t)i.bind(n)(t[e])}ut(){this.ct(this.allOutgoingLines,this.ht),this.ct(this.allIncomingLines,(t=>{for(const i of t){const t=i.start.parent;this.ct(t.allOutgoingLines,t.ht,t)}}))}renderNode(t){if(this.dom){for(const i in t)"_"!=i[0]&&(this.dom.style[i]=t[i]);t.ft?this.dom.classList.add("focus"):this.dom.classList.remove("focus"),this.ut()}}setRenderNodeCallback(t){this.renderNode=i=>{t(i),this.ut()}}addNodeToCanvas(t,i){this.positionX=t,this.positionY=i,this.nodeWidth=this.dom.offsetWidth,this.nodeHeight=this.dom.offsetHeight,this.setNodeStyle({transform:`translate3d(${this.positionX}px, ${this.positionY}px, 0)`}),this.renderNode(this.nodeStyle),this.updateDOMproperties(),this.g.canvas.appendChild(this.dom)}addConnector(t,i,n=1,e=!0){this.allOutgoingLines[i]=[],this.allIncomingLines[i]=[];const r=new l(t,{name:i,maxConnectors:n,allowDragOut:e},this,this.g,this.allOutgoingLines[i],this.allIncomingLines[i]);return this.connectors[i]=r,this.prop[i]=null,r}addInputForm(t,i){const n=new f(t,{name:i},this,this.g);return this.prop[i]=null,n}addPropSetCallback(t,i){this.propSetCallback[i]=t}setStartPositions(){this.dragStartX=this.positionX,this.dragStartY=this.positionY}componentCursorDown(t){let i=!1;for(let n=0;n<this.g.focusNodes.length;n++)if(this.g.focusNodes[n].gid==this.gid){i=!0;break}if(i)for(let n=0;n<this.g.focusNodes.length;n++)this.g.focusNodes[n].setStartPositions();else{for(let t=0;t<this.g.focusNodes.length;t++)this.g.focusNodes[t].offFocus();this.g.focusNodes=[this],this.onFocus()}this.setStartPositions()}componentCursorUp(){if(this.freeze)return;const[t,i]=this.g.camera.getWorldDeltaFromCameraDelta(this.g.dx,this.g.dy);if(this.positionX=this.dragStartX+t,this.positionY=this.dragStartY+i,!this.g.mouseHasMoved&&this.g.targetObject&&this.g.targetObject.gid==this.gid){for(let t=0;t<this.g.focusNodes.length;t++)this.g.focusNodes[t].offFocus();return this.g.focusNodes=[this],void this.onFocus()}this.renderNode(this.nodeStyle)}onDrag(){if(this.freeze)return;const[t,i]=this.g.camera.getWorldDeltaFromCameraDelta(this.g.dx,this.g.dy);this.positionX=this.dragStartX+t,this.positionY=this.dragStartY+i,this.setNodeStyle({transform:`translate3d(${this.positionX}px, ${this.positionY}px, 0)`});for(const n of Object.values(this.connectors))n.setAllLinePositions();Object.keys(this.connectors).length}onFocus(){this.setNodeStyle({ft:!0}),this.renderNode(this.nodeStyle)}offFocus(){this.setNodeStyle({ft:!1}),this.renderNode(this.nodeStyle)}evaluate(t){const i=this.connectors[t];if(i)for(const n of i.outgoingLines){const i=n.target;i&&(i.parent.prop[i.name]=this.prop[t],i.updateFunction())}}exec(){}destroy(){var t;null==(t=this.g.canvas)||t.removeChild(this.dom);for(const i of Object.values(this.connectors))i.destroy()}}class d{constructor(t,n){i(this,"containerDom"),i(this,"canvasDom"),i(this,"cameraWidth"),i(this,"cameraHeight"),i(this,"cameraX"),i(this,"cameraY"),i(this,"cameraPanStartX"),i(this,"cameraPanStartY"),i(this,"zoom"),i(this,"canvasStyle"),this.containerDom=t,this.canvasDom=n,this.cameraWidth=t.clientWidth,this.cameraHeight=t.clientHeight,this.cameraX=0,this.cameraY=0,this.cameraPanStartX=0,this.cameraPanStartY=0,this.zoom=1,this.canvasStyle="",this.updateCamera()}worldToCameraMatrix(t,i,n,e,r){return`${n},0,0,0,0,${n},0,0,0,0,1,0,${-t*n+e/2},${-i*n+r/2},0,1`}updateCamera(){const t=this.worldToCameraMatrix(this.cameraX,this.cameraY,this.zoom,this.containerDom.clientWidth,this.containerDom.clientHeight);this.canvasStyle=`matrix3d(${t})`}handleScroll(t,i,n){i-=this.containerDom.offsetLeft,n-=this.containerDom.offsetTop,this.zoom+t<.2?t=.2-this.zoom:this.zoom+t>1&&(t=1-this.zoom);const e=this.zoom/(this.zoom+t);this.cameraX-=this.cameraWidth/this.zoom*(e-1)*(1-(1.5*this.cameraWidth-i)/this.cameraWidth),this.cameraY-=this.cameraHeight/this.zoom*(e-1)*(1-(1.5*this.cameraHeight-n)/this.cameraHeight),this.zoom+=t,this.updateCamera()}handlePan(t,i){this.cameraX+=t/this.zoom,this.cameraY+=i/this.zoom,this.updateCamera()}handlePanStart(){this.cameraPanStartX=this.cameraX,this.cameraPanStartY=this.cameraY}handlePanDrag(t,i){this.cameraX=-t/this.zoom+this.cameraPanStartX,this.cameraY=-i/this.zoom+this.cameraPanStartY,this.updateCamera()}handlePanEnd(){this.cameraPanStartX=0,this.cameraPanStartY=0}getCameraFromWorld(t,i){return[(t-this.cameraX)*this.zoom+this.cameraWidth/2,(i-this.cameraY)*this.zoom+this.cameraHeight/2]}getWorldFromCamera(t,i){t-=this.containerDom.offsetLeft,i-=this.containerDom.offsetTop;return[(t-this.cameraWidth/2)/this.zoom+this.cameraX,(i-this.cameraHeight/2)/this.zoom+this.cameraY]}getCameraDeltaFromWorldDelta(t,i){return[t*this.zoom,i*this.zoom]}getWorldDeltaFromCameraDelta(t,i){return[t/this.zoom,i/this.zoom]}}return class{constructor(){i(this,"g"),i(this,"_containerStyle",{}),i(this,"_canvasStyle",{}),i(this,"_selectionBoxStyle",{}),i(this,"_backgroundStyle",{}),i(this,"_inputControl",null),this.g=null,this.lt={position:"relative",overflow:"hidden"},this.vt={position:"absolute",pointerEvents:"none"},this.initSnapLine=this.initSnapLine.bind(this),this.setRenderCanvasCallback=this.setRenderCanvasCallback.bind(this),this.setRenderBackgroundCallback=this.setRenderBackgroundCallback.bind(this),this.setRenderSelectionBoxCallback=this.setRenderSelectionBoxCallback.bind(this)}initSnapLine(t,i,n,e){this.g={canvas:i,canvasContainer:t,canvasBackground:n,selectionBox:e,st:a.none,mousedown_x:0,mousedown_y:0,mouse_x:0,mouse_y:0,mouse_x_world:0,mouse_y_world:0,dx:0,dy:0,dx_offset:0,dy_offset:0,camera:new d(t,i),overrideDrag:!1,targetObject:null,focusNodes:[],hoverDOM:null,gid:0,globalNodeList:[],globalNodeTable:{},mouseHasMoved:!1,ignoreMouseUp:!1,prevTouches:null,prevSingleTouchTime:0,snapline:this},this.gt({position:"relative",top:"0px",left:"0px",width:"0px",height:"0px",transform:this.g.camera.canvasStyle}),this.yt({width:10*this.g.camera.cameraWidth+"px",height:10*this.g.camera.cameraHeight+"px",transform:`translate(${5*-this.g.camera.cameraWidth}px, ${5*-this.g.camera.cameraHeight}px)`,transformOrigin:"center",zIndex:"0",position:"absolute"}),this.bt(this.wt),this.xt(this.kt),this.Mt(this.vt),this.Ot=new u(t),this.Ot.setCursorDownCallback(this.onCursorDown.bind(this)),this.Ot.setCursorMoveCallback(this.onCursorMove.bind(this)),this.Ot.setCursorUpCallback(this.onCursorUp.bind(this)),this.Ot.setScrollCallback(this.onZoom.bind(this)),window.requestAnimationFrame(this.step.bind(this))}gt(t){this.wt=Object.assign({},this.wt,t),this.wt.St="true"}yt(t){this.kt=Object.assign({},this.kt,t),this.kt.St="true"}Et(t){this.vt=Object.assign({},this.vt,t),this.vt.St="true"}bt(t){for(const i in t)this.g.canvas.style[i]=t[i]}xt(t){for(const i in t)this.g.canvasBackground.style[i]=t[i]}Mt(t){for(const i in t)this.g.selectionBox.style[i]=t[i]}setRenderCanvasCallback(t){this.bt=t}setRenderBackgroundCallback(t){this.xt=t}setRenderSelectionBoxCallback(t){this.Mt=t}onCursorDown(t,i,e,r,s){if(i!==this.g.canvasContainer&&i!==this.g.canvasBackground)return;if(this.g.st=e,this.g.targetObject&&this.g.targetObject.type==n.connector){this.g.targetObject.domCursorUp()}const o=this.g;if(!o.overrideDrag){o.st!=a.none&&this.Et({width:"0px",height:"0px",left:"0px",top:"0px",pointerEvents:"none",opacity:"0"}),o.focusNodes=[];for(const t of o.globalNodeList)t.offFocus();o.mousedown_x=r,o.mousedown_y=s,e!=a.mouseMiddle&&e!=a.touchDouble||this.g.camera.handlePanStart()}}onCursorMove(t,i,e,r,s){const o=this.g;if(o.hoverDOM=document.elementFromPoint(r,s),o.mouse_x=r-o.canvasContainer.offsetLeft,o.mouse_y=s-o.canvasContainer.offsetTop,[o.mouse_x_world,o.mouse_y_world]=this.g.camera.getWorldFromCamera(o.mouse_x,o.mouse_y),o.dx=r-o.mousedown_x+o.dx_offset,o.dy=s-o.mousedown_y+o.dy_offset,0===o.dx&&0===o.dy||(o.mouseHasMoved=!0),null==o.targetObject){if(o.st==a.mouseMiddle||o.st==a.touchDouble)this.g.camera.handlePanDrag(o.dx,o.dy),this.gt({transform:this.g.camera.canvasStyle,cursor:"grabbing"}),this.yt({transform:`translate(${this.g.camera.cameraX+5*-this.g.camera.cameraWidth}px, ${this.g.camera.cameraY+5*-this.g.camera.cameraHeight}px)`,backgroundPosition:`${-this.g.camera.cameraX}px ${-this.g.camera.cameraY}px`});else if(o.st==a.mouseLeft||o.st==a.touchSingle){this.Et({width:Math.abs(o.dx)+"px",height:Math.abs(o.dy)+"px",left:Math.min(o.mousedown_x,o.mouse_x)+"px",top:Math.min(o.mousedown_y,o.mouse_y)+"px",opacity:"1"});const[t,i]=this.g.camera.getWorldFromCamera(Math.min(o.mousedown_x,o.mouse_x),Math.min(o.mousedown_y,o.mouse_y)),[n,e]=this.g.camera.getWorldFromCamera(Math.max(o.mousedown_x,o.mouse_x),Math.max(o.mousedown_y,o.mouse_y)),r=[];for(const s of o.globalNodeList)s.positionX+s.nodeWidth>t&&s.positionX<n&&s.positionY+s.nodeHeight>i&&s.positionY<e?(s.onFocus(),r.push(s)):s.offFocus();o.focusNodes=r}}else if(o.targetObject.type==n.node)for(const n of o.focusNodes)n.onDrag();else o.targetObject.onDrag()}onCursorUp(t,i,e,r,s){const o=this.g;if(o.ignoreMouseUp)o.ignoreMouseUp=!1;else{if(o.st==a.mouseLeft||o.st==a.touchSingle)if(null==o.targetObject)this.Et({width:"0px",height:"0px",left:"0px",top:"0px"});else if(o.targetObject.type==n.node)for(const t of o.focusNodes)t.domCursorUp();else o.targetObject.domCursorUp();else o.st!=a.mouseMiddle&&o.st!=a.touchDouble||this.g.camera.handlePanEnd();o.st=a.none,o.overrideDrag&&this.gt({cursor:"default"}),o.overrideDrag=!1,this.gt({cursor:"default"}),o.targetObject=null,o.dx=0,o.dy=0,o.dx_offset=0,o.dy_offset=0,o.mouseHasMoved=!1}}onZoom(t,i,n,e,r,s){this.g.camera.handleScroll(s,this.g.mouse_x,this.g.mouse_y),this.gt({transform:this.g.camera.canvasStyle})}Tt(){const t=this.g.targetObject;if(null!=t)if(t.type==n.node)for(const i of this.g.focusNodes)i.renderNode(i.nodeStyle);else if(t.type==n.connector){this.g.targetObject.parent.ut()}}step(){this.Tt(),this.bt(this.wt),this.xt(this.kt),this.Mt(this.vt),window.requestAnimationFrame(this.step.bind(this))}addNodeObject(){const t=new v(null,this.g);return this.g.globalNodeTable[t.gid]=t,[t,this.g.globalNodeTable]}createNode(t){const i=new v(t,this.g);return this.g.globalNodeTable[i.gid]=i,i}addNode(t,i,n){t.addNodeToCanvas(i,n)}addNodeAtMouse(t,i){this.g.ignoreMouseUp=!0;const n=this.g.mouse_x_world,e=this.g.mouse_y_world;this.addNode(t,n,e),t.setStartPositions(),this.g.st=a.mouseLeft,this.g.mousedown_x=this.g.mouse_x,this.g.mousedown_y=this.g.mouse_y,this.g.focusNodes=[t],this.g.targetObject=t;for(const r of this.g.globalNodeList)r.offFocus();this.onCursorMove(i,null,this.g.st,i.clientX,i.clientY)}deleteNode(t){if(!(t in this.g.globalNodeTable))return null;this.g.globalNodeTable[t].destroy();const{[t]:i,...n}=this.g.globalNodeTable;return this.g.globalNodeTable=n,t}focusNode(t){if(!(t in this.g.globalNodeTable))return null;return this.g.globalNodeTable[t].onFocus(),t}}}));
